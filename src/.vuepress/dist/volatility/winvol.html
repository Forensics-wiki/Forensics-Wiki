<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.66" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/volatility/winvol.html"><meta property="og:site_name" content="Forensics-Wiki"><meta property="og:title" content="Windows命令参考"><meta property="og:description" content="镜像识别 imageinfo 如果要获得内存的高级摘要，请使用 imageinfo 命令。大多数情况下，此命令用于识别操作系统、服务包和硬件体系结构（32 位或 64 位），但它还包含其他有用信息，例如 DTB 地址和内存镜像制作时间。 ```python $ python vol.py -f ~/Desktop/win7trial64bit.raw ..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-07-27T13:13:50.000Z"><meta property="article:author" content="Forensics-Wiki"><meta property="article:modified_time" content="2023-07-27T13:13:50.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Windows命令参考","image":[""],"dateModified":"2023-07-27T13:13:50.000Z","author":[{"@type":"Person","name":"Forensics-Wiki","url":"https://github.com/Forensics-wiki"}]}</script><title>Windows命令参考 | Forensics-Wiki</title><meta name="description" content="镜像识别 imageinfo 如果要获得内存的高级摘要，请使用 imageinfo 命令。大多数情况下，此命令用于识别操作系统、服务包和硬件体系结构（32 位或 64 位），但它还包含其他有用信息，例如 DTB 地址和内存镜像制作时间。 ```python $ python vol.py -f ~/Desktop/win7trial64bit.raw ...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-653f839c.css" as="style"><link rel="stylesheet" href="/assets/style-653f839c.css">
    <link rel="modulepreload" href="/assets/app-a6717152.js"><link rel="modulepreload" href="/assets/winvol.html-9b505e8f.js"><link rel="modulepreload" href="/assets/winvol.html-a272741b.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper-c27b6911.js"><link rel="prefetch" href="/assets/index.html-57a9b398.js" as="script"><link rel="prefetch" href="/assets/cc.html-3e7e5d6c.js" as="script"><link rel="prefetch" href="/assets/dx.html-40c21bff.js" as="script"><link rel="prefetch" href="/assets/index.html-50ee7e24.js" as="script"><link rel="prefetch" href="/assets/dd.html-932f8947.js" as="script"><link rel="prefetch" href="/assets/gs.html-9c5404d9.js" as="script"><link rel="prefetch" href="/assets/hash.html-48095261.js" as="script"><link rel="prefetch" href="/assets/index.html-d905e76d.js" as="script"><link rel="prefetch" href="/assets/time.html-d49c9fa4.js" as="script"><link rel="prefetch" href="/assets/vc.html-8aa9d249.js" as="script"><link rel="prefetch" href="/assets/win.html-a1484282.js" as="script"><link rel="prefetch" href="/assets/zz.html-9d7fabd0.js" as="script"><link rel="prefetch" href="/assets/cj.html-a668ac21.js" as="script"><link rel="prefetch" href="/assets/index.html-846f49e2.js" as="script"><link rel="prefetch" href="/assets/sq.html-0bf46c83.js" as="script"><link rel="prefetch" href="/assets/yr.html-080bf093.js" as="script"><link rel="prefetch" href="/assets/dx.html-4fb60ae1.js" as="script"><link rel="prefetch" href="/assets/index.html-f4d7f3b8.js" as="script"><link rel="prefetch" href="/assets/basecommand.html-3e80f9a1.js" as="script"><link rel="prefetch" href="/assets/cdn.html-e149dcf7.js" as="script"><link rel="prefetch" href="/assets/intr.html-59e32b22.js" as="script"><link rel="prefetch" href="/assets/index.html-77aa0c92.js" as="script"><link rel="prefetch" href="/assets/base.html-cb4fb15a.js" as="script"><link rel="prefetch" href="/assets/install.html-7f8ff926.js" as="script"><link rel="prefetch" href="/assets/js.html-6effd55f.js" as="script"><link rel="prefetch" href="/assets/index.html-cef01c49.js" as="script"><link rel="prefetch" href="/assets/bitlocker.html-a3ce6693.js" as="script"><link rel="prefetch" href="/assets/efs.html-0024e9a3.js" as="script"><link rel="prefetch" href="/assets/index.html-2728155d.js" as="script"><link rel="prefetch" href="/assets/2022changancup.html-eb06d925.js" as="script"><link rel="prefetch" href="/assets/index.html-64229c22.js" as="script"><link rel="prefetch" href="/assets/404.html-c7a26431.js" as="script"><link rel="prefetch" href="/assets/index.html-84dcf274.js" as="script"><link rel="prefetch" href="/assets/cc.html-ee53a6ee.js" as="script"><link rel="prefetch" href="/assets/dx.html-802de1ff.js" as="script"><link rel="prefetch" href="/assets/index.html-6280f6a5.js" as="script"><link rel="prefetch" href="/assets/dd.html-96889798.js" as="script"><link rel="prefetch" href="/assets/gs.html-4a5b5a58.js" as="script"><link rel="prefetch" href="/assets/hash.html-6f97edb8.js" as="script"><link rel="prefetch" href="/assets/index.html-8e4823a3.js" as="script"><link rel="prefetch" href="/assets/time.html-38d0c7e3.js" as="script"><link rel="prefetch" href="/assets/vc.html-fcf614bf.js" as="script"><link rel="prefetch" href="/assets/win.html-031b16ec.js" as="script"><link rel="prefetch" href="/assets/zz.html-aac95308.js" as="script"><link rel="prefetch" href="/assets/cj.html-230ae679.js" as="script"><link rel="prefetch" href="/assets/index.html-a83f239a.js" as="script"><link rel="prefetch" href="/assets/sq.html-5a8fc684.js" as="script"><link rel="prefetch" href="/assets/yr.html-9b77f17a.js" as="script"><link rel="prefetch" href="/assets/dx.html-5e434226.js" as="script"><link rel="prefetch" href="/assets/index.html-abc506ef.js" as="script"><link rel="prefetch" href="/assets/basecommand.html-d34793fa.js" as="script"><link rel="prefetch" href="/assets/cdn.html-3ff58961.js" as="script"><link rel="prefetch" href="/assets/intr.html-ecba3ff0.js" as="script"><link rel="prefetch" href="/assets/index.html-a63c46a6.js" as="script"><link rel="prefetch" href="/assets/base.html-32542f60.js" as="script"><link rel="prefetch" href="/assets/install.html-763c2e3e.js" as="script"><link rel="prefetch" href="/assets/js.html-dc7c2b77.js" as="script"><link rel="prefetch" href="/assets/index.html-21b890e7.js" as="script"><link rel="prefetch" href="/assets/bitlocker.html-a779d2bf.js" as="script"><link rel="prefetch" href="/assets/efs.html-67f938bb.js" as="script"><link rel="prefetch" href="/assets/index.html-f4fb83d5.js" as="script"><link rel="prefetch" href="/assets/2022changancup.html-ba4bff3c.js" as="script"><link rel="prefetch" href="/assets/index.html-0bc29fe1.js" as="script"><link rel="prefetch" href="/assets/404.html-6e21f5a7.js" as="script"><link rel="prefetch" href="/assets/giscus-765fdce2.js" as="script"><link rel="prefetch" href="/assets/auto-8ef1dbea.js" as="script"><link rel="prefetch" href="/assets/index-2bf332f6.js" as="script"><link rel="prefetch" href="/assets/flowchart-c441f34d.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-db5f9a47.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-75b11b9d.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-abe06b83.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-a106bb2c.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-ec5549c1.js" as="script"><link rel="prefetch" href="/assets/search.esm-7e6792e2.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/VuePlayground-71ed6453.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-5794cde2.js" as="script"><link rel="prefetch" href="/assets/SearchResult-94e154b6.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt="Forensics-Wiki"><!----><span class="vp-site-name hide-in-pad">Forensics-Wiki</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a class="vp-link nav-link" href="/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>电子数据取证Wiki<!----></a></div><div class="nav-item hide-in-mobile"><a class="vp-link nav-link" href="/demo/"><span class="font-icon icon fa-fw fa-sm fas fa-network-wired" style=""></span>引入<!----></a></div><div class="nav-item hide-in-mobile"><a class="vp-link nav-link" href="/base.html"><span class="font-icon icon fa-fw fa-sm fas fa-laptop-code" style=""></span>取证基础<!----></a></div><div class="nav-item hide-in-mobile"><a class="vp-link nav-link" href="/windows.html"><span class="font-icon icon fa-fw fa-sm fab fa-windows" style=""></span>Windows取证<!----></a></div><div class="nav-item hide-in-mobile"><a class="vp-link nav-link" href="/linux.html"><span class="font-icon icon fa-fw fa-sm fab fa-linux" style=""></span>Linux&amp;服务器取证<!----></a></div><div class="nav-item hide-in-mobile"><a class="vp-link nav-link active" href="/volatility.html"><span class="font-icon icon fa-fw fa-sm fas fa-memory" style=""></span>内存取证<!----></a></div><div class="nav-item hide-in-mobile"><a class="vp-link nav-link" href="/android.html"><span class="font-icon icon fa-fw fa-sm fab fa-android" style=""></span>安卓取证<!----></a></div><div class="nav-item hide-in-mobile"><a class="vp-link nav-link" href="/ios.html"><span class="font-icon icon fa-fw fa-sm fab fa-apple" style=""></span>IOS取证<!----></a></div><div class="nav-item hide-in-mobile"><a class="vp-link nav-link" href="/writeup.html"><span class="font-icon icon fa-fw fa-sm fas fa-trophy" style=""></span>赛题Writeup<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="快捷跳转"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-lightbulb" style=""></span>快捷跳转</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="https://forensics.didctf.com" rel="noopener noreferrer" target="_blank" aria-label="电子数据取证靶场" class="nav-link"><span class="font-icon icon fa-fw fa-sm fas fa-bullseye" style=""></span>电子数据取证靶场<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></button></div></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/Forensics-wiki/Forensics-Wiki" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" class="outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><!--[--><button type="button" class="search-pro-button" role="search" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a class="vp-link nav-link vp-sidebar-link vp-sidebar-page" href="/volatility/"><span class="font-icon icon fa-fw fa-sm fas fa-memory" style=""></span>内存取证<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading clickable"><span class="font-icon icon fa-fw fa-sm fas fa-play" style=""></span><a class="vp-link nav-link vp-sidebar-title" href="/volatility/js.html"><!---->介绍<!----></a><!----></p><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading clickable"><span class="font-icon icon fa-fw fa-sm fas fa-hand" style=""></span><a class="vp-link nav-link vp-sidebar-title" href="/volatility/install.html"><!---->安装<!----></a><!----></p><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading clickable"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span><a class="vp-link nav-link vp-sidebar-title" href="/volatility/base.html"><!---->基本用法<!----></a><!----></p><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-heading clickable exact active"><span class="font-icon icon fa-fw fa-sm fab fa-windows" style=""></span><a class="vp-link nav-link active vp-sidebar-title" href="/volatility/winvol.html"><!---->Windows命令参考<!----></a><!----></p><ul class="vp-sidebar-links"></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fab fa-windows" style=""></span>Windows命令参考</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/Forensics-wiki" target="_blank" rel="noopener noreferrer">Forensics-Wiki</a></span><span property="author" content="Forensics-Wiki"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-07-27T11:51:24.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 28 分钟</span><meta property="timeRequired" content="PT28M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#镜像识别">镜像识别</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#imageinfo">imageinfo</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#kdbgscan">kdbgscan</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#kpcrscan">kpcrscan</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#进程和dll">进程和dll</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#pslist">pslist</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#pstree">pstree</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#psscan">psscan</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#psdispscan">psdispscan</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#dlllist">dlllist</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#dlldump">dlldump</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#handles">handles</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#getsids">getsids</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#cmdscan">cmdscan</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#consoles">consoles</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#privs">privs</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#envars">envars</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#verinfo">verinfo</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#enumfunc">enumfunc</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#进程内存">进程内存</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#memmap">memmap</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#memdump">memdump</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#procdump">procdump</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#varinfo">varinfo</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#vadwalk">vadwalk</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#vadtree">vadtree</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#vaddump">vaddump</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#evtlogs">evtlogs</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#iehistory">iehistory</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2" href="/#核心内存和对象">核心内存和对象</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#modules">modules</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#modscan">modscan</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3" href="/#moddump">moddump</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h2 id="镜像识别" tabindex="-1"><a class="header-anchor" href="#镜像识别" aria-hidden="true">#</a> 镜像识别</h2><h3 id="imageinfo" tabindex="-1"><a class="header-anchor" href="#imageinfo" aria-hidden="true">#</a> imageinfo</h3><p>如果要获得内存的高级摘要，请使用 <code>imageinfo</code> 命令。大多数情况下，此命令用于识别操作系统、服务包和硬件体系结构（32 位或 64 位），但它还包含其他有用信息，例如 DTB 地址和内存镜像制作时间。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw imageinfo
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Determining profile based on KDBG search<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

          Suggested Profile<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token punctuation">:</span> Win7SP0x64<span class="token punctuation">,</span> Win7SP1x64<span class="token punctuation">,</span> Win2008R2SP0x64<span class="token punctuation">,</span> Win2008R2SP1x64
                     AS Layer1 <span class="token punctuation">:</span> AMD64PagedMemory <span class="token punctuation">(</span>Kernel AS<span class="token punctuation">)</span>
                     AS Layer2 <span class="token punctuation">:</span> FileAddressSpace <span class="token punctuation">(</span><span class="token operator">/</span>Users<span class="token operator">/</span>Michael<span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw<span class="token punctuation">)</span>
                      PAE <span class="token builtin">type</span> <span class="token punctuation">:</span> PAE
                           DTB <span class="token punctuation">:</span> 0x187000L
                          KDBG <span class="token punctuation">:</span> <span class="token number">0xf80002803070</span>
          Number of Processors <span class="token punctuation">:</span> <span class="token number">1</span>
     Image Type <span class="token punctuation">(</span>Service Pack<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token number">0</span>
                KPCR <span class="token keyword">for</span> CPU <span class="token number">0</span> <span class="token punctuation">:</span> 0xfffff80002804d00L
             KUSER_SHARED_DATA <span class="token punctuation">:</span> 0xfffff78000000000L
           Image date <span class="token keyword">and</span> time <span class="token punctuation">:</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">29</span><span class="token punctuation">:</span><span class="token number">02</span> UTC<span class="token operator">+</span><span class="token number">0000</span>
     Image local date <span class="token keyword">and</span> time <span class="token punctuation">:</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">03</span><span class="token punctuation">:</span><span class="token number">29</span><span class="token punctuation">:</span><span class="token number">02</span> <span class="token operator">-</span><span class="token number">0800</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>基础命令中的<code>--profile=PROFILE</code>，在 imageinfo 的输出中会告诉你所使用镜像的系统，因此需要你将<code>PROFILE</code>替换为得到的系统名称，如：<code>--profile=Win7SP0x64</code>，在随后的所有命令中，你都需要带上<code>--profile=XXXXXX</code>。另外<code>profile</code>有可能不止有一个建议的系统名称。</p><blockquote><p><code>imageinfo</code>需要指定正确的内存镜像，如果不正确，那么他可能无法运行，或者运行出空白内容。</p></blockquote><h3 id="kdbgscan" tabindex="-1"><a class="header-anchor" href="#kdbgscan" aria-hidden="true">#</a> kdbgscan</h3><p>kdbgscan主要用于识别正确的<code>porfile</code>和正确的KDBG。该插件主要用于扫描连接到内存配置文件的KDBG Header签名，如果你已经知道了<code>profile</code>那么你完全可以直接使用此插件</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f Win2K3SP2x64<span class="token operator">-</span>6f1bedec<span class="token punctuation">.</span>vmem <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win2003SP2x64 kdbgscan
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
Instantiating KDBG using<span class="token punctuation">:</span> Kernel AS Win2003SP2x64 <span class="token punctuation">(</span><span class="token number">5.2</span><span class="token number">.3791</span> 64bit<span class="token punctuation">)</span>
Offset <span class="token punctuation">(</span>V<span class="token punctuation">)</span>                    <span class="token punctuation">:</span> <span class="token number">0xf80001172cb0</span>
Offset <span class="token punctuation">(</span>P<span class="token punctuation">)</span>                    <span class="token punctuation">:</span> <span class="token number">0x1172cb0</span>
KDBG owner tag check          <span class="token punctuation">:</span> <span class="token boolean">True</span>
Profile suggestion <span class="token punctuation">(</span>KDBGHeader<span class="token punctuation">)</span><span class="token punctuation">:</span> Win2003SP2x64
Version64                     <span class="token punctuation">:</span> <span class="token number">0xf80001172c70</span> <span class="token punctuation">(</span>Major<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span> Minor<span class="token punctuation">:</span> <span class="token number">3790</span><span class="token punctuation">)</span>
Service Pack <span class="token punctuation">(</span>CmNtCSDVersion<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token number">0</span>
Build string <span class="token punctuation">(</span>NtBuildLab<span class="token punctuation">)</span>     <span class="token punctuation">:</span> T?
PsActiveProcessHead           <span class="token punctuation">:</span> <span class="token number">0xfffff800011947f0</span> <span class="token punctuation">(</span><span class="token number">0</span> processes<span class="token punctuation">)</span>
PsLoadedModuleList            <span class="token punctuation">:</span> <span class="token number">0xfffff80001197ac0</span> <span class="token punctuation">(</span><span class="token number">0</span> modules<span class="token punctuation">)</span>
KernelBase                    <span class="token punctuation">:</span> <span class="token number">0xfffff80001000000</span> <span class="token punctuation">(</span>Matches MZ<span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
Major <span class="token punctuation">(</span>OptionalHeader<span class="token punctuation">)</span>        <span class="token punctuation">:</span> <span class="token number">5</span>
Minor <span class="token punctuation">(</span>OptionalHeader<span class="token punctuation">)</span>        <span class="token punctuation">:</span> <span class="token number">2</span>

<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
Instantiating KDBG using<span class="token punctuation">:</span> Kernel AS Win2003SP2x64 <span class="token punctuation">(</span><span class="token number">5.2</span><span class="token number">.3791</span> 64bit<span class="token punctuation">)</span>
Offset <span class="token punctuation">(</span>V<span class="token punctuation">)</span>                    <span class="token punctuation">:</span> <span class="token number">0xf80001175cf0</span>
Offset <span class="token punctuation">(</span>P<span class="token punctuation">)</span>                    <span class="token punctuation">:</span> <span class="token number">0x1175cf0</span>
KDBG owner tag check          <span class="token punctuation">:</span> <span class="token boolean">True</span>
Profile suggestion <span class="token punctuation">(</span>KDBGHeader<span class="token punctuation">)</span><span class="token punctuation">:</span> Win2003SP2x64
Version64                     <span class="token punctuation">:</span> <span class="token number">0xf80001175cb0</span> <span class="token punctuation">(</span>Major<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span> Minor<span class="token punctuation">:</span> <span class="token number">3790</span><span class="token punctuation">)</span>
Service Pack <span class="token punctuation">(</span>CmNtCSDVersion<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token number">2</span>
Build string <span class="token punctuation">(</span>NtBuildLab<span class="token punctuation">)</span>     <span class="token punctuation">:</span> <span class="token number">3790</span><span class="token punctuation">.</span>srv03_sp2_rtm<span class="token punctuation">.</span><span class="token number">070216</span><span class="token operator">-</span><span class="token number">1710</span>
PsActiveProcessHead           <span class="token punctuation">:</span> <span class="token number">0xfffff800011977f0</span> <span class="token punctuation">(</span><span class="token number">37</span> processes<span class="token punctuation">)</span>
PsLoadedModuleList            <span class="token punctuation">:</span> <span class="token number">0xfffff8000119aae0</span> <span class="token punctuation">(</span><span class="token number">116</span> modules<span class="token punctuation">)</span>
KernelBase                    <span class="token punctuation">:</span> <span class="token number">0xfffff80001000000</span> <span class="token punctuation">(</span>Matches MZ<span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
Major <span class="token punctuation">(</span>OptionalHeader<span class="token punctuation">)</span>        <span class="token punctuation">:</span> <span class="token number">5</span>
Minor <span class="token punctuation">(</span>OptionalHeader<span class="token punctuation">)</span>        <span class="token punctuation">:</span> <span class="token number">2</span>
KPCR                          <span class="token punctuation">:</span> <span class="token number">0xfffff80001177000</span> <span class="token punctuation">(</span>CPU <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="kpcrscan" tabindex="-1"><a class="header-anchor" href="#kpcrscan" aria-hidden="true">#</a> kpcrscan</h3><p>使用本命令可以扫描到KPCR结构。在多核系统中，每个处理器都有自己的KPCR。因为通过这个命令，你可以看到每个处理器的详细信息。当前、空闲和下一个线程；CPU的型号，CR3等等</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f dang_win7_x64<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP1x64 kpcrscan
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
Offset <span class="token punctuation">(</span>V<span class="token punctuation">)</span>                    <span class="token punctuation">:</span> <span class="token number">0xf800029ead00</span>
Offset <span class="token punctuation">(</span>P<span class="token punctuation">)</span>                    <span class="token punctuation">:</span> <span class="token number">0x29ead00</span>
KdVersionBlock                <span class="token punctuation">:</span> <span class="token number">0x0</span>
IDT                           <span class="token punctuation">:</span> <span class="token number">0xfffff80000b95080</span>
GDT                           <span class="token punctuation">:</span> <span class="token number">0xfffff80000b95000</span>
CurrentThread                 <span class="token punctuation">:</span> <span class="token number">0xfffffa800cf694d0</span> TID <span class="token number">2148</span> <span class="token punctuation">(</span>kd<span class="token punctuation">.</span>exe<span class="token punctuation">:</span><span class="token number">2964</span><span class="token punctuation">)</span>
IdleThread                    <span class="token punctuation">:</span> <span class="token number">0xfffff800029f8c40</span> TID <span class="token number">0</span> <span class="token punctuation">(</span>Idle<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">)</span>
Details                       <span class="token punctuation">:</span> CPU <span class="token number">0</span> <span class="token punctuation">(</span>GenuineIntel @ <span class="token number">2128</span> MHz<span class="token punctuation">)</span>
CR3<span class="token operator">/</span>DTB                       <span class="token punctuation">:</span> <span class="token number">0x1dcec000</span>
<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
Offset <span class="token punctuation">(</span>V<span class="token punctuation">)</span>                    <span class="token punctuation">:</span> <span class="token number">0xf880009e7000</span>
Offset <span class="token punctuation">(</span>P<span class="token punctuation">)</span>                    <span class="token punctuation">:</span> <span class="token number">0x4d9e000</span>
KdVersionBlock                <span class="token punctuation">:</span> <span class="token number">0x0</span>
IDT                           <span class="token punctuation">:</span> <span class="token number">0xfffff880009f2540</span>
GDT                           <span class="token punctuation">:</span> <span class="token number">0xfffff880009f24c0</span>
CurrentThread                 <span class="token punctuation">:</span> <span class="token number">0xfffffa800cf694d0</span> TID <span class="token number">2148</span> <span class="token punctuation">(</span>kd<span class="token punctuation">.</span>exe<span class="token punctuation">:</span><span class="token number">2964</span><span class="token punctuation">)</span>
IdleThread                    <span class="token punctuation">:</span> <span class="token number">0xfffff880009f1f40</span> TID <span class="token number">0</span> <span class="token punctuation">(</span>Idle<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">)</span>
Details                       <span class="token punctuation">:</span> CPU <span class="token number">1</span> <span class="token punctuation">(</span>GenuineIntel @ <span class="token number">2220</span> MHz<span class="token punctuation">)</span>
CR3<span class="token operator">/</span>DTB                       <span class="token punctuation">:</span> <span class="token number">0x1dcec000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="进程和dll" tabindex="-1"><a class="header-anchor" href="#进程和dll" aria-hidden="true">#</a> 进程和dll</h2><h3 id="pslist" tabindex="-1"><a class="header-anchor" href="#pslist" aria-hidden="true">#</a> pslist</h3><p>如果要列出系统的进程，可以使用<code>pslist</code>命令。<code>PsActiveProcessHead</code>将显示<code>偏移量</code>，<code>进程名称</code>，<code>进程ID</code>，<code>父进程ID</code>，<code>线程数</code>，<code>句柄数</code>以及进程启动和退出时间。从2.1版本开始还将会显示进程是否为<a href="https://baike.baidu.com/item/WOW64/2155695" target="_blank" rel="noopener noreferrer">Wow64<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><blockquote><p>pslist不会检测隐藏或者未启动程序，如果需要请使用<a href="#psscan"><code>psscan</code></a></p></blockquote><p>如果看到具有 0 个线程、0 个句柄和/或非空退出时间的进程，则该进程实际上可能并未处于活动状态。</p><p>还要注意这两个进程<code>System</code>并不<code>smss.exe</code>会有 Session ID，因为 System 在会话建立之前启动并且<code>smss.exe</code>是会话管理器本身。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 pslist
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Offset<span class="token punctuation">(</span>V<span class="token punctuation">)</span>          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                Exit                
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token number">0xfffffa80004b09e0</span> System                    <span class="token number">4</span>      <span class="token number">0</span>     <span class="token number">78</span>      <span class="token number">489</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">20</span>                      
<span class="token number">0xfffffa8000ce97f0</span> smss<span class="token punctuation">.</span>exe                <span class="token number">208</span>      <span class="token number">4</span>      <span class="token number">2</span>       <span class="token number">29</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">20</span>                      
<span class="token number">0xfffffa8000c006c0</span> csrss<span class="token punctuation">.</span>exe               <span class="token number">296</span>    <span class="token number">288</span>      <span class="token number">9</span>      <span class="token number">385</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">24</span>                      
<span class="token number">0xfffffa8000c92300</span> wininit<span class="token punctuation">.</span>exe             <span class="token number">332</span>    <span class="token number">288</span>      <span class="token number">3</span>       <span class="token number">74</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">30</span>                      
<span class="token number">0xfffffa8000c06b30</span> csrss<span class="token punctuation">.</span>exe               <span class="token number">344</span>    <span class="token number">324</span>      <span class="token number">7</span>      <span class="token number">252</span>      <span class="token number">1</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">30</span>                      
<span class="token number">0xfffffa8000c80b30</span> winlogon<span class="token punctuation">.</span>exe            <span class="token number">372</span>    <span class="token number">324</span>      <span class="token number">5</span>      <span class="token number">136</span>      <span class="token number">1</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">31</span>                      
<span class="token number">0xfffffa8000c5eb30</span> services<span class="token punctuation">.</span>exe            <span class="token number">428</span>    <span class="token number">332</span>      <span class="token number">6</span>      <span class="token number">193</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">32</span>                      
<span class="token number">0xfffffa80011c5700</span> lsass<span class="token punctuation">.</span>exe               <span class="token number">444</span>    <span class="token number">332</span>      <span class="token number">6</span>      <span class="token number">557</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">32</span>                      
<span class="token number">0xfffffa8000ea31b0</span> lsm<span class="token punctuation">.</span>exe                 <span class="token number">452</span>    <span class="token number">332</span>     <span class="token number">10</span>      <span class="token number">133</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">32</span>                      
<span class="token number">0xfffffa8001296b30</span> svchost<span class="token punctuation">.</span>exe             <span class="token number">568</span>    <span class="token number">428</span>     <span class="token number">10</span>      <span class="token number">352</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">34</span>                      
<span class="token number">0xfffffa80012c3620</span> svchost<span class="token punctuation">.</span>exe             <span class="token number">628</span>    <span class="token number">428</span>      <span class="token number">6</span>      <span class="token number">247</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">34</span>                      
<span class="token number">0xfffffa8001325950</span> sppsvc<span class="token punctuation">.</span>exe              <span class="token number">816</span>    <span class="token number">428</span>      <span class="token number">5</span>      <span class="token number">154</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">41</span>                      
<span class="token number">0xfffffa80007b7960</span> svchost<span class="token punctuation">.</span>exe             <span class="token number">856</span>    <span class="token number">428</span>     <span class="token number">16</span>      <span class="token number">404</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">43</span>                      
<span class="token number">0xfffffa80007bb750</span> svchost<span class="token punctuation">.</span>exe             <span class="token number">880</span>    <span class="token number">428</span>     <span class="token number">34</span>     <span class="token number">1118</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">43</span>                      
<span class="token number">0xfffffa80007d09e0</span> svchost<span class="token punctuation">.</span>exe             <span class="token number">916</span>    <span class="token number">428</span>     <span class="token number">19</span>      <span class="token number">443</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">43</span>                      
<span class="token number">0xfffffa8000c64840</span> svchost<span class="token punctuation">.</span>exe             <span class="token number">348</span>    <span class="token number">428</span>     <span class="token number">14</span>      <span class="token number">338</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">07</span>                      
<span class="token number">0xfffffa8000c09630</span> svchost<span class="token punctuation">.</span>exe             <span class="token number">504</span>    <span class="token number">428</span>     <span class="token number">16</span>      <span class="token number">496</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">07</span>                      
<span class="token number">0xfffffa8000e86690</span> spoolsv<span class="token punctuation">.</span>exe            <span class="token number">1076</span>    <span class="token number">428</span>     <span class="token number">12</span>      <span class="token number">271</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">10</span>                      
<span class="token number">0xfffffa8000518b30</span> svchost<span class="token punctuation">.</span>exe            <span class="token number">1104</span>    <span class="token number">428</span>     <span class="token number">18</span>      <span class="token number">307</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">10</span>                      
<span class="token number">0xfffffa800094d960</span> wlms<span class="token punctuation">.</span>exe               <span class="token number">1264</span>    <span class="token number">428</span>      <span class="token number">4</span>       <span class="token number">43</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">11</span>                      
<span class="token number">0xfffffa8000995b30</span> svchost<span class="token punctuation">.</span>exe            <span class="token number">1736</span>    <span class="token number">428</span>     <span class="token number">12</span>      <span class="token number">200</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">25</span>                      
<span class="token number">0xfffffa8000aa0b30</span> SearchIndexer<span class="token punctuation">.</span>         <span class="token number">1800</span>    <span class="token number">428</span>     <span class="token number">12</span>      <span class="token number">757</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">26</span>                      
<span class="token number">0xfffffa8000aea630</span> taskhost<span class="token punctuation">.</span>exe           <span class="token number">1144</span>    <span class="token number">428</span>      <span class="token number">7</span>      <span class="token number">189</span>      <span class="token number">1</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">41</span>                      
<span class="token number">0xfffffa8000eafb30</span> dwm<span class="token punctuation">.</span>exe                <span class="token number">1476</span>    <span class="token number">856</span>      <span class="token number">3</span>       <span class="token number">71</span>      <span class="token number">1</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">41</span>                      
<span class="token number">0xfffffa80008f3420</span> explorer<span class="token punctuation">.</span>exe           <span class="token number">1652</span>    <span class="token number">840</span>     <span class="token number">21</span>      <span class="token number">760</span>      <span class="token number">1</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">42</span>                      
<span class="token number">0xfffffa8000c9a630</span> regsvr32<span class="token punctuation">.</span>exe           <span class="token number">1180</span>   <span class="token number">1652</span>      <span class="token number">0</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>      <span class="token number">1</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">03</span><span class="token punctuation">:</span><span class="token number">05</span>  <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">03</span><span class="token punctuation">:</span><span class="token number">08</span> 
<span class="token number">0xfffffa8000a03b30</span> rundll32<span class="token punctuation">.</span>exe           <span class="token number">2016</span>    <span class="token number">568</span>      <span class="token number">3</span>       <span class="token number">67</span>      <span class="token number">1</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">03</span><span class="token punctuation">:</span><span class="token number">16</span>                      
<span class="token number">0xfffffa8000a4f630</span> svchost<span class="token punctuation">.</span>exe            <span class="token number">1432</span>    <span class="token number">428</span>     <span class="token number">12</span>      <span class="token number">350</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">04</span><span class="token punctuation">:</span><span class="token number">14</span>                      
<span class="token number">0xfffffa8000999780</span> iexplore<span class="token punctuation">.</span>exe           <span class="token number">1892</span>   <span class="token number">1652</span>     <span class="token number">19</span>      <span class="token number">688</span>      <span class="token number">1</span>      <span class="token number">1</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">:</span><span class="token number">12</span>                      
<span class="token number">0xfffffa80010c9060</span> iexplore<span class="token punctuation">.</span>exe           <span class="token number">2820</span>   <span class="token number">1892</span>     <span class="token number">23</span>      <span class="token number">733</span>      <span class="token number">1</span>      <span class="token number">1</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">:</span><span class="token number">15</span>                      
<span class="token number">0xfffffa8001016060</span> DumpIt<span class="token punctuation">.</span>exe             <span class="token number">2860</span>   <span class="token number">1652</span>      <span class="token number">2</span>       <span class="token number">42</span>      <span class="token number">1</span>      <span class="token number">1</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">:</span><span class="token number">59</span>                      
<span class="token number">0xfffffa8000acab30</span> conhost<span class="token punctuation">.</span>exe            <span class="token number">2236</span>    <span class="token number">344</span>      <span class="token number">2</span>       <span class="token number">51</span>      <span class="token number">1</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">11</span><span class="token punctuation">:</span><span class="token number">28</span><span class="token punctuation">:</span><span class="token number">59</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>默认情况下，<code>pslist</code>显示虚拟偏移量，<code>_EPROCESS</code>但物理偏移量可以通过<code>-P</code>开关获得：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 pslist <span class="token operator">-</span>P 
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Offset<span class="token punctuation">(</span>P<span class="token punctuation">)</span>          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                Exit                
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token number">0x0000000017fef9e0</span> System                    <span class="token number">4</span>      <span class="token number">0</span>     <span class="token number">78</span>      <span class="token number">489</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">20</span>                      
<span class="token number">0x00000000176e97f0</span> smss<span class="token punctuation">.</span>exe                <span class="token number">208</span>      <span class="token number">4</span>      <span class="token number">2</span>       <span class="token number">29</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">20</span>                      
<span class="token number">0x00000000176006c0</span> csrss<span class="token punctuation">.</span>exe               <span class="token number">296</span>    <span class="token number">288</span>      <span class="token number">9</span>      <span class="token number">385</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">24</span>                      
<span class="token number">0x0000000017692300</span> wininit<span class="token punctuation">.</span>exe             <span class="token number">332</span>    <span class="token number">288</span>      <span class="token number">3</span>       <span class="token number">74</span>      <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">30</span>                      
<span class="token number">0x0000000017606b30</span> csrss<span class="token punctuation">.</span>exe               <span class="token number">344</span>    <span class="token number">324</span>      <span class="token number">7</span>      <span class="token number">252</span>      <span class="token number">1</span>      <span class="token number">0</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">30</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="pstree" tabindex="-1"><a class="header-anchor" href="#pstree" aria-hidden="true">#</a> pstree</h3><p>如果要以进程树的形式查看进行列表，请使用<code>pstree</code>命令。他的原理和<code>pslist</code>相同，因此不会显示隐藏或未启动的进程.子进程使用缩进和<code>.</code>表示。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 pstree
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Name                                                  Pid   PPid   Thds   Hnds Time                
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
 <span class="token number">0xfffffa80004b09e0</span><span class="token punctuation">:</span>System                              <span class="token number">4</span>      <span class="token number">0</span>     <span class="token number">78</span>    <span class="token number">489</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">20</span> 
<span class="token punctuation">.</span> <span class="token number">0xfffffa8000ce97f0</span><span class="token punctuation">:</span>smss<span class="token punctuation">.</span>exe                         <span class="token number">208</span>      <span class="token number">4</span>      <span class="token number">2</span>     <span class="token number">29</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">20</span> 
 <span class="token number">0xfffffa8000c006c0</span><span class="token punctuation">:</span>csrss<span class="token punctuation">.</span>exe                         <span class="token number">296</span>    <span class="token number">288</span>      <span class="token number">9</span>    <span class="token number">385</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">24</span> 
 <span class="token number">0xfffffa8000c92300</span><span class="token punctuation">:</span>wininit<span class="token punctuation">.</span>exe                       <span class="token number">332</span>    <span class="token number">288</span>      <span class="token number">3</span>     <span class="token number">74</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">30</span> 
<span class="token punctuation">.</span> <span class="token number">0xfffffa8000c5eb30</span><span class="token punctuation">:</span>services<span class="token punctuation">.</span>exe                     <span class="token number">428</span>    <span class="token number">332</span>      <span class="token number">6</span>    <span class="token number">193</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">32</span> 
<span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">0xfffffa8000aa0b30</span><span class="token punctuation">:</span>SearchIndexer<span class="token punctuation">.</span>                 <span class="token number">1800</span>    <span class="token number">428</span>     <span class="token number">12</span>    <span class="token number">757</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">26</span> 
<span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">0xfffffa80007d09e0</span><span class="token punctuation">:</span>svchost<span class="token punctuation">.</span>exe                     <span class="token number">916</span>    <span class="token number">428</span>     <span class="token number">19</span>    <span class="token number">443</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">43</span> 
<span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">0xfffffa8000a4f630</span><span class="token punctuation">:</span>svchost<span class="token punctuation">.</span>exe                    <span class="token number">1432</span>    <span class="token number">428</span>     <span class="token number">12</span>    <span class="token number">350</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">04</span><span class="token punctuation">:</span><span class="token number">14</span> 
<span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">0xfffffa800094d960</span><span class="token punctuation">:</span>wlms<span class="token punctuation">.</span>exe                       <span class="token number">1264</span>    <span class="token number">428</span>      <span class="token number">4</span>     <span class="token number">43</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">11</span> 
<span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">0xfffffa8001325950</span><span class="token punctuation">:</span>sppsvc<span class="token punctuation">.</span>exe                      <span class="token number">816</span>    <span class="token number">428</span>      <span class="token number">5</span>    <span class="token number">154</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">41</span> 
<span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">0xfffffa8000e86690</span><span class="token punctuation">:</span>spoolsv<span class="token punctuation">.</span>exe                    <span class="token number">1076</span>    <span class="token number">428</span>     <span class="token number">12</span>    <span class="token number">271</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">02</span><span class="token punctuation">:</span><span class="token number">10</span> 
<span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">0xfffffa8001296b30</span><span class="token punctuation">:</span>svchost<span class="token punctuation">.</span>exe                     <span class="token number">568</span>    <span class="token number">428</span>     <span class="token number">10</span>    <span class="token number">352</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">19</span><span class="token punctuation">:</span><span class="token number">58</span><span class="token punctuation">:</span><span class="token number">34</span> 
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">0xfffffa8000a03b30</span><span class="token punctuation">:</span>rundll32<span class="token punctuation">.</span>exe                  <span class="token number">2016</span>    <span class="token number">568</span>      <span class="token number">3</span>     <span class="token number">67</span> <span class="token number">2012</span><span class="token operator">-</span><span class="token number">02</span><span class="token operator">-</span><span class="token number">22</span> <span class="token number">20</span><span class="token punctuation">:</span><span class="token number">03</span><span class="token punctuation">:</span><span class="token number">16</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="psscan" tabindex="-1"><a class="header-anchor" href="#psscan" aria-hidden="true">#</a> psscan</h3><p>要扫描所有的进程，请使用<code>psscan</code>命令。他可以找到之前已经终止了的进程、已经被<code>rootkit</code>隐藏的进程或者取消链接的进程。缺点就是<code>rookit</code>依然可以使用覆盖标签池的方法来隐藏进程。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x86 <span class="token operator">-</span>f win7<span class="token punctuation">.</span>dmp psscan
Volatility Foundation Volatility Framework <span class="token number">2.0</span>
 Offset     Name             PID    PPID   PDB        Time created             Time exited             
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> 
<span class="token number">0x3e025ba8</span> svchost<span class="token punctuation">.</span>exe        <span class="token number">1116</span>    <span class="token number">508</span> <span class="token number">0x3ecf1220</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">25</span>                              
<span class="token number">0x3e04f070</span> svchost<span class="token punctuation">.</span>exe        <span class="token number">1152</span>    <span class="token number">508</span> <span class="token number">0x3ecf1340</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">27</span><span class="token punctuation">:</span><span class="token number">40</span>                              
<span class="token number">0x3e144c08</span> dwm<span class="token punctuation">.</span>exe            <span class="token number">1540</span>    <span class="token number">832</span> <span class="token number">0x3ecf12e0</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">26</span><span class="token punctuation">:</span><span class="token number">58</span>                              
<span class="token number">0x3e145c18</span> TPAutoConnSvc<span class="token punctuation">.</span>     <span class="token number">1900</span>    <span class="token number">508</span> <span class="token number">0x3ecf1360</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">41</span>                              
<span class="token number">0x3e3393f8</span> lsass<span class="token punctuation">.</span>exe           <span class="token number">516</span>    <span class="token number">392</span> <span class="token number">0x3ecf10e0</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">18</span>                              
<span class="token number">0x3e35b8f8</span> svchost<span class="token punctuation">.</span>exe         <span class="token number">628</span>    <span class="token number">508</span> <span class="token number">0x3ecf1120</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">19</span>                              
<span class="token number">0x3e383770</span> svchost<span class="token punctuation">.</span>exe         <span class="token number">832</span>    <span class="token number">508</span> <span class="token number">0x3ecf11a0</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">20</span>                              
<span class="token number">0x3e3949d0</span> svchost<span class="token punctuation">.</span>exe         <span class="token number">740</span>    <span class="token number">508</span> <span class="token number">0x3ecf1160</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">20</span>                              
<span class="token number">0x3e3a5100</span> svchost<span class="token punctuation">.</span>exe         <span class="token number">872</span>    <span class="token number">508</span> <span class="token number">0x3ecf11c0</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">20</span>                              
<span class="token number">0x3e3f64e8</span> svchost<span class="token punctuation">.</span>exe         <span class="token number">992</span>    <span class="token number">508</span> <span class="token number">0x3ecf1200</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">24</span>                              
<span class="token number">0x3e45a530</span> wininit<span class="token punctuation">.</span>exe         <span class="token number">392</span>    <span class="token number">316</span> <span class="token number">0x3ecf10a0</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">15</span>                              
<span class="token number">0x3e45d928</span> svchost<span class="token punctuation">.</span>exe        <span class="token number">1304</span>    <span class="token number">508</span> <span class="token number">0x3ecf1260</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">28</span>                              
<span class="token number">0x3e45f530</span> csrss<span class="token punctuation">.</span>exe           <span class="token number">400</span>    <span class="token number">384</span> <span class="token number">0x3ecf1040</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">15</span>                              
<span class="token number">0x3e4d89c8</span> vmtoolsd<span class="token punctuation">.</span>exe       <span class="token number">1436</span>    <span class="token number">508</span> <span class="token number">0x3ecf1280</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">30</span>                              
<span class="token number">0x3e4db030</span> spoolsv<span class="token punctuation">.</span>exe        <span class="token number">1268</span>    <span class="token number">508</span> <span class="token number">0x3ecf1240</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">28</span>                              
<span class="token number">0x3e50b318</span> services<span class="token punctuation">.</span>exe        <span class="token number">508</span>    <span class="token number">392</span> <span class="token number">0x3ecf1080</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">18</span>                              
<span class="token number">0x3e7f3d40</span> csrss<span class="token punctuation">.</span>exe           <span class="token number">352</span>    <span class="token number">316</span> <span class="token number">0x3ecf1060</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">12</span>                              
<span class="token number">0x3e7f5bc0</span> winlogon<span class="token punctuation">.</span>exe        <span class="token number">464</span>    <span class="token number">384</span> <span class="token number">0x3ecf10c0</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">25</span><span class="token punctuation">:</span><span class="token number">18</span>                              
<span class="token number">0x3eac6030</span> SearchProtocol     <span class="token number">2448</span>   <span class="token number">1168</span> <span class="token number">0x3ecf15c0</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">:</span><span class="token number">52</span>      <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token number">14</span>     
<span class="token number">0x3eb10030</span> SearchFilterHo     <span class="token number">1812</span>   <span class="token number">1168</span> <span class="token number">0x3ecf1480</span> <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">31</span><span class="token punctuation">:</span><span class="token number">02</span>      <span class="token number">2010</span><span class="token operator">-</span><span class="token number">06</span><span class="token operator">-</span><span class="token number">16</span> <span class="token number">23</span><span class="token punctuation">:</span><span class="token number">33</span><span class="token punctuation">:</span><span class="token number">14</span> 
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果进程在之前已经停止了，那么就会显示他的<code>Time exited</code>。</p><h3 id="psdispscan" tabindex="-1"><a class="header-anchor" href="#psdispscan" aria-hidden="true">#</a> psdispscan</h3><p>这个插件类似于<code>psscan</code>，但是他是通过扫描<code>DISPATCHER_HEADER</code>来列举进程，而不是扫描进程池。因此，当他们通过覆盖标签池的方法来隐藏进程的话，那么他就会失效。但是这个插件没有得到很好的维护，导致了它只能在<code>XP ×86</code>下运行。如果要使用它，可以在命令行使用<code>--plugins=contrib/plugins</code>。</p><h3 id="dlllist" tabindex="-1"><a class="header-anchor" href="#dlllist" aria-hidden="true">#</a> dlllist</h3><p>如果需要显示进程加载的dll，那么请使用<code>dlllist</code>命令。并且他还会告诉你这是一个静态加载还是动态加载。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 dlllist 
<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
wininit<span class="token punctuation">.</span>exe pid<span class="token punctuation">:</span>    <span class="token number">332</span>
Command line <span class="token punctuation">:</span> wininit<span class="token punctuation">.</span>exe

Base                             Size          LoadCount Path
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token number">0x00000000ff530000</span>            <span class="token number">0x23000</span>             <span class="token number">0xffff</span> C<span class="token punctuation">:</span>\Windows\system32\wininit<span class="token punctuation">.</span>exe
<span class="token number">0x0000000076d40000</span>           <span class="token number">0x1ab000</span>             <span class="token number">0xffff</span> C<span class="token punctuation">:</span>\Windows\SYSTEM32\ntdll<span class="token punctuation">.</span>dll
<span class="token number">0x0000000076b20000</span>           <span class="token number">0x11f000</span>             <span class="token number">0xffff</span> C<span class="token punctuation">:</span>\Windows\system32\kernel32<span class="token punctuation">.</span>dll
<span class="token number">0x000007fefcd50000</span>            <span class="token number">0x6b000</span>             <span class="token number">0xffff</span> C<span class="token punctuation">:</span>\Windows\system32\KERNELBASE<span class="token punctuation">.</span>dll
<span class="token number">0x0000000076c40000</span>            <span class="token number">0xfa000</span>             <span class="token number">0xffff</span> C<span class="token punctuation">:</span>\Windows\system32\USER32<span class="token punctuation">.</span>dll
<span class="token number">0x000007fefd7c0000</span>            <span class="token number">0x67000</span>             <span class="token number">0xffff</span> C<span class="token punctuation">:</span>\Windows\system32\GDI32<span class="token punctuation">.</span>dll
<span class="token number">0x000007fefe190000</span>             <span class="token number">0xe000</span>             <span class="token number">0xffff</span> C<span class="token punctuation">:</span>\Windows\system32\LPK<span class="token punctuation">.</span>dll
<span class="token number">0x000007fefef80000</span>            <span class="token number">0xca000</span>             <span class="token number">0xffff</span> C<span class="token punctuation">:</span>\Windows\system32\USP10<span class="token punctuation">.</span>dll
<span class="token number">0x000007fefd860000</span>            <span class="token number">0x9f000</span>             <span class="token number">0xffff</span> C<span class="token punctuation">:</span>\Windows\system32\msvcrt<span class="token punctuation">.</span>dll
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>如果要显示指定进程的dll，请使用<code>-p</code>或者<code>--pid</code>过滤</p></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ python vol.py -f ~/Desktop/win7_trial_64bit.raw --profile=Win7SP0x64 dlllist -p 1892
Volatility Foundation Volatility Framework 2.4
************************************************************************
iexplore.exe pid:   1892
Command line : &quot;C:\Program Files (x86)\Internet Explorer\iexplore.exe&quot; 
Note: use ldrmodules for listing DLLs in Wow64 processes

Base                             Size          LoadCount Path
------------------ ------------------ ------------------ ----
0x0000000000080000            0xa6000             0xffff C:\Program Files (x86)\Internet Explorer\iexplore.exe
0x0000000076d40000           0x1ab000             0xffff C:\Windows\SYSTEM32\ntdll.dll
0x00000000748d0000            0x3f000                0x3 C:\Windows\SYSTEM32\wow64.dll
0x0000000074870000            0x5c000                0x1 C:\Windows\SYSTEM32\wow64win.dll
0x0000000074940000             0x8000                0x1 C:\Windows\SYSTEM32\wow64cpu.dll
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>要显示被 rootkit 隐藏或没有链接的进程的 DLL，首先使用 <code>psscan</code> 获取 EPROCESS 对象的物理偏移量并为其提供 <code>--offset=OFFSET</code>。该插件将“反弹”并确定 <code>EPROCESS 的虚拟地址</code>，然后获取地址空间以访问 <code>PEB</code>。</p></blockquote><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 dlllist <span class="token operator">-</span><span class="token operator">-</span>offset<span class="token operator">=</span><span class="token number">0x04a291a8</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="dlldump" tabindex="-1"><a class="header-anchor" href="#dlldump" aria-hidden="true">#</a> dlldump</h3><p>从内存镜像中把dll转存出来，请使用<code>dlldump</code>命令。语法和上面的<a href="#dlllist"><code>dlllist</code></a>类似。该命令拥有如下功能：</p><ul><li>转存所有进程中的所有 DLL</li><li>转存指定的进程的所有 DLL（使用<code>--pid=PID</code>）</li><li>从隐藏/未链接的进程中转储所有 DLL（带有<code>--offset=OFFSET</code>）</li><li>从进程内存中的任何位置转储 PE（使用<code>--base=BASEADDR</code>），此选项对于提取隐藏的 DLL 很有用</li><li>转储匹配正则表达式 ( <code>--regex=REGEX</code>) 的一个或多个 DLL，区分大小写或不区分大小写 ( <code>--ignore-case</code>)</li><li>要指定输出目录，请使用<code>--dump-dir=DIR</code>或<code>-d DIR</code>。</li></ul><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ python vol.py -f ~/Desktop/win7_trial_64bit.raw --profile=Win7SP0x64 dlldump -D dlls/
...
Process(V)         Name                 Module Base        Module Name          Result
------------------ -------------------- ------------------ -------------------- ------
0xfffffa8000ce97f0 smss.exe             0x0000000047a90000 smss.exe             OK: module.208.176e97f0.47a90000.dll
0xfffffa8000ce97f0 smss.exe             0x0000000076d40000                      Error: DllBase is paged
0xfffffa8000c006c0 csrss.exe            0x0000000049700000 csrss.exe            OK: module.296.176006c0.49700000.dll
0xfffffa8000c006c0 csrss.exe            0x0000000076d40000 ntdll.dll            Error: DllBase is paged
0xfffffa8000c006c0 csrss.exe            0x000007fefd860000 msvcrt.dll           Error: DllBase is paged
0xfffffa80011c5700 lsass.exe            0x000007fefcc40000 WINSTA.dll           Error: DllBase is paged
0xfffffa80011c5700 lsass.exe            0x000007fefd7c0000 GDI32.dll            OK: module.444.173c5700.7fefd7c0000.dll
0xfffffa80011c5700 lsass.exe            0x000007fefc270000 DNSAPI.dll           OK: module.444.173c5700.7fefc270000.dll
0xfffffa80011c5700 lsass.exe            0x000007fefc5d0000 Secur32.dll          OK: module.444.173c5700.7fefc5d0000.dll
...
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果提取失败，就像上面的几个 DLL 一样，这可能意味着该 DLL 中的某些内容不是存在内存中的。在这些情况下，您仍然可以使用<a href="#vaddump">vaddump</a>命令提取内存段，但是你需要手动重建PE标头，并且修复这些内容。</p><p>要转储 DLL 列表中不存在的 PE 文件（例如，由于代码注入或恶意取消链接），只需指定 PE 在进程内存中的基地址：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x86 <span class="token operator">-</span>f win7<span class="token punctuation">.</span>dmp dlldump <span class="token operator">-</span><span class="token operator">-</span>pid<span class="token operator">=</span><span class="token number">492</span> <span class="token operator">-</span>D out <span class="token operator">-</span><span class="token operator">-</span>base<span class="token operator">=</span><span class="token number">0x00680000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果您想要的 DLL 在隐藏进程中，您还可以指定 EPROCESS 偏移量：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x86 <span class="token operator">-</span>f win7<span class="token punctuation">.</span>dmp dlldump <span class="token operator">-</span>o <span class="token number">0x3e3f64e8</span> <span class="token operator">-</span>D out <span class="token operator">-</span><span class="token operator">-</span>base<span class="token operator">=</span><span class="token number">0x00680000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="handles" tabindex="-1"><a class="header-anchor" href="#handles" aria-hidden="true">#</a> handles</h3><p>如果需要显示进程中打开的句柄，请使用<code>handles</code>命令。它适用于文件、注册表、桌面、线程和其他所有类型的安全执行对象，从2.1版本开始，还会显示每个对象的句柄值和其权限</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 handles
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Offset<span class="token punctuation">(</span>V<span class="token punctuation">)</span>             Pid             Handle             Access Type             Details
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token number">0xfffffa80004b09e0</span>      <span class="token number">4</span>                <span class="token number">0x4</span>           <span class="token number">0x1fffff</span> Process          System<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token number">0xfffff8a0000821a0</span>      <span class="token number">4</span>               <span class="token number">0x10</span>            <span class="token number">0x2001f</span> Key              MACHINE\SYSTEM\CONTROLSET001\CONTROL\PRODUCTOPTIONS
<span class="token number">0xfffff8a00007e040</span>      <span class="token number">4</span>               <span class="token number">0x14</span>            <span class="token number">0xf003f</span> Key              MACHINE\SYSTEM\CONTROLSET001\CONTROL\SESSION MANAGER\MEMORY MANAGEMENT\PREFETCHPARAMETERS
<span class="token number">0xfffff8a000081fa0</span>      <span class="token number">4</span>               <span class="token number">0x18</span>            <span class="token number">0x2001f</span> Key              MACHINE\SYSTEM\SETUP
<span class="token number">0xfffffa8000546990</span>      <span class="token number">4</span>               <span class="token number">0x1c</span>           <span class="token number">0x1f0001</span> ALPC Port        PowerMonitorPort
<span class="token number">0xfffffa800054d070</span>      <span class="token number">4</span>               <span class="token number">0x20</span>           <span class="token number">0x1f0001</span> ALPC Port        PowerPort
<span class="token number">0xfffff8a0000676a0</span>      <span class="token number">4</span>               <span class="token number">0x24</span>            <span class="token number">0x20019</span> Key              MACHINE\HARDWARE\DESCRIPTION\SYSTEM\MULTIFUNCTIONADAPTER
<span class="token number">0xfffffa8000625460</span>      <span class="token number">4</span>               <span class="token number">0x28</span>           <span class="token number">0x1fffff</span> Thread           TID <span class="token number">160</span> PID <span class="token number">4</span>
<span class="token number">0xfffff8a00007f400</span>      <span class="token number">4</span>               <span class="token number">0x2c</span>            <span class="token number">0xf003f</span> Key              MACHINE\SYSTEM\CONTROLSET001
<span class="token number">0xfffff8a00007f200</span>      <span class="token number">4</span>               <span class="token number">0x30</span>            <span class="token number">0xf003f</span> Key              MACHINE\SYSTEM\CONTROLSET001\ENUM
<span class="token number">0xfffff8a000080d10</span>      <span class="token number">4</span>               <span class="token number">0x34</span>            <span class="token number">0xf003f</span> Key              MACHINE\SYSTEM\CONTROLSET001\CONTROL\CLASS
<span class="token class-name">0xfffff8a00007f500</span>      <span class="token number">4</span>               <span class="token number">0x38</span>            <span class="token number">0xf003f</span> Key              MACHINE\SYSTEM\CONTROLSET001\SERVICES
<span class="token number">0xfffff8a0001cd990</span>      <span class="token number">4</span>               <span class="token number">0x3c</span>                <span class="token number">0xe</span> Token            
<span class="token number">0xfffff8a00007bfa0</span>      <span class="token number">4</span>               <span class="token number">0x40</span>            <span class="token number">0x20019</span> Key              MACHINE\SYSTEM\CONTROLSET001\CONTROL\WMI\SECURITY
<span class="token number">0xfffffa8000cd52b0</span>      <span class="token number">4</span>               <span class="token number">0x44</span>           <span class="token number">0x120116</span> File             \Device\Mup
<span class="token number">0xfffffa8000ce97f0</span>      <span class="token number">4</span>               <span class="token number">0x48</span>               <span class="token number">0x2a</span> Process          smss<span class="token punctuation">.</span>exe<span class="token punctuation">(</span><span class="token number">208</span><span class="token punctuation">)</span>
<span class="token number">0xfffffa8000df16f0</span>      <span class="token number">4</span>               <span class="token number">0x4c</span>           <span class="token number">0x120089</span> File             \Device\HarddiskVolume2\Windows\System32\en<span class="token operator">-</span>US\win32k<span class="token punctuation">.</span>sys<span class="token punctuation">.</span>mui
<span class="token number">0xfffffa8000de37f0</span>      <span class="token number">4</span>               <span class="token number">0x50</span>           <span class="token number">0x12019f</span> File             \Device\clfsTxfLog
<span class="token number">0xfffff8a000952fa0</span>      <span class="token number">4</span>               <span class="token number">0x54</span>            <span class="token number">0x2001f</span> Key              MACHINE\SYSTEM\CONTROLSET001\CONTROL\VIDEO\<span class="token punctuation">{</span>6A8FC9DC<span class="token operator">-</span>A76B<span class="token operator">-</span>47FC<span class="token operator">-</span>A703<span class="token operator">-</span>17800182E1CE<span class="token punctuation">}</span>\<span class="token number">0000</span>\VOLATILESETTINGS
<span class="token number">0xfffffa800078da20</span>      <span class="token number">4</span>               <span class="token number">0x58</span>           <span class="token number">0x12019f</span> File             \Device\Tcp
<span class="token number">0xfffff8a002e17610</span>      <span class="token number">4</span>               <span class="token number">0x5c</span>                <span class="token number">0x9</span> Key              MACHINE\SOFTWARE\MICROSOFT\WINDOWS NT\CURRENTVERSION\IMAGE FILE EXECUTION OPTIONS
<span class="token number">0xfffff8a0008f7b00</span>      <span class="token number">4</span>               <span class="token number">0x60</span>               <span class="token number">0x10</span> Key              MACHINE\SYSTEM\CONTROLSET001\CONTROL\LSA
<span class="token number">0xfffffa8000da2870</span>      <span class="token number">4</span>               <span class="token number">0x64</span>           <span class="token number">0x100001</span> File             \Device\KsecDD
<span class="token number">0xfffffa8000da3040</span>      <span class="token number">4</span>               <span class="token number">0x68</span>                <span class="token number">0x0</span> Thread           TID <span class="token number">228</span> PID <span class="token number">4</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>--pid=PID</code>你可以通过指定或结构的物理偏移量<code>_EPROCESS</code>( <code>--physical-offset=OFFSET</code>)来显示指定进程的句柄。你还可以使用<code>-t</code>或按对象类型进行过滤<code>--object-type=OBJECTTYPE</code>。例如，要只显示 pid=600 的进程对象的句柄，可以执行以下操作：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 handles <span class="token operator">-</span>p <span class="token number">296</span> <span class="token operator">-</span>t Process
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Offset<span class="token punctuation">(</span>V<span class="token punctuation">)</span>             Pid             Handle             Access Type             Details
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token number">0xfffffa8000c92300</span>    <span class="token number">296</span>               <span class="token number">0x54</span>           <span class="token number">0x1fffff</span> Process          wininit<span class="token punctuation">.</span>exe<span class="token punctuation">(</span><span class="token number">332</span><span class="token punctuation">)</span>
<span class="token number">0xfffffa8000c5eb30</span>    <span class="token number">296</span>               <span class="token number">0xc4</span>           <span class="token number">0x1fffff</span> Process          services<span class="token punctuation">.</span>exe<span class="token punctuation">(</span><span class="token number">428</span><span class="token punctuation">)</span>
<span class="token number">0xfffffa80011c5700</span>    <span class="token number">296</span>               <span class="token number">0xd4</span>           <span class="token number">0x1fffff</span> Process          lsass<span class="token punctuation">.</span>exe<span class="token punctuation">(</span><span class="token number">444</span><span class="token punctuation">)</span>
<span class="token number">0xfffffa8000ea31b0</span>    <span class="token number">296</span>               <span class="token number">0xe4</span>           <span class="token number">0x1fffff</span> Process          lsm<span class="token punctuation">.</span>exe<span class="token punctuation">(</span><span class="token number">452</span><span class="token punctuation">)</span>
<span class="token number">0xfffffa8000c64840</span>    <span class="token number">296</span>              <span class="token number">0x140</span>           <span class="token number">0x1fffff</span> Process          svchost<span class="token punctuation">.</span>exe<span class="token punctuation">(</span><span class="token number">348</span><span class="token punctuation">)</span>
<span class="token number">0xfffffa8001296b30</span>    <span class="token number">296</span>              <span class="token number">0x150</span>           <span class="token number">0x1fffff</span> Process          svchost<span class="token punctuation">.</span>exe<span class="token punctuation">(</span><span class="token number">568</span><span class="token punctuation">)</span>
<span class="token number">0xfffffa80012c3620</span>    <span class="token number">296</span>              <span class="token number">0x18c</span>           <span class="token number">0x1fffff</span> Process          svchost<span class="token punctuation">.</span>exe<span class="token punctuation">(</span><span class="token number">628</span><span class="token punctuation">)</span>
<span class="token number">0xfffffa8001325950</span>    <span class="token number">296</span>              <span class="token number">0x1dc</span>           <span class="token number">0x1fffff</span> Process          sppsvc<span class="token punctuation">.</span>exe<span class="token punctuation">(</span><span class="token number">816</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="getsids" tabindex="-1"><a class="header-anchor" href="#getsids" aria-hidden="true">#</a> getsids</h3><p>要查看与进程关联的 SID（安全标识符），请使用 <code>getsids</code> 命令。这可以帮助你识别具有恶意升级权限的进程以及哪些进程属于特定用户。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 getsids
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
System <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span> S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">18</span> <span class="token punctuation">(</span>Local System<span class="token punctuation">)</span>
System <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span> S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">32</span><span class="token operator">-</span><span class="token number">544</span> <span class="token punctuation">(</span>Administrators<span class="token punctuation">)</span>
System <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span> S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">0</span> <span class="token punctuation">(</span>Everyone<span class="token punctuation">)</span>
System <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span> S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">11</span> <span class="token punctuation">(</span>Authenticated Users<span class="token punctuation">)</span>
System <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span> S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">16384</span> <span class="token punctuation">(</span>System Mandatory Level<span class="token punctuation">)</span>
smss<span class="token punctuation">.</span>exe <span class="token punctuation">(</span><span class="token number">208</span><span class="token punctuation">)</span><span class="token punctuation">:</span> S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">18</span> <span class="token punctuation">(</span>Local System<span class="token punctuation">)</span>
smss<span class="token punctuation">.</span>exe <span class="token punctuation">(</span><span class="token number">208</span><span class="token punctuation">)</span><span class="token punctuation">:</span> S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">32</span><span class="token operator">-</span><span class="token number">544</span> <span class="token punctuation">(</span>Administrators<span class="token punctuation">)</span>
smss<span class="token punctuation">.</span>exe <span class="token punctuation">(</span><span class="token number">208</span><span class="token punctuation">)</span><span class="token punctuation">:</span> S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">0</span> <span class="token punctuation">(</span>Everyone<span class="token punctuation">)</span>
smss<span class="token punctuation">.</span>exe <span class="token punctuation">(</span><span class="token number">208</span><span class="token punctuation">)</span><span class="token punctuation">:</span> S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">11</span> <span class="token punctuation">(</span>Authenticated Users<span class="token punctuation">)</span>
smss<span class="token punctuation">.</span>exe <span class="token punctuation">(</span><span class="token number">208</span><span class="token punctuation">)</span><span class="token punctuation">:</span> S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">-</span><span class="token number">16384</span> <span class="token punctuation">(</span>System Mandatory Level<span class="token punctuation">)</span>
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="cmdscan" tabindex="-1"><a class="header-anchor" href="#cmdscan" aria-hidden="true">#</a> cmdscan</h3><p><code>cmdscan</code> 插件在 XP/2003/Vista/2008 上的 csrss.exe 和 Windows 7 上的 conhost.exe 的内存中搜索攻击者通过控制台 shell (cmd.exe) 输入的命令。你可以使用它来了解攻击者在受害系统上的操作，无论他们是通过 RDP 会话打开 cmd.exe 还是从网络后门代理输入/输出到命令行。</p><p>此插件通过查找已知<code>常量值 (MaxHistory)</code> 然后应用完整性检查来查找称为 COMMAND_HISTORY 的结构。请务必注意，可以通过右键单击 cmd.exe 窗口的左上角并转到“属性”来更改 MaxHistory 值。还可以通过修改注册表项 <code>HKCU\Console\HistoryBufferSize</code> 来更改给定用户打开的所有控制台的值。在 Windows 系统上<code>默认值为 50</code>，这意味着最近的 50 个命令被保存。如果需要，你可以使用 <code>--max_history=NUMBER</code> 参数对其进行调整。</p><p>除了输入到 shell 中的命令外，此插件还显示：</p><ul><li>控制台主机进程的名称（csrss.exe 或 conhost.exe）</li><li>使用控制台的应用程序名称（使用 cmd.exe 的任何进程）</li><li>命令历史缓冲区的位置，包括当前缓冲区计数、最后添加的命令和最后显示的命令</li><li>应用进程句柄</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f VistaSP2x64<span class="token punctuation">.</span>vmem <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>VistaSP2x64 cmdscan
Volatility Foundation Volatility Framework <span class="token number">2.4</span>

<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
CommandProcess<span class="token punctuation">:</span> csrss<span class="token punctuation">.</span>exe Pid<span class="token punctuation">:</span> <span class="token number">528</span>
CommandHistory<span class="token punctuation">:</span> <span class="token number">0x135ec00</span> Application<span class="token punctuation">:</span> cmd<span class="token punctuation">.</span>exe Flags<span class="token punctuation">:</span> Allocated<span class="token punctuation">,</span> Reset
CommandCount<span class="token punctuation">:</span> <span class="token number">18</span> LastAdded<span class="token punctuation">:</span> <span class="token number">17</span> LastDisplayed<span class="token punctuation">:</span> <span class="token number">17</span>
FirstCommand<span class="token punctuation">:</span> <span class="token number">0</span> CommandCountMax<span class="token punctuation">:</span> <span class="token number">50</span>
ProcessHandle<span class="token punctuation">:</span> <span class="token number">0x330</span>
Cmd <span class="token comment">#0 @ 0x135ef10: cd \</span>
Cmd <span class="token comment">#1 @ 0x135ef50: cd de</span>
Cmd <span class="token comment">#2 @ 0x135ef70: cd PerfLogs</span>
Cmd <span class="token comment">#3 @ 0x135ef90: cd ..</span>
Cmd <span class="token comment">#4 @ 0x5c78b90: cd &quot;Program Files&quot;</span>
Cmd <span class="token comment">#5 @ 0x135fae0: cd &quot;Debugging Tools for Windows (x64)&quot;</span>
Cmd <span class="token comment">#6 @ 0x135efb0: livekd -w</span>
Cmd <span class="token comment">#7 @ 0x135f010: windbg </span>
Cmd <span class="token comment">#8 @ 0x135efd0: cd \</span>
Cmd <span class="token comment">#9 @ 0x135fd20: rundll32 c:\apphelp.dll,ExportFunc</span>
Cmd <span class="token comment">#10 @ 0x5c8bdb0: rundll32 c:\windows_apphelp.dll,ExportFunc</span>
Cmd <span class="token comment">#11 @ 0x5c8be10: rundll32 c:\windows_apphelp.dll</span>
Cmd <span class="token comment">#12 @ 0x135ee30: rundll32 c:\windows_apphelp.dll,Test</span>
Cmd <span class="token comment">#13 @ 0x135fd70: cd &quot;Program Files&quot;</span>
Cmd <span class="token comment">#14 @ 0x5c8b9e0: dir</span>
Cmd <span class="token comment">#15 @ 0x5c8be60: cd &quot;Debugging Tools for Windows (x64)&quot;</span>
Cmd <span class="token comment">#16 @ 0x5c8ba00: dir</span>
Cmd <span class="token comment">#17 @ 0x135eff0: livekd -w</span>

<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="consoles" tabindex="-1"><a class="header-anchor" href="#consoles" aria-hidden="true">#</a> consoles</h3><p>与<a href="#cmdscan">cmdscan</a>类似，控制台插件会查找攻击者键入 cmd.exe 或通过后门执行的命令。但是，此插件不是扫描 COMMAND_HISTORY，而是扫描 CONSOLE_INFORMATION。这个插件的主要优点是它不仅打印攻击者输入的命令，而且收集整个屏幕缓冲区（输入<strong>和</strong>输出）。例如，您不仅会看到“dir”，还会看到攻击者看到的确切内容，包括“dir”命令列出的所有文件和目录。</p><p>此外，此插件还会输出以下内容：</p><ul><li>原始控制台窗口标题和当前控制台窗口标题</li><li>附加进程的名称和 pid（遍历 LIST_ENTRY 以枚举所有进程，如果多个）</li><li>与执行的命令关联的任何别名。例如，攻击者可以注册一个别名，这样键入“hello”实际上会执行“cd system”</li><li>cmd.exe控制台的屏幕坐标</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f xp<span class="token operator">-</span>laptop<span class="token operator">-</span><span class="token number">2005</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">1430</span><span class="token punctuation">.</span>img consoles
Volatility Foundation Volatility Framework <span class="token number">2.4</span>

<span class="token punctuation">[</span>csrss<span class="token punctuation">.</span>exe @ <span class="token number">0x821c11a8</span> pid <span class="token number">456</span> console @ <span class="token number">0x4e23b0</span><span class="token punctuation">]</span>
  OriginalTitle<span class="token punctuation">:</span> <span class="token string">&#39;%SystemRoot%\\system32\\cmd.exe&#39;</span>
  Title<span class="token punctuation">:</span> <span class="token string">&#39;C:\\WINDOWS\\system32\\cmd.exe - dd if=\\\\.\\PhysicalMemory of=c:\\xp-2005-07-04-1430.img conv=noerror&#39;</span>
  HistoryBufferCount<span class="token punctuation">:</span> <span class="token number">2</span>
  HistoryBufferMax<span class="token punctuation">:</span> <span class="token number">4</span>
  CommandHistorySize<span class="token punctuation">:</span> <span class="token number">50</span>
<span class="token punctuation">[</span>history @ <span class="token number">0x4e4008</span><span class="token punctuation">]</span>
  CommandCount<span class="token punctuation">:</span> <span class="token number">0</span>
  CommandCountMax<span class="token punctuation">:</span> <span class="token number">50</span>
  Application<span class="token punctuation">:</span> <span class="token string">&#39;dd.exe&#39;</span>
<span class="token punctuation">[</span>history @ <span class="token number">0x4e4d88</span><span class="token punctuation">]</span>
  CommandCount<span class="token punctuation">:</span> <span class="token number">20</span>
  CommandCountMax<span class="token punctuation">:</span> <span class="token number">50</span>
  Application<span class="token punctuation">:</span> <span class="token string">&#39;cmd.exe&#39;</span>
  Cmd <span class="token comment">#0 @ 0x4e1f90: &#39;dd&#39;</span>
  Cmd <span class="token comment">#1 @ 0x4e2cb8: &#39;cd\\&#39;</span>
  Cmd <span class="token comment">#2 @ 0x4e2d18: &#39;dr&#39;</span>
  Cmd <span class="token comment">#3 @ 0x4e2d28: &#39;ee:&#39;</span>
  Cmd <span class="token comment">#4 @ 0x4e2d38: &#39;e;&#39;</span>
  Cmd <span class="token comment">#5 @ 0x4e2d48: &#39;e:&#39;</span>
  Cmd <span class="token comment">#6 @ 0x4e2d58: &#39;dr&#39;</span>
  Cmd <span class="token comment">#7 @ 0x4e2d68: &#39;d;&#39;</span>
  Cmd <span class="token comment">#8 @ 0x4e2d78: &#39;d:&#39;</span>
  Cmd <span class="token comment">#9 @ 0x4e2d88: &#39;dr&#39;</span>
  Cmd <span class="token comment">#10 @ 0x4e2d98: &#39;ls&#39;</span>
  Cmd <span class="token comment">#11 @ 0x4e2da8: &#39;cd Docu&#39;</span>
  Cmd <span class="token comment">#12 @ 0x4e2dc0: &#39;cd Documents and&#39;</span>
  Cmd <span class="token comment">#13 @ 0x4e2e58: &#39;dr&#39;</span>
  Cmd <span class="token comment">#14 @ 0x4e2e68: &#39;d:&#39;</span>
  Cmd <span class="token comment">#15 @ 0x4e2e78: &#39;cd dd\\&#39;</span>
  Cmd <span class="token comment">#16 @ 0x4e2e90: &#39;cd UnicodeRelease&#39;</span>
  Cmd <span class="token comment">#17 @ 0x4e2ec0: &#39;dr&#39;</span>
  Cmd <span class="token comment">#18 @ 0x4e2ed0: &#39;dd &#39;</span>
  Cmd <span class="token comment">#19 @ 0x4e4100: &#39;dd if=\\\\.\\PhysicalMemory of=c:\\xp-2005-07-04-1430.img conv=noerror&#39;</span>
<span class="token punctuation">[</span>screen @ <span class="token number">0x4e2460</span> X<span class="token punctuation">:</span><span class="token number">80</span> Y<span class="token punctuation">:</span><span class="token number">300</span><span class="token punctuation">]</span>
  Output<span class="token punctuation">:</span> Microsoft Windows XP <span class="token punctuation">[</span>Version <span class="token number">5.1</span><span class="token number">.2600</span><span class="token punctuation">]</span>                                         
  Output<span class="token punctuation">:</span> <span class="token punctuation">(</span>C<span class="token punctuation">)</span> Copyright <span class="token number">1985</span><span class="token operator">-</span><span class="token number">2001</span> Microsoft Corp<span class="token punctuation">.</span>                                         
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> C<span class="token punctuation">:</span>\Documents <span class="token keyword">and</span> Settings\Sarah<span class="token operator">&gt;</span>dd                                              
  Output<span class="token punctuation">:</span> <span class="token string">&#39;dd&#39;</span> <span class="token keyword">is</span> <span class="token keyword">not</span> recognized <span class="token keyword">as</span> an internal <span class="token keyword">or</span> external command<span class="token punctuation">,</span>                      
  Output<span class="token punctuation">:</span> operable program <span class="token keyword">or</span> batch <span class="token builtin">file</span><span class="token punctuation">.</span>                                                 
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> C<span class="token punctuation">:</span>\Documents <span class="token keyword">and</span> Settings\Sarah<span class="token operator">&gt;</span>cd\                                             
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> C<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>dr                                                                          
  Output<span class="token punctuation">:</span> <span class="token string">&#39;dr&#39;</span> <span class="token keyword">is</span> <span class="token keyword">not</span> recognized <span class="token keyword">as</span> an internal <span class="token keyword">or</span> external command<span class="token punctuation">,</span>                      
  Output<span class="token punctuation">:</span> operable program <span class="token keyword">or</span> batch <span class="token builtin">file</span><span class="token punctuation">.</span>                                                 
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> C<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>ee<span class="token punctuation">:</span>                                                                         
  Output<span class="token punctuation">:</span> <span class="token string">&#39;ee:&#39;</span> <span class="token keyword">is</span> <span class="token keyword">not</span> recognized <span class="token keyword">as</span> an internal <span class="token keyword">or</span> external command<span class="token punctuation">,</span>                     
  Output<span class="token punctuation">:</span> operable program <span class="token keyword">or</span> batch <span class="token builtin">file</span><span class="token punctuation">.</span>                                                 
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> C<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>e<span class="token punctuation">;</span>                                                                          
  Output<span class="token punctuation">:</span> <span class="token string">&#39;e&#39;</span> <span class="token keyword">is</span> <span class="token keyword">not</span> recognized <span class="token keyword">as</span> an internal <span class="token keyword">or</span> external command<span class="token punctuation">,</span>                       
  Output<span class="token punctuation">:</span> operable program <span class="token keyword">or</span> batch <span class="token builtin">file</span><span class="token punctuation">.</span>                                                 
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> C<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>e<span class="token punctuation">:</span>                                                                          
  Output<span class="token punctuation">:</span> The system cannot find the drive specified<span class="token punctuation">.</span>                                     
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> C<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>dr                                                                          
  Output<span class="token punctuation">:</span> <span class="token string">&#39;dr&#39;</span> <span class="token keyword">is</span> <span class="token keyword">not</span> recognized <span class="token keyword">as</span> an internal <span class="token keyword">or</span> external command<span class="token punctuation">,</span>                      
  Output<span class="token punctuation">:</span> operable program <span class="token keyword">or</span> batch <span class="token builtin">file</span><span class="token punctuation">.</span>                                                 
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> C<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>d<span class="token punctuation">;</span>                                                                          
  Output<span class="token punctuation">:</span> <span class="token string">&#39;d&#39;</span> <span class="token keyword">is</span> <span class="token keyword">not</span> recognized <span class="token keyword">as</span> an internal <span class="token keyword">or</span> external command<span class="token punctuation">,</span>                       
  Output<span class="token punctuation">:</span> operable program <span class="token keyword">or</span> batch <span class="token builtin">file</span><span class="token punctuation">.</span>                                                 
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> C<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>d<span class="token punctuation">:</span>                                                                          
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> D<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>dr                                                                          
  Output<span class="token punctuation">:</span> <span class="token string">&#39;dr&#39;</span> <span class="token keyword">is</span> <span class="token keyword">not</span> recognized <span class="token keyword">as</span> an internal <span class="token keyword">or</span> external command<span class="token punctuation">,</span>                      
  Output<span class="token punctuation">:</span> operable program <span class="token keyword">or</span> batch <span class="token builtin">file</span><span class="token punctuation">.</span>                                                 
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> D<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>dr                                                                          
  Output<span class="token punctuation">:</span> <span class="token string">&#39;dr&#39;</span> <span class="token keyword">is</span> <span class="token keyword">not</span> recognized <span class="token keyword">as</span> an internal <span class="token keyword">or</span> external command<span class="token punctuation">,</span>                      
  Output<span class="token punctuation">:</span> operable program <span class="token keyword">or</span> batch <span class="token builtin">file</span><span class="token punctuation">.</span>                                                 
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> D<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>ls                                                                          
  Output<span class="token punctuation">:</span> <span class="token string">&#39;ls&#39;</span> <span class="token keyword">is</span> <span class="token keyword">not</span> recognized <span class="token keyword">as</span> an internal <span class="token keyword">or</span> external command<span class="token punctuation">,</span>                      
  Output<span class="token punctuation">:</span> operable program <span class="token keyword">or</span> batch <span class="token builtin">file</span><span class="token punctuation">.</span>                                                 
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> D<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>cd Docu                                                                     
  Output<span class="token punctuation">:</span> The system cannot find the path specified<span class="token punctuation">.</span>                                      
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> D<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>cd Documents <span class="token keyword">and</span>                                                            
  Output<span class="token punctuation">:</span> The system cannot find the path specified<span class="token punctuation">.</span>                                      
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> D<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>dr                                                                          
  Output<span class="token punctuation">:</span> <span class="token string">&#39;dr&#39;</span> <span class="token keyword">is</span> <span class="token keyword">not</span> recognized <span class="token keyword">as</span> an internal <span class="token keyword">or</span> external command<span class="token punctuation">,</span>                      
  Output<span class="token punctuation">:</span> operable program <span class="token keyword">or</span> batch <span class="token builtin">file</span><span class="token punctuation">.</span>                                                 
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> D<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>d<span class="token punctuation">:</span>                                                                          
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> D<span class="token punctuation">:</span>\<span class="token operator">&gt;</span>cd dd\                                                                      
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> D<span class="token punctuation">:</span>\dd<span class="token operator">&gt;</span>                                                                          
  Output<span class="token punctuation">:</span> D<span class="token punctuation">:</span>\dd<span class="token operator">&gt;</span>cd UnicodeRelease                                                         
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> D<span class="token punctuation">:</span>\dd\UnicodeRelease<span class="token operator">&gt;</span>dr                                                         
  Output<span class="token punctuation">:</span> <span class="token string">&#39;dr&#39;</span> <span class="token keyword">is</span> <span class="token keyword">not</span> recognized <span class="token keyword">as</span> an internal <span class="token keyword">or</span> external command<span class="token punctuation">,</span>                      
  Output<span class="token punctuation">:</span> operable program <span class="token keyword">or</span> batch <span class="token builtin">file</span><span class="token punctuation">.</span>                                                 
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> D<span class="token punctuation">:</span>\dd\UnicodeRelease<span class="token operator">&gt;</span>dd                                                         
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> <span class="token number">0</span><span class="token operator">+</span><span class="token number">0</span> records <span class="token keyword">in</span>                                                                  
  Output<span class="token punctuation">:</span> <span class="token number">0</span><span class="token operator">+</span><span class="token number">0</span> records out                                                                 
  Output<span class="token punctuation">:</span> <span class="token operator">^</span>C                                                                              
  Output<span class="token punctuation">:</span> D<span class="token punctuation">:</span>\dd\UnicodeRelease<span class="token operator">&gt;</span>dd <span class="token keyword">if</span><span class="token operator">=</span>\\<span class="token punctuation">.</span>\PhysicalMemory of<span class="token operator">=</span>c<span class="token punctuation">:</span>\xp<span class="token operator">-</span><span class="token number">2005</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">1430</span><span class="token punctuation">.</span>img conv<span class="token operator">=</span>
  Output<span class="token punctuation">:</span> noerror                                                                         
  Output<span class="token punctuation">:</span> Forensic Acquisition Utilities<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1035</span>                                   
  Output<span class="token punctuation">:</span> dd<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1035</span>                                                              
  Output<span class="token punctuation">:</span> Copyright <span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2002</span><span class="token operator">-</span><span class="token number">2004</span> George M<span class="token punctuation">.</span> Garner Jr<span class="token punctuation">.</span>                                    
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> Command Line<span class="token punctuation">:</span> dd <span class="token keyword">if</span><span class="token operator">=</span>\\<span class="token punctuation">.</span>\PhysicalMemory of<span class="token operator">=</span>c<span class="token punctuation">:</span>\xp<span class="token operator">-</span><span class="token number">2005</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">1430</span><span class="token punctuation">.</span>img conv<span class="token operator">=</span>noerror
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> Based on original version developed by Paul Rubin<span class="token punctuation">,</span> David MacKenzie<span class="token punctuation">,</span> <span class="token keyword">and</span> Stuart K
  Output<span class="token punctuation">:</span> emp                                                                             
  Output<span class="token punctuation">:</span> Microsoft Windows<span class="token punctuation">:</span> Version <span class="token number">5.1</span> <span class="token punctuation">(</span>Build <span class="token number">2600</span><span class="token punctuation">.</span>Professional Service Pack <span class="token number">2</span><span class="token punctuation">)</span>         
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> <span class="token number">04</span><span class="token operator">/</span><span class="token number">07</span><span class="token operator">/</span><span class="token number">2005</span>  <span class="token number">18</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">:</span><span class="token number">32</span> <span class="token punctuation">(</span>UTC<span class="token punctuation">)</span>                                                      
  Output<span class="token punctuation">:</span> <span class="token number">04</span><span class="token operator">/</span><span class="token number">07</span><span class="token operator">/</span><span class="token number">2005</span>  <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">30</span><span class="token punctuation">:</span><span class="token number">32</span> <span class="token punctuation">(</span>local time<span class="token punctuation">)</span>                                               
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> Current User<span class="token punctuation">:</span> SPLATITUDE\Sarah                                                  
  Output<span class="token punctuation">:</span>                                                                                 
  Output<span class="token punctuation">:</span> Total physical memory reported<span class="token punctuation">:</span> <span class="token number">523676</span> KB                                       
  Output<span class="token punctuation">:</span> Copying physical memory<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                                                      
  Output<span class="token punctuation">:</span> Physical memory <span class="token keyword">in</span> the <span class="token builtin">range</span> <span class="token number">0x00004000</span><span class="token operator">-</span><span class="token number">0x00004000</span> could <span class="token keyword">not</span> be read<span class="token punctuation">.</span>                           
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="privs" tabindex="-1"><a class="header-anchor" href="#privs" aria-hidden="true">#</a> privs</h3><p>该插件向你显示默认情况下存在、启用和/或启用的进程权限。您可以将 <code>--silent</code> 标志传递给它以仅显示进程明确启用的权限（即默认情况下未启用但当前启用的权限）。<code>--regex=REGEX</code> 参数可用于过滤特定权限名称。</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>$ python vol.py -f win7_trial_64bit.raw privs --profile=Win7SP0x64
Volatility Foundation Volatility Framework 2.3_alpha
Pid      Process          Value  Privilege                            Attributes               Description
-------- ---------------- ------ ------------------------------------ ------------------------ -----------
       4 System                2 SeCreateTokenPrivilege               Present                  Create a token object
       4 System                3 SeAssignPrimaryTokenPrivilege        Present                  Replace a process-level token
       4 System                4 SeLockMemoryPrivilege                Present,Enabled,Default  Lock pages in memory
       4 System                5 SeIncreaseQuotaPrivilege             Present                  Increase quotas
       4 System                6 SeMachineAccountPrivilege                                     Add workstations to the domain
       4 System                7 SeTcbPrivilege                       Present,Enabled,Default  Act as part of the operating system
       4 System                8 SeSecurityPrivilege                  Present                  Manage auditing and security log
       4 System                9 SeTakeOwnershipPrivilege             Present                  Take ownership of files/objects
       4 System               10 SeLoadDriverPrivilege                Present                  Load and unload device drivers
       4 System               11 SeSystemProfilePrivilege             Present,Enabled,Default  Profile system performance
       4 System               12 SeSystemtimePrivilege                Present                  Change the system time
       4 System               13 SeProfileSingleProcessPrivilege      Present,Enabled,Default  Profile a single process
       4 System               14 SeIncreaseBasePriorityPrivilege      Present,Enabled,Default  Increase scheduling priority
       4 System               15 SeCreatePagefilePrivilege            Present,Enabled,Default  Create a pagefile
       4 System               16 SeCreatePermanentPrivilege           Present,Enabled,Default  Create permanent shared objects
.....
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="envars" tabindex="-1"><a class="header-anchor" href="#envars" aria-hidden="true">#</a> envars</h3><p>要显示进程的环境变量，请使用 <code>envars</code> 插件。通常它会显示安装的 CPU 数量和硬件架构（尽管<a href="#kdbgscan">kdbgscan</a>输出是一个更可靠的来源）、进程的当前目录、临时目录、会话名称、计算机名称、用户名和各种其他的内容。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 envars
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Pid      Process              Block              Variable                       Value
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> ComSpec                        C<span class="token punctuation">:</span>\Windows\system32\cmd<span class="token punctuation">.</span>exe
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> FP_NO_HOST_CHECK               NO
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> NUMBER_OF_PROCESSORS           <span class="token number">1</span>
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> OS                             Windows_NT
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> Path                           C<span class="token punctuation">:</span>\Windows\system32<span class="token punctuation">;</span>C<span class="token punctuation">:</span>\Windows<span class="token punctuation">;</span>C<span class="token punctuation">:</span>\Windows\System32\Wbem<span class="token punctuation">;</span>C<span class="token punctuation">:</span>\Windows\System32\WindowsPowerShell\v1<span class="token punctuation">.</span><span class="token number">0</span>\
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> PATHEXT                        <span class="token punctuation">.</span>COM<span class="token punctuation">;</span><span class="token punctuation">.</span>EXE<span class="token punctuation">;</span><span class="token punctuation">.</span>BAT<span class="token punctuation">;</span><span class="token punctuation">.</span>CMD<span class="token punctuation">;</span><span class="token punctuation">.</span>VBS<span class="token punctuation">;</span><span class="token punctuation">.</span>VBE<span class="token punctuation">;</span><span class="token punctuation">.</span>JS<span class="token punctuation">;</span><span class="token punctuation">.</span>JSE<span class="token punctuation">;</span><span class="token punctuation">.</span>WSF<span class="token punctuation">;</span><span class="token punctuation">.</span>WSH<span class="token punctuation">;</span><span class="token punctuation">.</span>MSC
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> PROCESSOR_ARCHITECTURE         AMD64
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> PROCESSOR_IDENTIFIER           Intel64 Family <span class="token number">6</span> Model <span class="token number">2</span> Stepping <span class="token number">3</span><span class="token punctuation">,</span> GenuineIntel
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> PROCESSOR_LEVEL                <span class="token number">6</span>
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> PROCESSOR_REVISION             <span class="token number">0203</span>
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> PSModulePath                   C<span class="token punctuation">:</span>\Windows\system32\WindowsPowerShell\v1<span class="token punctuation">.</span><span class="token number">0</span>\Modules\
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> SystemDrive                    C<span class="token punctuation">:</span>
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> SystemRoot                     C<span class="token punctuation">:</span>\Windows
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> TEMP                           C<span class="token punctuation">:</span>\Windows\TEMP
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> TMP                            C<span class="token punctuation">:</span>\Windows\TEMP
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> USERNAME                       SYSTEM
     <span class="token number">296</span> csrss<span class="token punctuation">.</span>exe            <span class="token number">0x00000000003d1320</span> windir                         C<span class="token punctuation">:</span>\Windows
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="verinfo" tabindex="-1"><a class="header-anchor" href="#verinfo" aria-hidden="true">#</a> verinfo</h3><p>如果要显示嵌入在 PE 文件中的版本信息，请使用 <code>verinfo</code> 命令。并非所有 PE 文件都有版本信息，许多恶意软件作者伪造它以包含虚假数据，但尽管如此，此命令对于识别二进制文件和与其他文件建立关联非常有帮助。</p><p>该插件仅支持从进程可执行文件和 DLL 打印版本信息，但稍后将扩展到包括内核模块。如果要按模块名称过滤，请使用 <code>--regex=REGEX</code> 以及 <code>--ignore-case</code> 选项。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 verinfo
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
\SystemRoot\System32\smss<span class="token punctuation">.</span>exe
C<span class="token punctuation">:</span>\Windows\SYSTEM32\ntdll<span class="token punctuation">.</span>dll

C<span class="token punctuation">:</span>\Windows\system32\csrss<span class="token punctuation">.</span>exe
  File version    <span class="token punctuation">:</span> <span class="token number">6.1</span><span class="token number">.7600</span><span class="token number">.16385</span>
  Product version <span class="token punctuation">:</span> <span class="token number">6.1</span><span class="token number">.7600</span><span class="token number">.16385</span>
  Flags           <span class="token punctuation">:</span> 
  OS              <span class="token punctuation">:</span> Windows NT
  File Type       <span class="token punctuation">:</span> Application
  File Date       <span class="token punctuation">:</span> 
  CompanyName <span class="token punctuation">:</span> Microsoft Corporation
  FileDescription <span class="token punctuation">:</span> Client Server Runtime Process
  FileVersion <span class="token punctuation">:</span> <span class="token number">6.1</span><span class="token number">.7600</span><span class="token number">.16385</span> <span class="token punctuation">(</span>win7_rtm<span class="token punctuation">.</span><span class="token number">090713</span><span class="token operator">-</span><span class="token number">1255</span><span class="token punctuation">)</span>
  InternalName <span class="token punctuation">:</span> CSRSS<span class="token punctuation">.</span>Exe
  LegalCopyright <span class="token punctuation">:</span> \xa9 Microsoft Corporation<span class="token punctuation">.</span> All rights reserved<span class="token punctuation">.</span>
  OriginalFilename <span class="token punctuation">:</span> CSRSS<span class="token punctuation">.</span>Exe
  ProductName <span class="token punctuation">:</span> Microsoft\xae Windows\xae Operating System
  ProductVersion <span class="token punctuation">:</span> <span class="token number">6.1</span><span class="token number">.7600</span><span class="token number">.16385</span>

<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="enumfunc" tabindex="-1"><a class="header-anchor" href="#enumfunc" aria-hidden="true">#</a> enumfunc</h3><p>此插件枚举从进程、dll 和内核驱动程序导入和导出的函数。具体来说，它处理按名称或序号导入的函数、按名称或序号导出的函数以及转发导出。大多数情况下输出会非常冗长（ntdll、msvcrt 和 kernel32 导出的函数单独就可以达到 1000+）。因此，您可以通过使用命令行选项（如下所示）过滤条件来减少冗长，或者您可以查看 <a href="http://enumfunc.py" target="_blank" rel="noopener noreferrer">enumfunc.py<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 中的代码并将其用作如何使用 IAT 和 EAT 解析 API 函数的示例你自己的插件。例如，<a href="#apihooks">apihooks</a>插件在检查挂钩时利用导入和导出 API 在内存中查找函数。</p><p>另请注意，此插件位于 contrib 目录中，因此您可以像这样将其传递给 --plugins：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>plugins<span class="token operator">=</span>contrib<span class="token operator">/</span>plugins<span class="token operator">/</span> <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 enumfunc <span class="token operator">-</span>h
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  <span class="token operator">-</span>s<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token operator">-</span>scan            Scan <span class="token keyword">for</span> objects
  <span class="token operator">-</span>P<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token operator">-</span>process<span class="token operator">-</span>only    Process only
  <span class="token operator">-</span>K<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token operator">-</span>kernel<span class="token operator">-</span>only     Kernel only
  <span class="token operator">-</span>I<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token keyword">import</span><span class="token operator">-</span>only     Imports only
  <span class="token operator">-</span>E<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token operator">-</span>export<span class="token operator">-</span>only     Exports only
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>要使用池扫描器来查找进程和内核驱动程序而不是遍历链表，尝试枚举隐藏进程或驱动程序中的函数，请使用 -s 选项。</p><p>要在进程内存中显示导出的函数，请像这样使用 -P 和 -E：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>plugins<span class="token operator">=</span>contrib<span class="token operator">/</span>plugins<span class="token operator">/</span> <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 enumfunc <span class="token operator">-</span>P <span class="token operator">-</span>E
Process              Type       Module               Ordinal    Address              Name
lsass<span class="token punctuation">.</span>exe            Export     ADVAPI32<span class="token punctuation">.</span>dll         <span class="token number">1133</span>       <span class="token number">0x000007fefd11dd34</span> CreateWellKnownSid
lsass<span class="token punctuation">.</span>exe            Export     ADVAPI32<span class="token punctuation">.</span>dll         <span class="token number">1134</span>       <span class="token number">0x000007fefd17a460</span> CredBackupCredentials
lsass<span class="token punctuation">.</span>exe            Export     ADVAPI32<span class="token punctuation">.</span>dll         <span class="token number">1135</span>       <span class="token number">0x000007fefd170590</span> CredDeleteA
lsass<span class="token punctuation">.</span>exe            Export     ADVAPI32<span class="token punctuation">.</span>dll         <span class="token number">1136</span>       <span class="token number">0x000007fefd1704d0</span> CredDeleteW
lsass<span class="token punctuation">.</span>exe            Export     ADVAPI32<span class="token punctuation">.</span>dll         <span class="token number">1137</span>       <span class="token number">0x000007fefd17a310</span> CredEncryptAndMarshalBinaryBlob
lsass<span class="token punctuation">.</span>exe            Export     ADVAPI32<span class="token punctuation">.</span>dll         <span class="token number">1138</span>       <span class="token number">0x000007fefd17d080</span> CredEnumerateA
lsass<span class="token punctuation">.</span>exe            Export     ADVAPI32<span class="token punctuation">.</span>dll         <span class="token number">1139</span>       <span class="token number">0x000007fefd17cf50</span> CredEnumerateW
lsass<span class="token punctuation">.</span>exe            Export     ADVAPI32<span class="token punctuation">.</span>dll         <span class="token number">1140</span>       <span class="token number">0x000007fefd17ca00</span> CredFindBestCredentialA
lsass<span class="token punctuation">.</span>exe            Export     ADVAPI32<span class="token punctuation">.</span>dll         <span class="token number">1141</span>       <span class="token number">0x000007fefd17c8f0</span> CredFindBestCredentialW
lsass<span class="token punctuation">.</span>exe            Export     ADVAPI32<span class="token punctuation">.</span>dll         <span class="token number">1142</span>       <span class="token number">0x000007fefd130c10</span> CredFree
lsass<span class="token punctuation">.</span>exe            Export     ADVAPI32<span class="token punctuation">.</span>dll         <span class="token number">1143</span>       <span class="token number">0x000007fefd1630f0</span> CredGetSessionTypes
lsass<span class="token punctuation">.</span>exe            Export     ADVAPI32<span class="token punctuation">.</span>dll         <span class="token number">1144</span>       <span class="token number">0x000007fefd1703d0</span> CredGetTargetInfoA
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>要在内核内存中显示导入的函数，请使用 -K 和 -I，如下所示：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span><span class="token operator">-</span>plugins<span class="token operator">=</span>contrib<span class="token operator">/</span>plugins<span class="token operator">/</span> <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 enumfunc <span class="token operator">-</span>K <span class="token operator">-</span>I
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Process              Type       Module               Ordinal    Address              Name
<span class="token operator">&lt;</span>KERNEL<span class="token operator">&gt;</span>             Import     VIDEOPRT<span class="token punctuation">.</span>SYS         <span class="token number">583</span>        <span class="token number">0xfffff80002acc320</span> ntoskrnl<span class="token punctuation">.</span>exeIoRegisterPlugPlayNotification
<span class="token operator">&lt;</span>KERNEL<span class="token operator">&gt;</span>             Import     VIDEOPRT<span class="token punctuation">.</span>SYS         <span class="token number">1325</span>       <span class="token number">0xfffff800029f9f30</span> ntoskrnl<span class="token punctuation">.</span>exeRtlAppendStringToString
<span class="token operator">&lt;</span>KERNEL<span class="token operator">&gt;</span>             Import     VIDEOPRT<span class="token punctuation">.</span>SYS         <span class="token number">509</span>        <span class="token number">0xfffff800026d06e0</span> ntoskrnl<span class="token punctuation">.</span>exeIoGetAttachedDevice
<span class="token operator">&lt;</span>KERNEL<span class="token operator">&gt;</span>             Import     VIDEOPRT<span class="token punctuation">.</span>SYS         <span class="token number">443</span>        <span class="token number">0xfffff800028f7ec0</span> ntoskrnl<span class="token punctuation">.</span>exeIoBuildSynchronousFsdRequest
<span class="token operator">&lt;</span>KERNEL<span class="token operator">&gt;</span>             Import     VIDEOPRT<span class="token punctuation">.</span>SYS         <span class="token number">1466</span>       <span class="token number">0xfffff80002699300</span> ntoskrnl<span class="token punctuation">.</span>exeRtlInitUnicodeString
<span class="token operator">&lt;</span>KERNEL<span class="token operator">&gt;</span>             Import     VIDEOPRT<span class="token punctuation">.</span>SYS         <span class="token number">759</span>        <span class="token number">0xfffff80002697be0</span> ntoskrnl<span class="token punctuation">.</span>exeKeInitializeEvent
<span class="token operator">&lt;</span>KERNEL<span class="token operator">&gt;</span>             Import     VIDEOPRT<span class="token punctuation">.</span>SYS         <span class="token number">1461</span>       <span class="token number">0xfffff8000265e8a0</span> ntoskrnl<span class="token punctuation">.</span>exeRtlInitAnsiString
<span class="token operator">&lt;</span>KERNEL<span class="token operator">&gt;</span>             Import     VIDEOPRT<span class="token punctuation">.</span>SYS         <span class="token number">1966</span>       <span class="token number">0xfffff80002685060</span> ntoskrnl<span class="token punctuation">.</span>exeZwSetValueKey
<span class="token operator">&lt;</span>KERNEL<span class="token operator">&gt;</span>             Import     VIDEOPRT<span class="token punctuation">.</span>SYS         <span class="token number">840</span>        <span class="token number">0xfffff80002699440</span> ntoskrnl<span class="token punctuation">.</span>exeKeReleaseSpinLock
<span class="token operator">&lt;</span>KERNEL<span class="token operator">&gt;</span>             Import     VIDEOPRT<span class="token punctuation">.</span>SYS         <span class="token number">1190</span>       <span class="token number">0xfffff800027a98b0</span> ntoskrnl<span class="token punctuation">.</span>exePoRequestPowerIrp
<span class="token operator">&lt;</span>KERNEL<span class="token operator">&gt;</span>             Import     VIDEOPRT<span class="token punctuation">.</span>SYS         <span class="token number">158</span>        <span class="token number">0xfffff800026840f0</span> ntoskrnl<span class="token punctuation">.</span>exeExInterlockedInsertTailList
<span class="token operator">&lt;</span>KERNEL<span class="token operator">&gt;</span>             Import     VIDEOPRT<span class="token punctuation">.</span>SYS         <span class="token number">1810</span>       <span class="token number">0xfffff80002684640</span> ntoskrnl<span class="token punctuation">.</span>exeZwClose
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="进程内存" tabindex="-1"><a class="header-anchor" href="#进程内存" aria-hidden="true">#</a> 进程内存</h2><h3 id="memmap" tabindex="-1"><a class="header-anchor" href="#memmap" aria-hidden="true">#</a> memmap</h3><p>给定特定进程 DTB（如果您在空闲或系统进程上使用此插件，则为内核 DTB），<code>memmap</code> 命令会准确显示哪些页面是内存驻留的。它告诉你页面的虚拟地址，页面对应的物理偏移量，以及page的大小。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 memmap <span class="token operator">-</span>p <span class="token number">4</span> 
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
System pid<span class="token punctuation">:</span>      <span class="token number">4</span>
Virtual            Physical                         Size     DumpFileOffset
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token number">0x0000000000050000</span> <span class="token number">0x0000000000cbc000</span>             <span class="token number">0x1000</span>                <span class="token number">0x0</span>
<span class="token number">0x0000000000051000</span> <span class="token number">0x0000000015ec6000</span>             <span class="token number">0x1000</span>             <span class="token number">0x1000</span>
<span class="token number">0x0000000000052000</span> <span class="token number">0x000000000f5e7000</span>             <span class="token number">0x1000</span>             <span class="token number">0x2000</span>
<span class="token number">0x0000000000053000</span> <span class="token number">0x0000000005e28000</span>             <span class="token number">0x1000</span>             <span class="token number">0x3000</span>
<span class="token number">0x0000000000054000</span> <span class="token number">0x0000000008b29000</span>             <span class="token number">0x1000</span>             <span class="token number">0x4000</span>
<span class="token number">0x0000000000055000</span> <span class="token number">0x00000000155b8000</span>             <span class="token number">0x1000</span>             <span class="token number">0x5000</span>
<span class="token number">0x0000000000056000</span> <span class="token number">0x000000000926e000</span>             <span class="token number">0x1000</span>             <span class="token number">0x6000</span>
<span class="token number">0x0000000000057000</span> <span class="token number">0x0000000002dac000</span>             <span class="token number">0x1000</span>             <span class="token number">0x7000</span>
<span class="token number">0x0000000000058000</span> <span class="token number">0x00000000162ed000</span>             <span class="token number">0x1000</span>             <span class="token number">0x8000</span>
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="memdump" tabindex="-1"><a class="header-anchor" href="#memdump" aria-hidden="true">#</a> memdump</h3><p>要将进程中的所有内存驻留页面（有关详细信息，请参阅<a href="#memmap">memmap</a>）提取到单个文件中，请使用 <code>memdump</code> 命令。使用 -D 或 --dump-dir=DIR 提供输出目录。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 memdump <span class="token operator">-</span>p <span class="token number">4</span> <span class="token operator">-</span>D dump<span class="token operator">/</span>
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
Writing System <span class="token punctuation">[</span>     <span class="token number">4</span><span class="token punctuation">]</span> to <span class="token number">4</span><span class="token punctuation">.</span>dmp

$ ls <span class="token operator">-</span>alh dump<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">.</span>dmp 
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>  <span class="token number">1</span> Michael  staff   111M Jun <span class="token number">24</span> <span class="token number">15</span><span class="token punctuation">:</span><span class="token number">47</span> dump<span class="token operator">/</span><span class="token number">4</span><span class="token punctuation">.</span>dmp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="procdump" tabindex="-1"><a class="header-anchor" href="#procdump" aria-hidden="true">#</a> procdump</h3><p>要转储进程的可执行文件，请使用 <code>procdump</code> 命令。可以通过传递<code>--unsafe</code>或<code>-u</code>标志以绕过解析 PE 标头时使用的某些健全性检查。某些恶意软件会故意伪造 PE 标头中的大小字段，从而使内存转储工具失效。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 procdump <span class="token operator">-</span>D dump<span class="token operator">/</span> <span class="token operator">-</span>p <span class="token number">296</span>
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
Dumping csrss<span class="token punctuation">.</span>exe<span class="token punctuation">,</span> pid<span class="token punctuation">:</span>    <span class="token number">296</span> output<span class="token punctuation">:</span> executable<span class="token punctuation">.</span><span class="token number">296</span><span class="token punctuation">.</span>exe

$ <span class="token builtin">file</span> dump<span class="token operator">/</span>executable<span class="token punctuation">.</span><span class="token number">296</span><span class="token punctuation">.</span>exe 
dump<span class="token operator">/</span>executable<span class="token punctuation">.</span><span class="token number">296</span><span class="token punctuation">.</span>exe<span class="token punctuation">:</span> PE32<span class="token operator">+</span> executable <span class="token keyword">for</span> MS Windows <span class="token punctuation">(</span>native<span class="token punctuation">)</span> Mono<span class="token operator">/</span><span class="token punctuation">.</span>Net assembly
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="varinfo" tabindex="-1"><a class="header-anchor" href="#varinfo" aria-hidden="true">#</a> varinfo</h3><p>vadinfo 命令显示有关进程的 VAD 节点的扩展信息。会显示：</p><ul><li>MMVAD结构在内核内存中的地址</li><li>MMVAD 结构所属的进程内存中的起始和结束虚拟地址</li><li>VAD 标签</li><li>VAD 标志、控制标志等</li><li>内存映射文件的名称（如果存在）</li><li>内存保护常量（权限）。请注意，原始保护和当前保护之间存在差异。最初的保护源自 VirtualAlloc 的 flProtect 参数。例如，您可以使用保护 PAGE_NOACCESS（原始保护）保留内存 (MEM_RESERVE)。稍后，您可以再次调用 VirtualAlloc 来提交（MEM_COMMIT）并指定 PAGE_READWRITE（成为当前保护）。vadinfo 命令仅显示原始保护。因此，仅仅因为您在此处看到 PAGE_NOACCESS，并不意味着该区域中的代码无法读取、写入或执行。</li></ul><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>    $ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 vadinfo <span class="token operator">-</span>p <span class="token number">296</span>
    Volatility Foundation Volatility Framework <span class="token number">2.4</span>
    <span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
    Pid<span class="token punctuation">:</span>    <span class="token number">296</span>
    VAD node @ <span class="token number">0xfffffa8000c00620</span> Start <span class="token number">0x000000007f0e0000</span> End <span class="token number">0x000000007ffdffff</span> Tag VadS
    Flags<span class="token punctuation">:</span> PrivateMemory<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Protection<span class="token punctuation">:</span> <span class="token number">1</span>
    Protection<span class="token punctuation">:</span> PAGE_READONLY
    Vad Type<span class="token punctuation">:</span> VadNone
    
    <span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
    
    VAD node @ <span class="token number">0xfffffa8000c04ce0</span> Start <span class="token number">0x000007fefcd00000</span> End <span class="token number">0x000007fefcd10fff</span> Tag Vad 
    Flags<span class="token punctuation">:</span> CommitCharge<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> Protection<span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span> VadType<span class="token punctuation">:</span> <span class="token number">2</span>
    Protection<span class="token punctuation">:</span> PAGE_EXECUTE_WRITECOPY
    Vad Type<span class="token punctuation">:</span> VadImageMap
    ControlArea @fffffa8000c04d70 Segment fffff8a000c45c10
    Dereference <span class="token builtin">list</span><span class="token punctuation">:</span> Flink <span class="token number">00000000</span><span class="token punctuation">,</span> Blink <span class="token number">00000000</span>
    NumberOfSectionReferences<span class="token punctuation">:</span>          <span class="token number">0</span> NumberOfPfnReferences<span class="token punctuation">:</span>          <span class="token number">13</span>
    NumberOfMappedViews<span class="token punctuation">:</span>                <span class="token number">2</span> NumberOfUserReferences<span class="token punctuation">:</span>          <span class="token number">2</span>
    WaitingForDeletion Event<span class="token punctuation">:</span>  <span class="token number">00000000</span>
    Control Flags<span class="token punctuation">:</span> Accessed<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> File<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> Image<span class="token punctuation">:</span> <span class="token number">1</span>
    FileObject @fffffa8000c074d0<span class="token punctuation">,</span> Name<span class="token punctuation">:</span> \Windows\System32\basesrv<span class="token punctuation">.</span>dll
    First prototype PTE<span class="token punctuation">:</span> fffff8a000c45c58 Last contiguous PTE<span class="token punctuation">:</span> fffffffffffffffc
    Flags2<span class="token punctuation">:</span> Inherit<span class="token punctuation">:</span> <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="vadwalk" tabindex="-1"><a class="header-anchor" href="#vadwalk" aria-hidden="true">#</a> vadwalk</h3><p>要以表格形式检查进程的 VAD 节点，请使用 <code>vadwalk</code> 命令。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 vadwalk <span class="token operator">-</span>p <span class="token number">296</span>
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
Pid<span class="token punctuation">:</span>    <span class="token number">296</span>
Address            Parent             Left               Right              Start              End                Tag 
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token number">0xfffffa8000c00620</span> <span class="token number">0x0000000000000000</span> <span class="token number">0xfffffa8000deaa40</span> <span class="token number">0xfffffa8000c043d0</span> <span class="token number">0x000000007f0e0000</span> <span class="token number">0x000000007ffdffff</span> VadS
<span class="token number">0xfffffa8000deaa40</span> <span class="token number">0xfffffa8000c00620</span> <span class="token number">0xfffffa8000bc4660</span> <span class="token number">0xfffffa80011b8d80</span> <span class="token number">0x0000000000ae0000</span> <span class="token number">0x0000000000b1ffff</span> VadS
<span class="token number">0xfffffa8000bc4660</span> <span class="token number">0xfffffa8000deaa40</span> <span class="token number">0xfffffa8000c04260</span> <span class="token number">0xfffffa8000c91010</span> <span class="token number">0x00000000004d0000</span> <span class="token number">0x0000000000650fff</span> Vadm
<span class="token number">0xfffffa8000c04260</span> <span class="token number">0xfffffa8000bc4660</span> <span class="token number">0xfffffa8000c82010</span> <span class="token number">0xfffffa80012acce0</span> <span class="token number">0x00000000002a0000</span> <span class="token number">0x000000000039ffff</span> VadS
<span class="token number">0xfffffa8000c82010</span> <span class="token number">0xfffffa8000c04260</span> <span class="token number">0xfffffa8000cbce80</span> <span class="token number">0xfffffa8000c00330</span> <span class="token number">0x00000000001f0000</span> <span class="token number">0x00000000001f0fff</span> Vadm
<span class="token number">0xfffffa8000cbce80</span> <span class="token number">0xfffffa8000c82010</span> <span class="token number">0xfffffa8000bc4790</span> <span class="token number">0xfffffa8000d9bb80</span> <span class="token number">0x0000000000180000</span> <span class="token number">0x0000000000181fff</span> Vad 
<span class="token number">0xfffffa8000bc4790</span> <span class="token number">0xfffffa8000cbce80</span> <span class="token number">0xfffffa8000c00380</span> <span class="token number">0xfffffa8000e673a0</span> <span class="token number">0x0000000000100000</span> <span class="token number">0x0000000000166fff</span> Vad 
<span class="token number">0xfffffa8000c00380</span> <span class="token number">0xfffffa8000bc4790</span> <span class="token number">0x0000000000000000</span> <span class="token number">0x0000000000000000</span> <span class="token number">0x0000000000000000</span> <span class="token number">0x00000000000fffff</span> VadS
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="vadtree" tabindex="-1"><a class="header-anchor" href="#vadtree" aria-hidden="true">#</a> vadtree</h3><p>要以可视树形式显示 VAD 节点，请使用 <code>vadtree</code> 命令。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 vadtree <span class="token operator">-</span>p <span class="token number">296</span>
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
Pid<span class="token punctuation">:</span>    <span class="token number">296</span>
 <span class="token number">0x000000007f0e0000</span> <span class="token operator">-</span> <span class="token number">0x000000007ffdffff</span>
  <span class="token number">0x0000000000ae0000</span> <span class="token operator">-</span> <span class="token number">0x0000000000b1ffff</span>
   <span class="token number">0x00000000004d0000</span> <span class="token operator">-</span> <span class="token number">0x0000000000650fff</span>
    <span class="token number">0x00000000002a0000</span> <span class="token operator">-</span> <span class="token number">0x000000000039ffff</span>
     <span class="token number">0x00000000001f0000</span> <span class="token operator">-</span> <span class="token number">0x00000000001f0fff</span>
      <span class="token number">0x0000000000180000</span> <span class="token operator">-</span> <span class="token number">0x0000000000181fff</span>
       <span class="token number">0x0000000000100000</span> <span class="token operator">-</span> <span class="token number">0x0000000000166fff</span>
        <span class="token number">0x0000000000000000</span> <span class="token operator">-</span> <span class="token number">0x00000000000fffff</span>
        <span class="token number">0x0000000000170000</span> <span class="token operator">-</span> <span class="token number">0x0000000000170fff</span>
       <span class="token number">0x00000000001a0000</span> <span class="token operator">-</span> <span class="token number">0x00000000001a1fff</span>
        <span class="token number">0x0000000000190000</span> <span class="token operator">-</span> <span class="token number">0x0000000000190fff</span>
        <span class="token number">0x00000000001b0000</span> <span class="token operator">-</span> <span class="token number">0x00000000001effff</span>
      <span class="token number">0x0000000000240000</span> <span class="token operator">-</span> <span class="token number">0x000000000024ffff</span>
       <span class="token number">0x0000000000210000</span> <span class="token operator">-</span> <span class="token number">0x0000000000216fff</span>
        <span class="token number">0x0000000000200000</span> <span class="token operator">-</span> <span class="token number">0x000000000020ffff</span>
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="vaddump" tabindex="-1"><a class="header-anchor" href="#vaddump" aria-hidden="true">#</a> vaddump</h3><p>要提取 VAD 节点描述的页面范围，请使用 <code>vaddump</code> 命令。这类似于<a href="#memdump">memdump</a>，除了属于每个 VAD 节点的页面被放置在单独的文件中（根据开始和结束地址命名）而不是一个大的整体文件。如果该范围内的任何页面不是内存驻留的，则使用地址空间的 zread() 方法将它们填充为 0。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 vaddump <span class="token operator">-</span>D vads
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Pid        Process              Start              End                Result
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
         <span class="token number">4</span> System               <span class="token number">0x0000000076d40000</span> <span class="token number">0x0000000076eeafff</span> vads<span class="token operator">/</span>System<span class="token punctuation">.</span>17fef9e0<span class="token punctuation">.</span><span class="token number">0x0000000076d40000</span><span class="token operator">-</span><span class="token number">0x0000000076eeafff</span><span class="token punctuation">.</span>dmp
         <span class="token number">4</span> System               <span class="token number">0x0000000000040000</span> <span class="token number">0x0000000000040fff</span> vads<span class="token operator">/</span>System<span class="token punctuation">.</span>17fef9e0<span class="token punctuation">.</span><span class="token number">0x0000000000040000</span><span class="token operator">-</span><span class="token number">0x0000000000040fff</span><span class="token punctuation">.</span>dmp
         <span class="token number">4</span> System               <span class="token number">0x0000000000010000</span> <span class="token number">0x0000000000032fff</span> vads<span class="token operator">/</span>System<span class="token punctuation">.</span>17fef9e0<span class="token punctuation">.</span><span class="token number">0x0000000000010000</span><span class="token operator">-</span><span class="token number">0x0000000000032fff</span><span class="token punctuation">.</span>dmp
         <span class="token number">4</span> System               <span class="token number">0x000000007ffe0000</span> <span class="token number">0x000000007ffeffff</span> vads<span class="token operator">/</span>System<span class="token punctuation">.</span>17fef9e0<span class="token punctuation">.</span><span class="token number">0x000000007ffe0000</span><span class="token operator">-</span><span class="token number">0x000000007ffeffff</span><span class="token punctuation">.</span>dmp
         <span class="token number">4</span> System               <span class="token number">0x0000000076f20000</span> <span class="token number">0x000000007709ffff</span> vads<span class="token operator">/</span>System<span class="token punctuation">.</span>17fef9e0<span class="token punctuation">.</span><span class="token number">0x0000000076f20000</span><span class="token operator">-</span><span class="token number">0x000000007709ffff</span><span class="token punctuation">.</span>dmp
       <span class="token number">208</span> smss<span class="token punctuation">.</span>exe             <span class="token number">0x000000007efe0000</span> <span class="token number">0x000000007ffdffff</span> vads<span class="token operator">/</span>smss<span class="token punctuation">.</span>exe<span class="token punctuation">.</span>176e97f0<span class="token punctuation">.</span><span class="token number">0x000000007efe0000</span><span class="token operator">-</span><span class="token number">0x000000007ffdffff</span><span class="token punctuation">.</span>dmp
       <span class="token number">208</span> smss<span class="token punctuation">.</span>exe             <span class="token number">0x00000000003d0000</span> <span class="token number">0x00000000004cffff</span> vads<span class="token operator">/</span>smss<span class="token punctuation">.</span>exe<span class="token punctuation">.</span>176e97f0<span class="token punctuation">.</span><span class="token number">0x00000000003d0000</span><span class="token operator">-</span><span class="token number">0x00000000004cffff</span><span class="token punctuation">.</span>dmp
       <span class="token number">208</span> smss<span class="token punctuation">.</span>exe             <span class="token number">0x0000000000100000</span> <span class="token number">0x0000000000100fff</span> vads<span class="token operator">/</span>smss<span class="token punctuation">.</span>exe<span class="token punctuation">.</span>176e97f0<span class="token punctuation">.</span><span class="token number">0x0000000000100000</span><span class="token operator">-</span><span class="token number">0x0000000000100fff</span><span class="token punctuation">.</span>dmp
       <span class="token number">208</span> smss<span class="token punctuation">.</span>exe             <span class="token number">0x0000000000000000</span> <span class="token number">0x00000000000fffff</span> vads<span class="token operator">/</span>smss<span class="token punctuation">.</span>exe<span class="token punctuation">.</span>176e97f0<span class="token punctuation">.</span><span class="token number">0x0000000000000000</span><span class="token operator">-</span><span class="token number">0x00000000000fffff</span><span class="token punctuation">.</span>dmp
       <span class="token number">208</span> smss<span class="token punctuation">.</span>exe             <span class="token number">0x0000000000190000</span> <span class="token number">0x000000000020ffff</span> vads<span class="token operator">/</span>smss<span class="token punctuation">.</span>exe<span class="token punctuation">.</span>176e97f0<span class="token punctuation">.</span><span class="token number">0x0000000000190000</span><span class="token operator">-</span><span class="token number">0x000000000020ffff</span><span class="token punctuation">.</span>dmp
       <span class="token number">208</span> smss<span class="token punctuation">.</span>exe             <span class="token number">0x0000000047a90000</span> <span class="token number">0x0000000047aaffff</span> vads<span class="token operator">/</span>smss<span class="token punctuation">.</span>exe<span class="token punctuation">.</span>176e97f0<span class="token punctuation">.</span><span class="token number">0x0000000047a90000</span><span class="token operator">-</span><span class="token number">0x0000000047aaffff</span><span class="token punctuation">.</span>dmp
       <span class="token number">208</span> smss<span class="token punctuation">.</span>exe             <span class="token number">0x00000000005e0000</span> <span class="token number">0x000000000065ffff</span> vads<span class="token operator">/</span>smss<span class="token punctuation">.</span>exe<span class="token punctuation">.</span>176e97f0<span class="token punctuation">.</span><span class="token number">0x00000000005e0000</span><span class="token operator">-</span><span class="token number">0x000000000065ffff</span><span class="token punctuation">.</span>dmp
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>

$ ls <span class="token operator">-</span>al vads<span class="token operator">/</span>
total <span class="token number">123720</span>
drwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x  <span class="token number">69</span> michaelligh  staff      <span class="token number">2346</span> Apr  <span class="token number">6</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">12</span> <span class="token punctuation">.</span>
drwxr<span class="token operator">-</span>xr<span class="token operator">-</span>x  <span class="token number">37</span> michaelligh  staff      <span class="token number">1258</span> Apr  <span class="token number">6</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">11</span> <span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>   <span class="token number">1</span> michaelligh  staff    <span class="token number">143360</span> Apr  <span class="token number">6</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">12</span> System<span class="token punctuation">.</span>17fef9e0<span class="token punctuation">.</span><span class="token number">0x0000000000010000</span><span class="token operator">-</span><span class="token number">0x0000000000032fff</span><span class="token punctuation">.</span>dmp
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>   <span class="token number">1</span> michaelligh  staff      <span class="token number">4096</span> Apr  <span class="token number">6</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">12</span> System<span class="token punctuation">.</span>17fef9e0<span class="token punctuation">.</span><span class="token number">0x0000000000040000</span><span class="token operator">-</span><span class="token number">0x0000000000040fff</span><span class="token punctuation">.</span>dmp
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>   <span class="token number">1</span> michaelligh  staff   <span class="token number">1748992</span> Apr  <span class="token number">6</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">12</span> System<span class="token punctuation">.</span>17fef9e0<span class="token punctuation">.</span><span class="token number">0x0000000076d40000</span><span class="token operator">-</span><span class="token number">0x0000000076eeafff</span><span class="token punctuation">.</span>dmp
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>   <span class="token number">1</span> michaelligh  staff   <span class="token number">1572864</span> Apr  <span class="token number">6</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">12</span> System<span class="token punctuation">.</span>17fef9e0<span class="token punctuation">.</span><span class="token number">0x0000000076f20000</span><span class="token operator">-</span><span class="token number">0x000000007709ffff</span><span class="token punctuation">.</span>dmp
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>   <span class="token number">1</span> michaelligh  staff     <span class="token number">65536</span> Apr  <span class="token number">6</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">12</span> System<span class="token punctuation">.</span>17fef9e0<span class="token punctuation">.</span><span class="token number">0x000000007ffe0000</span><span class="token operator">-</span><span class="token number">0x000000007ffeffff</span><span class="token punctuation">.</span>dmp
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>   <span class="token number">1</span> michaelligh  staff   <span class="token number">1048576</span> Apr  <span class="token number">6</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">12</span> csrss<span class="token punctuation">.</span>exe<span class="token punctuation">.</span>176006c0<span class="token punctuation">.</span><span class="token number">0x0000000000000000</span><span class="token operator">-</span><span class="token number">0x00000000000fffff</span><span class="token punctuation">.</span>dmp
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>   <span class="token number">1</span> michaelligh  staff    <span class="token number">421888</span> Apr  <span class="token number">6</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">12</span> csrss<span class="token punctuation">.</span>exe<span class="token punctuation">.</span>176006c0<span class="token punctuation">.</span><span class="token number">0x0000000000100000</span><span class="token operator">-</span><span class="token number">0x0000000000166fff</span><span class="token punctuation">.</span>dmp
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>   <span class="token number">1</span> michaelligh  staff      <span class="token number">4096</span> Apr  <span class="token number">6</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">12</span> csrss<span class="token punctuation">.</span>exe<span class="token punctuation">.</span>176006c0<span class="token punctuation">.</span><span class="token number">0x0000000000170000</span><span class="token operator">-</span><span class="token number">0x0000000000170fff</span><span class="token punctuation">.</span>dmp
<span class="token operator">-</span>rw<span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>r<span class="token operator">-</span><span class="token operator">-</span>   <span class="token number">1</span> michaelligh  staff      <span class="token number">8192</span> Apr  <span class="token number">6</span> <span class="token number">13</span><span class="token punctuation">:</span><span class="token number">12</span> csrss<span class="token punctuation">.</span>exe<span class="token punctuation">.</span>176006c0<span class="token punctuation">.</span><span class="token number">0x0000000000180000</span><span class="token operator">-</span><span class="token number">0x0000000000181fff</span><span class="token punctuation">.</span>dmp
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="evtlogs" tabindex="-1"><a class="header-anchor" href="#evtlogs" aria-hidden="true">#</a> evtlogs</h3><p>该<code>evtlogs</code>命令从内存中提取并解析二进制事件日志。二进制事件日志可在 Windows XP 和 2003 计算机上找到，因此该插件仅适用于这些体系结构。这些文件是从 services.exe 进程的 VAD 中提取出来的，经过解析后转储到指定位置。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f WinXPSP1x64<span class="token punctuation">.</span>vmem <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>WinXPSP2x64 evtlogs <span class="token operator">-</span>D output
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Parsed data sent to appevent<span class="token punctuation">.</span>txt
Parsed data sent to secevent<span class="token punctuation">.</span>txt
Parsed data sent to sysevent<span class="token punctuation">.</span>txt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>还有一个选项 ( <code>--save-evt</code>) 可以转储原始事件日志，以便使用外部工具进行解析：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f WinXPSP1x64<span class="token punctuation">.</span>vmem <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>WinXPSP2x64 evtlogs
<span class="token operator">-</span><span class="token operator">-</span>save<span class="token operator">-</span>evt <span class="token operator">-</span>D output
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Saved raw <span class="token punctuation">.</span>evt <span class="token builtin">file</span> to appevent<span class="token punctuation">.</span>evt
Parsed data sent to appevent<span class="token punctuation">.</span>txt
Saved raw <span class="token punctuation">.</span>evt <span class="token builtin">file</span> to secevent<span class="token punctuation">.</span>evt
Parsed data sent to secevent<span class="token punctuation">.</span>txt
Saved raw <span class="token punctuation">.</span>evt <span class="token builtin">file</span> to sysevent<span class="token punctuation">.</span>evt
Parsed data sent to sysevent<span class="token punctuation">.</span>txt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>解析后的输出是管道分隔的，以便更容易导入到 excel 文件中，并且由分号分隔：</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ cat output<span class="token operator">/</span>secevent<span class="token punctuation">.</span>txt

<span class="token number">2012</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">12</span><span class="token punctuation">:</span><span class="token number">01</span><span class="token punctuation">:</span><span class="token number">27</span><span class="token operator">|</span>secevent<span class="token punctuation">.</span>evt<span class="token operator">|</span>MACHINENAME<span class="token operator">|</span>S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">18</span> <span class="token punctuation">(</span>Local System<span class="token punctuation">)</span><span class="token operator">|</span>Security<span class="token operator">|</span><span class="token number">612</span><span class="token operator">|</span>Success<span class="token operator">|</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">+</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">+</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span>MACHINENAME$<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x3E7</span><span class="token punctuation">)</span>
<span class="token number">2012</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">17</span><span class="token punctuation">:</span><span class="token number">06</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token operator">|</span>secevent<span class="token punctuation">.</span>evt<span class="token operator">|</span>MACHINENAME<span class="token operator">|</span>S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">19</span> <span class="token punctuation">(</span>NT Authority<span class="token punctuation">)</span><span class="token operator">|</span>Security<span class="token operator">|</span><span class="token number">528</span><span class="token operator">|</span>Success<span class="token operator">|</span>LOCAL SERVICE<span class="token punctuation">;</span>NT AUTHORITY<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x3E5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">5</span><span class="token punctuation">;</span>Advapi<span class="token punctuation">;</span>Negotiate<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span>MACHINENAME$<span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x3E7</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">252</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span>
<span class="token number">2012</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">17</span><span class="token punctuation">:</span><span class="token number">06</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token operator">|</span>secevent<span class="token punctuation">.</span>evt<span class="token operator">|</span>MACHINENAME<span class="token operator">|</span>S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">19</span> <span class="token punctuation">(</span>NT Authority<span class="token punctuation">)</span><span class="token operator">|</span>Security<span class="token operator">|</span><span class="token number">576</span><span class="token operator">|</span>Success<span class="token operator">|</span>LOCAL SERVICE<span class="token punctuation">;</span>NT AUTHORITY<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x3E5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>SeAuditPrivilege            SeAssignPrimaryTokenPrivilege                   SeImpersonatePrivilege
<span class="token number">2012</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">17</span><span class="token punctuation">:</span><span class="token number">06</span><span class="token punctuation">:</span><span class="token number">19</span><span class="token operator">|</span>secevent<span class="token punctuation">.</span>evt<span class="token operator">|</span>MACHINENAME<span class="token operator">|</span>S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">20</span> <span class="token punctuation">(</span>NT Authority<span class="token punctuation">)</span><span class="token operator">|</span>Security<span class="token operator">|</span><span class="token number">528</span><span class="token operator">|</span>Success<span class="token operator">|</span>NETWORK SERVICE<span class="token punctuation">;</span>NT AUTHORITY<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x3E4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">5</span><span class="token punctuation">;</span>Advapi<span class="token punctuation">;</span>Negotiate<span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span>MACHINENAME$<span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x3E7</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token number">252</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span><span class="token punctuation">;</span><span class="token operator">-</span>
<span class="token number">2012</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">17</span> <span class="token number">17</span><span class="token punctuation">:</span><span class="token number">06</span><span class="token punctuation">:</span><span class="token number">19</span><span class="token operator">|</span>secevent<span class="token punctuation">.</span>evt<span class="token operator">|</span>MACHINENAME<span class="token operator">|</span>S<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span><span class="token operator">-</span><span class="token number">20</span> <span class="token punctuation">(</span>NT Authority<span class="token punctuation">)</span><span class="token operator">|</span>Security<span class="token operator">|</span><span class="token number">576</span><span class="token operator">|</span>Success<span class="token operator">|</span>NETWORK SERVICE<span class="token punctuation">;</span>NTAUTHORITY<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token number">0x0</span><span class="token punctuation">,</span><span class="token number">0x3E4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>SeAuditPrivilege                  SeAssignPrimaryTokenPrivilege                   SeImpersonatePrivilege

<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果<code>--verbose</code>使用该标志，还会评估 SID 并将其放置在解析的输出中，而不是默认的原始 SID。此操作需要更长的时间才能运行，因为插件必须从注册表项中计算每个服务 SID 和用户 SID。</p><h3 id="iehistory" tabindex="-1"><a class="header-anchor" href="#iehistory" aria-hidden="true">#</a> iehistory</h3><p>这个插件恢复 IE 历史 index.dat 缓存文件的片段。它可以找到基本的访问链接（通过 FTP 或 HTTP）、重定向链接 (--REDR) 和删除的条目 (--LEAK)。它适用于加载和使用 wininet.dll 库的任何进程，而不仅仅是 Internet Explorer。通常包括 Windows 资源管理器甚至恶意软件样本。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f exemplar17_1<span class="token punctuation">.</span>vmem iehistory
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
Process<span class="token punctuation">:</span> <span class="token number">1928</span> explorer<span class="token punctuation">.</span>exe
Cache <span class="token builtin">type</span> <span class="token string">&quot;URL &quot;</span> at <span class="token number">0xf25100</span>
Record length<span class="token punctuation">:</span> <span class="token number">0x100</span>
Location<span class="token punctuation">:</span> Visited<span class="token punctuation">:</span> foo@http<span class="token punctuation">:</span><span class="token operator">//</span><span class="token number">192.168</span><span class="token number">.30</span><span class="token number">.129</span><span class="token operator">/</span>malware<span class="token operator">/</span><span class="token number">40024</span><span class="token punctuation">.</span>exe
Last modified<span class="token punctuation">:</span> <span class="token number">2009</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">01</span><span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span><span class="token number">09</span> 
Last accessed<span class="token punctuation">:</span> <span class="token number">2009</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">01</span><span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span><span class="token number">09</span> 
File Offset<span class="token punctuation">:</span> <span class="token number">0x100</span><span class="token punctuation">,</span> Data Offset<span class="token punctuation">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span> Data Length<span class="token punctuation">:</span> <span class="token number">0xa0</span>
<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
Process<span class="token punctuation">:</span> <span class="token number">1928</span> explorer<span class="token punctuation">.</span>exe
Cache <span class="token builtin">type</span> <span class="token string">&quot;URL &quot;</span> at <span class="token number">0xf25300</span>
Record length<span class="token punctuation">:</span> <span class="token number">0x180</span>
Location<span class="token punctuation">:</span> Visited<span class="token punctuation">:</span> foo@http<span class="token punctuation">:</span><span class="token operator">//</span>www<span class="token punctuation">.</span>abcjmp<span class="token punctuation">.</span>com<span class="token operator">/</span>jump1<span class="token operator">/</span>?affiliate<span class="token operator">=</span>mu1<span class="token operator">&amp;</span>subid<span class="token operator">=</span><span class="token number">88037</span><span class="token operator">&amp;</span>terms<span class="token operator">=</span>eminem<span class="token operator">&amp;</span>sid<span class="token operator">=</span>Z605044303<span class="token operator">%</span><span class="token number">40</span><span class="token operator">%</span>40wMfNTNxkTM1EzX5QzNy81My8lM18FN4gTM2gzNzITM<span class="token operator">&amp;</span>a<span class="token operator">=</span>zh5<span class="token operator">&amp;</span>mr<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>rc<span class="token operator">=</span><span class="token number">0</span>
Last modified<span class="token punctuation">:</span> <span class="token number">2009</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">01</span><span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span><span class="token number">44</span> 
Last accessed<span class="token punctuation">:</span> <span class="token number">2009</span><span class="token operator">-</span><span class="token number">01</span><span class="token operator">-</span><span class="token number">08</span> <span class="token number">01</span><span class="token punctuation">:</span><span class="token number">52</span><span class="token punctuation">:</span><span class="token number">44</span> 
File Offset<span class="token punctuation">:</span> <span class="token number">0x180</span><span class="token punctuation">,</span> Data Offset<span class="token punctuation">:</span> <span class="token number">0x0</span><span class="token punctuation">,</span> Data Length<span class="token punctuation">:</span> <span class="token number">0x108</span>
<span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span><span class="token operator">**</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="核心内存和对象" tabindex="-1"><a class="header-anchor" href="#核心内存和对象" aria-hidden="true">#</a> 核心内存和对象</h2><h3 id="modules" tabindex="-1"><a class="header-anchor" href="#modules" aria-hidden="true">#</a> modules</h3><p>要查看系统上加载的内核驱动程序列表，请使用 <code>modules</code> 命令。这会遍历 PsLoadedModuleList 指向的 LDR_DATA_TABLE_ENTRY 结构的双向链表。与<a href="#pslist">pslist</a>命令类似，这依赖于查找 KDBG 结构。在极少数情况下，您可能需要使用<a href="#kdbgscan">kdbgscan</a>找到最合适的 KDBG 结构地址，然后将其提供给此插件，如 --kdbg=ADDRESS。</p><blockquote><p>它无法找到隐藏/未链接的内核驱动程序，但是<a href="#modscan">modscan</a>可以达到这个目的。</p></blockquote><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 modules
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Offset<span class="token punctuation">(</span>V<span class="token punctuation">)</span>          Name                 Base                             Size File
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token number">0xfffffa80004a11a0</span> ntoskrnl<span class="token punctuation">.</span>exe         <span class="token number">0xfffff8000261a000</span>           <span class="token number">0x5dd000</span> \SystemRoot\system32\ntoskrnl<span class="token punctuation">.</span>exe
<span class="token number">0xfffffa80004a10b0</span> hal<span class="token punctuation">.</span>dll              <span class="token number">0xfffff80002bf7000</span>            <span class="token number">0x49000</span> \SystemRoot\system32\hal<span class="token punctuation">.</span>dll
<span class="token number">0xfffffa80004a7950</span> kdcom<span class="token punctuation">.</span>dll            <span class="token number">0xfffff80000bb4000</span>             <span class="token number">0xa000</span> \SystemRoot\system32\kdcom<span class="token punctuation">.</span>dll
<span class="token number">0xfffffa80004a7860</span> mcupdate<span class="token punctuation">.</span>dll         <span class="token number">0xfffff88000c3a000</span>            <span class="token number">0x44000</span> \SystemRoot\system32\mcupdate_GenuineIntel<span class="token punctuation">.</span>dll
<span class="token number">0xfffffa80004a7780</span> PSHED<span class="token punctuation">.</span>dll            <span class="token number">0xfffff88000c7e000</span>            <span class="token number">0x14000</span> \SystemRoot\system32\PSHED<span class="token punctuation">.</span>dll
<span class="token number">0xfffffa80004a7690</span> CLFS<span class="token punctuation">.</span>SYS             <span class="token number">0xfffff88000c92000</span>            <span class="token number">0x5e000</span> \SystemRoot\system32\CLFS<span class="token punctuation">.</span>SYS
<span class="token number">0xfffffa80004a8010</span> CI<span class="token punctuation">.</span>dll               <span class="token number">0xfffff88000cf0000</span>            <span class="token number">0xc0000</span> \SystemRoot\system32\CI<span class="token punctuation">.</span>dll
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>输出显示 LDR_DATA_TABLE_ENTRY 结构的偏移量，默认情况下它是一个虚拟地址，但可以使用 -P 开关指定为物理地址，如下所示。在任何一种情况下，Base 列都是内核内存中模块基址的虚拟地址。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 modules <span class="token operator">-</span>P
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Offset<span class="token punctuation">(</span>P<span class="token punctuation">)</span>          Name                 Base                             Size File
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token number">0x0000000017fe01a0</span> ntoskrnl<span class="token punctuation">.</span>exe         <span class="token number">0xfffff8000261a000</span>           <span class="token number">0x5dd000</span> \SystemRoot\system32\ntoskrnl<span class="token punctuation">.</span>exe
<span class="token number">0x0000000017fe00b0</span> hal<span class="token punctuation">.</span>dll              <span class="token number">0xfffff80002bf7000</span>            <span class="token number">0x49000</span> \SystemRoot\system32\hal<span class="token punctuation">.</span>dll
<span class="token number">0x0000000017fe6950</span> kdcom<span class="token punctuation">.</span>dll            <span class="token number">0xfffff80000bb4000</span>             <span class="token number">0xa000</span> \SystemRoot\system32\kdcom<span class="token punctuation">.</span>dll
<span class="token number">0x0000000017fe6860</span> mcupdate<span class="token punctuation">.</span>dll         <span class="token number">0xfffff88000c3a000</span>            <span class="token number">0x44000</span> \SystemRoot\system32\mcupdate_GenuineIntel<span class="token punctuation">.</span>dll
<span class="token number">0x0000000017fe6780</span> PSHED<span class="token punctuation">.</span>dll            <span class="token number">0xfffff88000c7e000</span>            <span class="token number">0x14000</span> \SystemRoot\system32\PSHED<span class="token punctuation">.</span>dll
<span class="token number">0x0000000017fe6690</span> CLFS<span class="token punctuation">.</span>SYS             <span class="token number">0xfffff88000c92000</span>            <span class="token number">0x5e000</span> \SystemRoot\system32\CLFS<span class="token punctuation">.</span>SYS
<span class="token number">0x0000000017fe7010</span> CI<span class="token punctuation">.</span>dll               <span class="token number">0xfffff88000cf0000</span>            <span class="token number">0xc0000</span> \SystemRoot\system32\CI<span class="token punctuation">.</span>dll
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="modscan" tabindex="-1"><a class="header-anchor" href="#modscan" aria-hidden="true">#</a> modscan</h3><p><code>modscan</code> 命令通过扫描物理内存中的池标签来查找 LDR_DATA_TABLE_ENTRY 结构。这可以获取以前卸载的驱动程序和已被 rootkit 隐藏/取消链接的驱动程序。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 modscan
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Offset<span class="token punctuation">(</span>P<span class="token punctuation">)</span>          Name                 Base                             Size File
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token number">0x00000000173b90b0</span> DumpIt<span class="token punctuation">.</span>sys           <span class="token number">0xfffff88003980000</span>            <span class="token number">0x11000</span> \??\C<span class="token punctuation">:</span>\Windows\SysWOW64\Drivers\DumpIt<span class="token punctuation">.</span>sys
<span class="token number">0x000000001745b180</span> mouhid<span class="token punctuation">.</span>sys           <span class="token number">0xfffff880037e9000</span>             <span class="token number">0xd000</span> \SystemRoot\system32\DRIVERS\mouhid<span class="token punctuation">.</span>sys
<span class="token number">0x0000000017473010</span> lltdio<span class="token punctuation">.</span>sys           <span class="token number">0xfffff88002585000</span>            <span class="token number">0x15000</span> \SystemRoot\system32\DRIVERS\lltdio<span class="token punctuation">.</span>sys
<span class="token number">0x000000001747f010</span> rspndr<span class="token punctuation">.</span>sys           <span class="token number">0xfffff8800259a000</span>            <span class="token number">0x18000</span> \SystemRoot\system32\DRIVERS\rspndr<span class="token punctuation">.</span>sys
<span class="token number">0x00000000174cac40</span> dxg<span class="token punctuation">.</span>sys              <span class="token number">0xfffff96000440000</span>            <span class="token number">0x1e000</span> \SystemRoot\System32\drivers\dxg<span class="token punctuation">.</span>sys
<span class="token number">0x0000000017600190</span> monitor<span class="token punctuation">.</span>sys          <span class="token number">0xfffff8800360c000</span>             <span class="token number">0xe000</span> \SystemRoot\system32\DRIVERS\monitor<span class="token punctuation">.</span>sys
<span class="token number">0x0000000017601170</span> HIDPARSE<span class="token punctuation">.</span>SYS         <span class="token number">0xfffff880037de000</span>             <span class="token number">0x9000</span> \SystemRoot\system32\DRIVERS\HIDPARSE<span class="token punctuation">.</span>SYS
<span class="token number">0x0000000017604180</span> USBD<span class="token punctuation">.</span>SYS             <span class="token number">0xfffff880037e7000</span>             <span class="token number">0x2000</span> \SystemRoot\system32\DRIVERS\USBD<span class="token punctuation">.</span>SYS
<span class="token number">0x0000000017611d70</span> cdrom<span class="token punctuation">.</span>sys            <span class="token number">0xfffff88001944000</span>            <span class="token number">0x2a000</span> \SystemRoot\system32\DRIVERS\cdrom<span class="token punctuation">.</span>sys
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="moddump" tabindex="-1"><a class="header-anchor" href="#moddump" aria-hidden="true">#</a> moddump</h3><p>要将内核驱动程序提取到文件中，请使用 <code>moddump</code> 命令。使用 -D 或 --dump-dir=DIR 提供输出目录。如果需要特定的驱动程序，请使用 <code>--regex=REGEX</code> 提供驱动程序名称的正则表达式或使用 <code>--base=BASE</code> 提供模块的基地址。</p><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>$ python vol<span class="token punctuation">.</span>py <span class="token operator">-</span>f <span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>win7_trial_64bit<span class="token punctuation">.</span>raw <span class="token operator">-</span><span class="token operator">-</span>profile<span class="token operator">=</span>Win7SP0x64 moddump <span class="token operator">-</span>D drivers<span class="token operator">/</span>
Volatility Foundation Volatility Framework <span class="token number">2.4</span>
Module Base        Module Name          Result
<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>
<span class="token number">0xfffff8000261a000</span> ntoskrnl<span class="token punctuation">.</span>exe         OK<span class="token punctuation">:</span> driver<span class="token punctuation">.</span>fffff8000261a000<span class="token punctuation">.</span>sys
<span class="token number">0xfffff80002bf7000</span> hal<span class="token punctuation">.</span>dll              OK<span class="token punctuation">:</span> driver<span class="token punctuation">.</span>fffff80002bf7000<span class="token punctuation">.</span>sys
<span class="token number">0xfffff88000e5c000</span> intelide<span class="token punctuation">.</span>sys         OK<span class="token punctuation">:</span> driver<span class="token punctuation">.</span>fffff88000e5c000<span class="token punctuation">.</span>sys
<span class="token number">0xfffff8800349b000</span> mouclass<span class="token punctuation">.</span>sys         OK<span class="token punctuation">:</span> driver<span class="token punctuation">.</span>fffff8800349b000<span class="token punctuation">.</span>sys
<span class="token number">0xfffff88000f7c000</span> msisadrv<span class="token punctuation">.</span>sys         OK<span class="token punctuation">:</span> driver<span class="token punctuation">.</span>fffff88000f7c000<span class="token punctuation">.</span>sys
<span class="token number">0xfffff880035c3000</span> ndistapi<span class="token punctuation">.</span>sys         OK<span class="token punctuation">:</span> driver<span class="token punctuation">.</span>fffff880035c3000<span class="token punctuation">.</span>sys
<span class="token number">0xfffff88002c5d000</span> pacer<span class="token punctuation">.</span>sys            OK<span class="token punctuation">:</span> driver<span class="token punctuation">.</span>fffff88002c5d000<span class="token punctuation">.</span>sys
<span class="token punctuation">[</span>snip<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>与<a href="#dlldump">dlldump</a>类似，如果 PE 标头的关键部分不是内存驻留的，则重建/提取驱动程序可能会失败。此外，对于映射在不同会话中的驱动程序（如 win32k.sys），目前无法指定在获取驱动程序示例时使用哪个会话。</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/Forensics-wiki/Forensics-Wiki/edit/main/src/volatility/winvol.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">上次编辑于: </span><!----></div><div class="contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: 1762326648@qq.com">ZhangZ</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="vp-link nav-link prev" href="/volatility/base.html"><div class="hint"><span class="arrow start"></span>上一页</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-star" style=""></span>基本用法</div></a><!----></nav><div id="comment" class="giscus-wrapper input-top" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">Forensics-Wiki</div><div class="vp-copyright">Copyright © 2023 Forensics-Wiki</div></footer></div><!--]--><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-a6717152.js" defer></script>
  </body>
</html>
