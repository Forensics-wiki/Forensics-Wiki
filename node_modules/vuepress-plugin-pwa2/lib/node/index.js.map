{"version":3,"file":"index.js","sources":["../../src/node/locales.ts","../../src/node/utils.ts","../../src/node/compact/utils.ts","../../src/node/compact/convert.ts","../../src/node/generateManifest.ts","../../src/node/generateServiceWorker.ts","../../src/node/helper.ts","../../src/node/injectHead.ts","../../src/node/prepare.ts","../../src/node/plugin.ts"],"sourcesContent":["import type { PWALocaleConfig } from \"../shared/index.js\";\n\n/** Multi language config for pwa popup */\nexport const pwaLocales: PWALocaleConfig = {\n  \"/en/\": {\n    install: \"Install\",\n    iOSInstall: \"Tap the share button and then 'Add to Home Screen'\",\n    cancel: \"Cancel\",\n    close: \"Close\",\n    prevImage: \"Previous Image\",\n    nextImage: \"Next Image\",\n    desc: \"Description\",\n    feature: \"Key Features\",\n    explain:\n      \"This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. \",\n    hint: \"New content found.\",\n    update: \"New content is available.\",\n  },\n\n  \"/zh/\": {\n    install: \"安装\",\n    iOSInstall: \"点击分享按钮然后点击“添加到主屏幕”\",\n    cancel: \"取消\",\n    close: \"关闭\",\n    prevImage: \"上一张图片\",\n    nextImage: \"下一张图片\",\n    desc: \"详情\",\n    feature: \"主要特色\",\n    explain:\n      \"该应用可以安装在你的 PC 或移动设备上。这将使该 Web 应用程序外观和行为与其他应用程序相同。它将在出现在应用程序列表中，并可以固定到主屏幕，开始菜单或任务栏。此 Web 应用程序还将能够与其他应用程序和你的操作系统安全地进行交互。\",\n    hint: \"发现新内容可用\",\n    update: \"新内容已就绪\",\n  },\n\n  \"/zh-tw/\": {\n    install: \"安裝\",\n    iOSInstall: \"點擊分享按鈕然後點擊“添加到主畫面”\",\n    cancel: \"取消\",\n    close: \"關閉\",\n    prevImage: \"上一張圖片\",\n    nextImage: \"下一張圖片\",\n    desc: \"詳情\",\n    feature: \"主要特色\",\n    explain:\n      \"該應用可以安裝在你的 PC 或行動裝置上。這將使該 Web 應用程式外觀和行為與其他應用程式相同。它將在出現在應用程式列表中，並可以固定到主畫面，開始菜單或任務欄。此 Web 應用程式還將能夠與其他應用程式和你的操作系統安全地進行交互。\",\n    hint: \"發現新内容可用\",\n    update: \"新内容已就绪\",\n  },\n\n  \"/de/\": {\n    install: \"Installieren\",\n    iOSInstall: \"Drucke den Share-Button und dann 'zu Homescreen hinzufügen'\",\n    cancel: \"Abbrechen\",\n    close: \"Schließen\",\n    prevImage: \"Vorheriges Bild\",\n    nextImage: \"Nächstes Bild\",\n    desc: \"Berschreibung\",\n    feature: \"Funktionen\",\n    explain:\n      \"Diese App kann auf Ihrem PC oder Mobilgerät installiert werden. Dadurch sieht diese Web-App aus und verhält sich wie jede andere installierte App. Sie finden sie in Ihren App-Listen und können sie an den Startbildschirm, die Startmenüs oder die Taskleisten anheften. Diese installierte Web-App kann auch sicher mit anderen Apps und Ihrem Betriebssystem interagieren.\",\n    hint: \"Neuer Inhalt gefunden.\",\n    update: \"Neue Inhalte sind verfügbar.\",\n  },\n\n  \"/de-at/\": {\n    install: \"Installieren\",\n    iOSInstall: \"Drucke den Share-Button und dan 'zu Homescreen hinzufügen'\",\n    cancel: \"Abbrechen\",\n    close: \"Schließen\",\n    prevImage: \"Vorheriges Bild\",\n    nextImage: \"Nächstes Bild\",\n    desc: \"Berschreibung\",\n    feature: \"Features\",\n    explain:\n      \"Diese App kann auf Ihrem PC oder Mobilgerät installiert werden.  Dadurch sieht diese Web-App aus und verhält sich wie jede andere installierte App.  Sie finden sie in Ihren App-Listen und können sie an den Startbildschirm, die Startmenüs oder die Taskleisten anheften.  Diese installierte Web-App kann auch sicher mit anderen Apps und Ihrem Betriebssystem interagieren.\",\n    hint: \"Neue Inhalte sind verfügbar.\",\n    update: \"Neue Inhalte sind verfügbar.\",\n  },\n\n  \"/vi/\": {\n    install: \"Tải về\",\n    iOSInstall: \"Nhấn vào nút chia sẻ và sau đó 'Thêm vào Màn hình chính'\",\n    cancel: \"Huỷ bỏ\",\n    close: \"Đóng\",\n    prevImage: \"Hình ảnh trước đó\",\n    nextImage: \"Hình ảnh tiếp theo\",\n    desc: \"Sự miêu tả\",\n    feature: \"Các tính năng chính\",\n    explain:\n      \"Ứng dụng này có thể được cài đặt trên PC hoặc thiết bị di động của bạn. Điều này sẽ cho phép ứng dụng web này trông và hoạt động giống như bất kỳ ứng dụng đã cài đặt nào khác. Bạn sẽ tìm thấy nó trong danh sách ứng dụng của mình và có thể ghim nó vào màn hình chính, menu bắt đầu hoặc thanh tác vụ. Ứng dụng web đã cài đặt này cũng sẽ có thể tương tác an toàn với các ứng dụng khác và hệ điều hành của bạn.\",\n    hint: \"Nội dung mới được tìm thấy\",\n    update: \"Đã có nội dung mới\",\n  },\n\n  \"/uk/\": {\n    install: \"Встановити\",\n    iOSInstall:\n      \"Торкніться кнопки «Поділитися», а потім «Додати на головний екран»\",\n    cancel: \"Скасувати\",\n    close: \"Закрити\",\n    prevImage: \"Попереднє зображення\",\n    nextImage: \"Наступне зображення\",\n    desc: \"Опис\",\n    feature: \"Основні характеристики\",\n    explain:\n      \"Цю програму можна встановити на ПК або мобільний пристрій. Це дозволить цій веб-програмі виглядати та вести себе як будь-яка інша встановлена програма. Ви знайдете її у списках додатків і зможете закріпити на головному екрані, в меню «Пуск» або на панелі завдань. Ця встановлена веб-програма також зможе безпечно взаємодіяти з іншими програмами та вашою операційною системою. \",\n    hint: \"Знайдено новий вміст\",\n    update: \"Доступний новий контент.\",\n  },\n\n  \"/ru/\": {\n    install: \"Установить\",\n    iOSInstall:\n      \"Нажмите кнопку «Поделиться», а затем «Добавить на главный экран»\",\n    cancel: \"Отменить\",\n    close: \"Закрыть\",\n    prevImage: \"Предыдущее изображение\",\n    nextImage: \"Следующее изображение\",\n    desc: \"Описание\",\n    feature: \"Основные функции\",\n    explain:\n      \"Это приложение может быть установлено на вашем компьютере или мобильном устройстве.  Это позволит веб-приложению выглядеть и вести себя как любое другое установленное приложение.  Вы найдете его в списках приложений и сможете закрепить его на домашнем экране, в меню пуск или на панели задач.  Установленное веб-приложение также сможет безопасно взаимодействовать с другими приложениями и операционной системой. \",\n    hint: \"Найден новый контент\",\n    update: \"Доступен новый контент.\",\n  },\n\n  \"/br/\": {\n    install: \"Instalar\",\n    iOSInstall: \"Toque no botão de compartilhar e depois 'Adicionar à Home'\",\n    cancel: \"Cancelar\",\n    close: \"Fechar\",\n    prevImage: \"Imagem anterior\",\n    nextImage: \"Próxima imagem\",\n    desc: \"Descrição\",\n    feature: \"Características Chave\",\n    explain:\n      \"Esta aplicação web pode ser instalada no seu PC ou dispositivo móvel. Isso fará com que ela se pareça e se comporte como qualquer outra aplicação.  Você a encontrará na lista de apps e poderá adicionar seu ícone à tela de entrada, menus ou barras de tarefa.  Uma vez instalada, esta aplicação web também poderá interagir com outras aplicações ou com o próprio sistema operacional. \",\n    hint: \"Novo conteúdo encontrado\",\n    update: \"Novo conteúdo está disponível.\",\n  },\n\n  \"/pl/\": {\n    install: \"Zainstaluj\",\n    iOSInstall:\n      \"Stuknij przycisk udostępniania, a następnie „Dodaj do ekranu głównego”\",\n    cancel: \"Anuluj\",\n    close: \"Zamknij\",\n    prevImage: \"Poprzedni obrazek\",\n    nextImage: \"Następny obrazek\",\n    desc: \"Opis\",\n    feature: \"Kluczowe cechy\",\n    explain:\n      \"Tę aplikację można zainstalować na komputerze lub urządzeniu mobilnym. Dzięki temu ta aplikacja internetowa będzie wyglądać i zachowywać się jak każda inna zainstalowana aplikacja. Znajdziesz ją na listach aplikacji i będziesz mógł przypiąć go do ekranu głównego, menu startowego lub pasków zadań. Ta zainstalowana aplikacja internetowa będzie również mogła bezpiecznie komunikować się z innymi aplikacjami i systemem operacyjnym.\",\n    hint: \"Znaleziono nową zawartość.\",\n    update: \"Nowa zawartość jest dostępna.\",\n  },\n\n  \"/sk/\": {\n    install: \"Insštalácia\",\n    iOSInstall:\n      \"Klikni na tlačidlo zdielania a potom 'Daj na domovskú obrazovku'\",\n    cancel: \"Zrušiť\",\n    close: \"Zavrieť\",\n    prevImage: \"Prodošlí obrázok\",\n    nextImage: \"Ďalší obrázok\",\n    desc: \"Poznámka\",\n    feature: \"Kľúčové vlastnosti\",\n    explain:\n      \"Túto aplikáciu je možné nainštalovať na počítač alebo mobil.  Toto umožný sa správať aplikácii ako každej inej nainštalovanej aplikácii.  Nájdeš ju vo svojom liste aplikácii a budeš môcť ju pripnúť na domovskú stránku, štartovacieho menu alebo do panelu úloh.  Táto nainštalovaná webová aplikácia umžní tiež bezpečne komunikovať s ostatnými nainštalovanými aplikáciami a operačným systémom. \",\n    hint: \"Nový obsah bol nájdený.\",\n    update: \"Nový obsah je dostupný.\",\n  },\n\n  \"/fr/\": {\n    install: \"Installer\",\n    iOSInstall:\n      \"Appuyez sur le bouton partager puis 'Ajouter à l'écran d'accueil'\",\n    cancel: \"Annuler\",\n    close: \"Fermer\",\n    prevImage: \"Image précédente\",\n    nextImage: \"Image suivante\",\n    desc: \"Description\",\n    feature: \"Composants clés\",\n    explain:\n      \"Cette app peut être installée sur PC ou smartphone.  Cela permettra de rendre cette page web comme n'importe quelle autre application.  Vous la trouverez dans votre liste d'application et serez capable de la pin sur votre écran principal et divers menus.  L'application web installée sera capable d'interagir avec les autres applications et le système d'exploitation.\",\n    hint: \"New content found.\",\n    update: \"New content is available.\",\n  },\n\n  \"/es/\": {\n    install: \"Instalar\",\n    iOSInstall:\n      \"Toque el botón compartir y luego 'Agregar a la pantalla de inicio'\",\n    cancel: \"Cancelar\",\n    close: \"Cerrar\",\n    prevImage: \"Imagen anterior\",\n    nextImage: \"Imagen siguiente\",\n    desc: \"Descripción\",\n    feature: \"Características clave\",\n    explain:\n      \"Esta aplicación se puede instalar en su PC o dispositivo móvil. Esto permitirá que esta aplicación web se vea y se comporte como cualquier otra aplicación instalada. Lo encontrará en su lista de aplicaciones y podrá fijarlo a su pantalla de inicio, menús de inicio o barras de tareas. Esta aplicación web instalada también podrá interactuar de manera segura con otras aplicaciones y su sistema operativo.\",\n    hint: \"Nuevo contenido encontrado.\",\n    update: \"Hay nuevo contenido disponible.\",\n  },\n\n  \"/ja/\": {\n    install: \"インストール\",\n    iOSInstall:\n      \"共有ボタンをタップし、「ホームスクリーンに追加」をタップします\",\n    cancel: \"キャンセル\",\n    close: \"閉じる\",\n    prevImage: \"前の画像\",\n    nextImage: \"次の画像\",\n    desc: \"詳細\",\n    feature: \"主な特徴\",\n    explain:\n      \"このアプリは、PCまたはモバイルデバイスにインストールすることができます。 これにより、このウェブアプリは、インストールされている他のアプリと同様に表示され、動作するようになります。 アプリ一覧で見つけることができ、ホーム画面、スタートメニュー、タスクバーに固定することができます。 このインストールされたウェブアプリケーションは、他のアプリケーションやオペレーティングシステムと安全にやり取りすることもできます。\",\n    hint: \"新しいコンテンツが見つかりました。\",\n    update: \"新しいコンテンツが登場しました。\",\n  },\n\n  \"/tr/\": {\n    install: \"Yükle\",\n    iOSInstall:\n      \"Paylaş düğmesine ve ardından 'Ana Ekrana Ekle' düğmesine basın\",\n    cancel: \"İptal\",\n    close: \"Kapat\",\n    prevImage: \"Önceki Resim\",\n    nextImage: \"Sonraki Resim\",\n    desc: \"Tanım\",\n    feature: \"Ana Özellikler\",\n    explain:\n      \"Bu uygulama PC'nize veya mobil cihazınıza yüklenebilir. Yüklenmesi bu web uygulamasının diğer yüklü uygulamalar gibi görünmesini ve davranmasını sağlar. Yüklenen web uygulamasını uygulama listenizde bulabilir ve ana ekranınıza, menülere veya görev çubuklarına sabitleyebilirsiniz. Aynı zamanda yüklenen web uygulaması, diğer uygulamalar ve işletim sisteminizle güvenli bir şekilde etkileşime girebilecektir.\",\n    hint: \"Yeni içerik bulundu.\",\n    update: \"Yeni içerik mevcut.\",\n  },\n\n  \"/ko/\": {\n    install: \"설치\",\n    iOSInstall: \"공유 버튼을 누르고 '홈 화면에 추가'를 누르세요\",\n    cancel: \"취소\",\n    close: \"닫기\",\n    prevImage: \"이전 이미지\",\n    nextImage: \"다음 이미지\",\n    desc: \"설명\",\n    feature: \"주요 기능\",\n    explain:\n      \"이 앱은 PC 또는 모바일 장치에 설치할 수 있습니다. 이렇게 하면 이 웹 앱은 다른 설치된 앱과 마찬가지로 표시되고 작동합니다. 앱 목록에서 찾을 수 있으며 홈 화면, 시작 메뉴, 작업 표시줄에 고정할 수 있습니다. 설치된 웹 앱은 다른 앱과 안전하게 상호 작용할 수 있습니다.\",\n    hint: \"새로운 콘텐츠를 찾았습니다.\",\n    update: \"새로운 콘텐츠가 있습니다.\",\n  },\n\n  \"/fi/\": {\n    install: \"Asenna\",\n    iOSInstall: \"Paina Jaa-painiketta ja sitten 'Lisää kotiin'-painiketta\",\n    cancel: \"Peruuta\",\n    close: \"Sulje\",\n    prevImage: \"Edellinen kuva\",\n    nextImage: \"Seuraava kuva\",\n    desc: \"Kuvaus\",\n    feature: \"Avainominaisuudet\",\n    explain:\n      \"Tämä sovellus on asennettavissa tietokoneelle tai mobiililaitteelle. Tämä mahdollistaa sovelluksen toiminnan tietokoneohjelmana. Löydät sen sovelluslistasta ja voit kiinnittää sen työpöydälle, kotinäytölle, tehtäväpalkkiin tai muulle listalle. Asennettu sovellus voi turvallisesti olla vuorovaikutuksessa muiden sovellusten ja käyttöjärjestelmäsi kanssa.\",\n    hint: \"Uutta sisältöä.\",\n    update: \"Uutta sisältöä on saatavilla.\",\n  },\n\n  \"/hu/\": {\n    install: \"Telepítés\",\n    iOSInstall:\n      \"Nyomd meg a megosztás gombot, majd a 'Hozzáadás a kezdőképernyőhöz' opciót\",\n    cancel: \"Mégse\",\n    close: \"Bezárás\",\n    prevImage: \"Előző kép\",\n    nextImage: \"Következő kép\",\n    desc: \"Leírás\",\n    feature: \"Főbb jellemzők\",\n    explain:\n      \"Ez az alkalmazás telepíthető PC-re vagy mobil eszközre. Ez lehetővé teszi, hogy ez a webalkalmazás úgy nézzen ki és viselkedjen, mint bármely más telepített alkalmazás. Az alkalmazáslistában találod majd, és hozzáadhatod a kezdőképernyőhöz, indító menühöz vagy a feladatok sávjához. Az telepített webalkalmazás biztonságosan interakcióba léphet más alkalmazásokkal és az operációs rendszerrel.\",\n    hint: \"Új tartalom érhető el.\",\n    update: \"Új tartalom érhető el.\",\n  },\n\n  \"/id/\": {\n    install: \"Install\",\n    iOSInstall: \"Ketuk tombol bagikan, lalu 'Tambahkan ke Layar Utama'\",\n    cancel: \"Batal\",\n    close: \"Tutup\",\n    prevImage: \"Gambar sebelumnya\",\n    nextImage: \"Gambar selanjutnya\",\n    desc: \"Keterangan\",\n    feature: \"Fitur\",\n    explain:\n      \"Aplikasi ini dapat diinstal di PC atau perangkat seluler Anda.  Ini akan memungkinkan aplikasi web ini terlihat seperti aplikasi terpasang lainnya.  Anda bisa menemukannya di daftar aplikasi dan dapat menyematkannya ke layar beranda, menu start, atau menu ke taskbar.  Aplikasi web yang terinstal ini juga dapat berinteraksi dengan aplikasi lain dan dengan sistem operasi yang Anda gunakan. \",\n    hint: \"Konten baru ditemukan.\",\n    update: \"Konten baru telah tersedia.\",\n  },\n\n  \"/nl/\": {\n    install: \"Installeren\",\n    iOSInstall: \"Druk op de share button en dan op 'Add to Home Screen'\",\n    cancel: \"Annuleren\",\n    close: \"Sluiten\",\n    prevImage: \"Vorige Foto\",\n    nextImage: \"Volgende Foto\",\n    desc: \"Beschrijving\",\n    feature: \"Belangrijkste mogelijkheden\",\n    explain:\n      \"Deze app kan op uw PC of mobiel toestel geïnstalleerd worden. Dit laat toe om deze webapp er uit te laten alsof het een normale app is. Je kan het terugvinden in jouw applijsten en kan het op je homescreen, start menu of taakbalk vastzetten. Deze geïnstalleerde webapp zal ook veilig samenwerken met andere apps en uw besturingssysteem. \",\n    hint: \"Nieuwe inhoud gevonden.\",\n    update: \"Nieuwe inhoud is beschikbaar.\",\n  },\n};\n","import { getDirname, path } from \"@vuepress/utils\";\nimport { Logger, ensureEndingSlash } from \"vuepress-shared/node\";\n\nconst __dirname = getDirname(import.meta.url);\n\nexport const CLIENT_FOLDER = ensureEndingSlash(\n  path.resolve(__dirname, \"../client\"),\n);\n\nexport const PLUGIN_NAME = \"vuepress-plugin-pwa2\";\n\nexport const logger = new Logger(PLUGIN_NAME);\n","import { colors } from \"@vuepress/utils\";\n\nimport { logger } from \"../utils.js\";\n\nexport interface DeprecatedLoggerOptions {\n  options: Record<string, unknown>;\n  deprecatedOption: string;\n  newOption: string;\n  msg?: string;\n  scope?: string;\n}\n\nexport const deprecatedLogger = ({\n  options,\n  deprecatedOption,\n  newOption,\n  msg = \"\",\n  scope = \"\",\n}: DeprecatedLoggerOptions): void => {\n  if (deprecatedOption in options) {\n    logger.warn(\n      `${colors.magenta(deprecatedOption)} is ${colors.yellow(\"deprecated\")}${\n        scope ? ` in ${scope}` : \"\"\n      }, please use \"${colors.magenta(newOption)}\" instead.${\n        msg ? `\\n${msg}` : \"\"\n      }`,\n    );\n\n    if (newOption.includes(\".\")) {\n      const keys = newOption.split(\".\");\n      let temp = options;\n\n      keys.forEach((key, index) => {\n        if (index !== keys.length - 1) {\n          // ensure level exists\n          temp[key] = temp[key] || {};\n\n          temp = temp[key] as Record<string, unknown>;\n        } else {\n          temp[key] = options[deprecatedOption];\n        }\n      });\n    } else {\n      options[newOption] = options[deprecatedOption];\n    }\n\n    delete options[deprecatedOption];\n  }\n};\n","import { deprecatedLogger } from \"./utils.js\";\nimport type { PWAOptions } from \"../options.js\";\n\n/** @deprecated */\nexport const convertOptions = (\n  options: PWAOptions & Record<string, unknown>,\n): void => {\n  deprecatedLogger({\n    options,\n    deprecatedOption: \"cacheMaxSize\",\n    newOption: \"maxSize\",\n  });\n  deprecatedLogger({\n    options,\n    deprecatedOption: \"popupComponent\",\n    newOption: \"updateComponent\",\n  });\n};\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type { App } from \"@vuepress/core\";\nimport { colors, fs, path } from \"@vuepress/utils\";\nimport { getRootLang } from \"vuepress-shared/node\";\n\nimport type { PWAOptions } from \"./options.js\";\nimport { logger } from \"./utils.js\";\nimport type { ManifestOption } from \"../shared/index.js\";\n\nexport const getManifest = async (\n  app: App,\n  options: PWAOptions,\n): Promise<ManifestOption> => {\n  const { dir, siteData } = app;\n\n  const { base } = app.options;\n  const userManifestPath = dir.source(\".vuepress/public/manifest.webmanifest\");\n  const userManifestJSONPath = dir.source(\".vuepress/public/manifest.json\");\n\n  const optionManifest = options.manifest || {};\n\n  const userManifest = <ManifestOption>(\n    JSON.parse(\n      fs.existsSync(userManifestPath)\n        ? await fs.readFile(userManifestPath, \"utf8\")\n        : fs.existsSync(userManifestJSONPath)\n        ? await fs.readFile(userManifestJSONPath, \"utf8\")\n        : \"{}\",\n    )\n  );\n\n  const finalManifest: ManifestOption = {\n    name: siteData.title || siteData.locales[\"/\"]?.title || \"Site\",\n    short_name: siteData.title || siteData.locales[\"/\"]?.title || \"Site\",\n    description:\n      siteData.description ||\n      siteData.locales[\"/\"]?.description ||\n      \"A site built with vuepress\",\n    lang: getRootLang(app),\n    start_url: base,\n    scope: base,\n\n    display: \"standalone\",\n    theme_color: options.themeColor || \"#46bd87\",\n    background_color: \"#ffffff\",\n    orientation: \"portrait-primary\",\n    prefer_related_applications: false,\n\n    ...userManifest,\n    ...optionManifest,\n  };\n\n  return finalManifest;\n};\n\nexport const generateManifest = async (\n  app: App,\n  manifest: Promise<ManifestOption>,\n): Promise<void> => {\n  logger.load(\"Generating manifest.webmanifest\");\n\n  const { dir } = app;\n  const manifestPath = dir.dest(\"manifest.webmanifest\");\n\n  await fs.writeJSON(manifestPath, await manifest, {\n    flag: \"w\",\n  });\n\n  logger.succeed();\n  logger.update(\n    `Manifest generated and saved to ${colors.cyan(\n      path.relative(process.cwd(), manifestPath),\n    )}!`,\n  );\n};\n","import type { App } from \"@vuepress/core\";\nimport { colors, fs, path } from \"@vuepress/utils\";\nimport { endsWith } from \"vuepress-shared/node\";\nimport type {\n  ManifestEntry,\n  ManifestTransform,\n  ManifestTransformResult,\n} from \"workbox-build\";\nimport { generateSW } from \"workbox-build\";\n\nimport type { PWAOptions } from \"./options.js\";\nimport { logger } from \"./utils.js\";\n\nconst imageFilter =\n  (outDir: string, maxSize = 1024): ManifestTransform =>\n  (\n    manifestEntries: (ManifestEntry & { size: number })[],\n  ): ManifestTransformResult => {\n    const warnings: string[] = [];\n    const manifest: (ManifestEntry & { size: number })[] = [];\n    const imageExtensions = [\".png\", \".jpg\", \".jpeg\", \"webp\", \"bmp\", \"gif\"];\n\n    for (const entry of manifestEntries)\n      if (imageExtensions.some((ext) => endsWith(entry.url, ext))) {\n        const stats = fs.statSync(path.resolve(outDir, entry.url));\n\n        if (stats.size > maxSize * 1024)\n          warnings.push(\n            `Skipped ${entry.url}, as it's ${Math.ceil(stats.size / 1024)} KB.`,\n          );\n        else manifest.push(entry);\n      } else {\n        manifest.push(entry);\n      }\n\n    return { warnings, manifest };\n  };\n\nexport const generateServiceWorker = async (\n  app: App,\n  options: PWAOptions,\n): Promise<void> => {\n  logger.load(\"Generating service worker\");\n\n  const { dest } = app.dir;\n  const swDest = dest(\"service-worker.js\");\n  const destDir = path.relative(process.cwd(), dest());\n\n  const globPatterns = [\"**/*.{js,css,svg,woff,woff2,eot,ttf,otf}\"];\n\n  if (options.cacheHTML) globPatterns.push(\"**/*.html\");\n  else globPatterns.push(\"./index.html\", \"./404.html\");\n\n  if (options.cachePic) globPatterns.push(\"**/*.{png,jpg,jpeg,bmp,gif,webp}\");\n\n  await generateSW({\n    swDest,\n    globDirectory: destDir,\n    globPatterns,\n    cleanupOutdatedCaches: true,\n    clientsClaim: true,\n    maximumFileSizeToCacheInBytes: (options.maxSize || 2048) * 1024,\n    manifestTransforms: [imageFilter(destDir, options.maxPicSize)],\n    ...(options.generateSWConfig || {}),\n  }).then(({ count, size, warnings }) => {\n    logger.succeed();\n\n    logger.info(\n      `Precache ${colors.cyan(`${count} files`)}, totaling ${colors.cyan(\n        `${(size / 1024 / 1024).toFixed(2)} Mb.`,\n      )}.`,\n    );\n\n    if (warnings.length)\n      logger.warn(\n        `\\n${warnings.map((warning) => `  · ${warning}`).join(\"\\n\")}`,\n      );\n\n    if (size > 104857600)\n      logger.error(\n        `Cache Size is larger than 100MB, so that it can not be registered on all browsers.\\n${colors.blue(\n          \"Please consider disable `cacheHTML` and `cachePic`, or set `maxSize` and `maxPicSize` option.\\n\",\n        )}`,\n      );\n    else if (size > 52428800)\n      logger.warn(\n        `\\nCache Size is larger than 50MB, which will not be registered on Safari.\\n${colors.blue(\n          \"Please consider disable `cacheHTML` and `cachePic`, or set `maxSize` and `maxPicSize` option.\\n\",\n        )}`,\n      );\n  });\n};\n","import { isAbsoluteUrl } from \"vuepress-shared/node\";\n\nimport type { PWAOptions } from \"./options.js\";\nimport type { ManifestOption } from \"../shared/index.js\";\n\nconst appendBaseHelper = (base: string, link: string): string =>\n  isAbsoluteUrl(link) ? link.replace(/^\\//, base) : link;\n\nexport const appendBaseToManifest = (\n  base: string,\n  manifest: ManifestOption,\n): ManifestOption => {\n  if (manifest.icons)\n    manifest.icons = manifest.icons.map((icon) => ({\n      ...icon,\n      src: appendBaseHelper(base, icon.src),\n    }));\n\n  if (manifest.shortcuts)\n    manifest.shortcuts = manifest.shortcuts.map((shortcut) => ({\n      ...shortcut,\n      icons:\n        shortcut.icons?.map((icon) => ({\n          ...icon,\n          src: appendBaseHelper(base, icon.src),\n        })) || [],\n      url: appendBaseHelper(base, shortcut.url),\n    }));\n\n  if (manifest.screenshots)\n    manifest.screenshots = manifest.screenshots.map((screenshot) => ({\n      ...screenshot,\n      src: appendBaseHelper(base, screenshot.src),\n    }));\n\n  return manifest;\n};\n\nexport const appendBase = (base: string, options: PWAOptions): void => {\n  if (options.favicon)\n    options.favicon = appendBaseHelper(base, options.favicon);\n\n  if (options.apple) {\n    if (options.apple.icon)\n      options.apple.icon = appendBaseHelper(base, options.apple.icon);\n\n    if (options.apple.maskIcon)\n      options.apple.maskIcon = appendBaseHelper(base, options.apple.maskIcon);\n  }\n\n  if (options.msTile && options.msTile.image)\n    options.msTile.image = appendBaseHelper(base, options.msTile.image);\n\n  if (options.manifest)\n    options.manifest = appendBaseToManifest(base, options.manifest);\n};\n","import type { HeadConfig } from \"@vuepress/core\";\nimport { isPlainObject } from \"vuepress-shared/node\";\n\nimport type { PWAOptions } from \"./options.js\";\n\nexport const injectLinksToHead = (\n  options: PWAOptions,\n  base = \"/\",\n  head: HeadConfig[] = [],\n): HeadConfig[] => {\n  const metaKeys: string[] = [];\n  const linkKeys: string[] = [];\n\n  // Generate Hash for Head\n  head.forEach((item) => {\n    if (item[0] === \"meta\") metaKeys.push(<string>item[1][\"name\"]);\n    else if (item[0] === \"link\") linkKeys.push(<string>item[1][\"rel\"]);\n  });\n\n  let fallBackIcon = \"\";\n  const setLink = (\n    rel: string,\n    href: string,\n    more: Record<string, string> = {},\n  ): void => {\n    if (!linkKeys.includes(rel)) head.push([\"link\", { rel, href, ...more }]);\n  };\n\n  const setMeta = (\n    name: string,\n    content: string,\n    more: Record<string, string> = {},\n  ): void => {\n    if (!metaKeys.includes(name))\n      head.push([\"meta\", { name, content, ...more }]);\n  };\n\n  if (options.favicon) setLink(\"icon\", options.favicon);\n\n  if (options.manifest?.icons) {\n    const { icons } = options.manifest;\n\n    if (icons.length > 0) {\n      fallBackIcon = icons[0].src;\n\n      options.manifest.icons.map((icon) => {\n        if (icon.type)\n          setLink(\"icon\", icon.src, { type: icon.type, sizes: icon.sizes });\n        else setLink(\"icon\", icon.src, { sizes: icon.sizes });\n      });\n    }\n  }\n\n  setLink(\"manifest\", `${base}manifest.webmanifest`, {\n    crossorigin: \"use-credentials\",\n  });\n  setMeta(\"theme-color\", options.themeColor || \"#46bd87\");\n\n  if (isPlainObject(options.apple) && (options.apple.icon || fallBackIcon)) {\n    setLink(\"apple-touch-icon\", options.apple.icon || fallBackIcon);\n    setMeta(\"apple-mobile-web-app-capable\", \"yes\");\n    setMeta(\n      \"apple-mobile-web-app-status-bar-style\",\n      options.apple.statusBarColor || \"black\",\n    );\n    if (options.apple.maskIcon)\n      setLink(\"mask-icon\", options.apple.maskIcon, {\n        color: options.themeColor || \"#46bd87\",\n      });\n  } else if (options.apple !== false && fallBackIcon) {\n    setLink(\"apple-touch-icon\", fallBackIcon);\n    setMeta(\"apple-mobile-web-app-capable\", \"yes\");\n    setMeta(\"apple-mobile-web-app-status-bar-style\", \"black\");\n  }\n\n  if (isPlainObject(options.msTile) && (options.msTile.image || fallBackIcon)) {\n    setMeta(\"msapplication-TileImage\", options.msTile.image || fallBackIcon);\n    setMeta(\n      \"msapplication-TileColor\",\n      options.msTile.color || options.themeColor || \"#46bd87\",\n    );\n  } else if (options.msTile !== false && fallBackIcon) {\n    setMeta(\"msapplication-TileImage\", fallBackIcon);\n    setMeta(\"msapplication-TileColor\", options.themeColor || \"#46bd87\");\n  }\n\n  // enhance pwa experience\n  setMeta(\n    \"viewport\",\n    \"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover\",\n  );\n\n  return head;\n};\n","import type { App } from \"@vuepress/core\";\n\nimport type { PWAOptions } from \"./options.js\";\nimport { CLIENT_FOLDER } from \"./utils.js\";\n\nexport const prepareConfigFile = (\n  app: App,\n  options: PWAOptions,\n): Promise<string> => {\n  let configImport = \"\";\n  let rootComponents = \"\";\n\n  if (options.update === \"hint\") {\n    configImport += `\\\nimport SWHintPopup from \"${\n      options.hintComponent || `${CLIENT_FOLDER}components/SWHintPopup.js`\n    }\";\n`;\n\n    rootComponents += `\\\nSWHintPopup,\n`;\n  } else if (options.update !== \"disable\" && options.update !== \"force\") {\n    configImport += `\\\nimport SWUpdatePopup from \"${\n      options.updateComponent || `${CLIENT_FOLDER}components/SWUpdatePopup.js`\n    }\";\n`;\n\n    rootComponents += `\\\nSWUpdatePopup,\n`;\n  }\n\n  return app.writeTemp(\n    `pwa2/config.js`,\n    `\\\nimport { defineClientConfig } from \"@vuepress/client\";\nimport { setupPWA } from \"${CLIENT_FOLDER}composables/setup.js\";\n${configImport}\n\nexport default defineClientConfig({\n  setup: () => {\n    setupPWA();\n  },\n  rootComponents: [\n${rootComponents\n  .split(\"\\n\")\n  .map((item) => `    ${item}`)\n  .join(\"\\n\")}\n  ],\n});\n`,\n  );\n};\n","import type { PluginFunction } from \"@vuepress/core\";\nimport { useSassPalettePlugin } from \"vuepress-plugin-sass-palette\";\nimport {\n  addViteOptimizeDepsExclude,\n  checkVersion,\n  getLocales,\n  useCustomDevServer,\n} from \"vuepress-shared/node\";\n\nimport { convertOptions } from \"./compact/index.js\";\nimport { generateManifest, getManifest } from \"./generateManifest.js\";\nimport { generateServiceWorker } from \"./generateServiceWorker.js\";\nimport { appendBase } from \"./helper.js\";\nimport { injectLinksToHead } from \"./injectHead.js\";\nimport { pwaLocales } from \"./locales.js\";\nimport type { PWAOptions } from \"./options.js\";\nimport { prepareConfigFile } from \"./prepare.js\";\nimport { PLUGIN_NAME, logger } from \"./utils.js\";\n\nexport const pwaPlugin =\n  (options: PWAOptions = {}, legacy = true): PluginFunction =>\n  (app) => {\n    // TODO: Remove this in v2 stable\n    if (legacy) convertOptions(options as PWAOptions & Record<string, unknown>);\n    checkVersion(app, PLUGIN_NAME, \"2.0.0-beta.66\");\n\n    if (app.env.isDebug) logger.info(\"Options:\", options);\n\n    const { base, shouldPrefetch = true } = app.options;\n\n    if (options.appendBase) appendBase(base, options);\n\n    if (shouldPrefetch === true)\n      logger.warn(\n        'The plugin will register service worker to handle assets, so we recommend you to set \"shouldPrefetch: false\" in VuePress config file.',\n      );\n\n    const manifest = getManifest(app, options);\n\n    app.options.head = injectLinksToHead(options, base, app.options.head);\n\n    useSassPalettePlugin(app, { id: \"hope\" });\n\n    return {\n      name: PLUGIN_NAME,\n\n      define: () => ({\n        PWA_LOCALES: getLocales({\n          app,\n          name: PLUGIN_NAME,\n          default: pwaLocales,\n          config: options.locales,\n        }),\n        SW_FORCE_UPDATE: options.update === \"force\",\n        SW_PATH: options.swPath || \"service-worker.js\",\n      }),\n\n      extendsBundlerOptions: (bundlerOptions: unknown, app): void => {\n        addViteOptimizeDepsExclude(bundlerOptions, app, [\n          \"mitt\",\n          \"register-service-worker\",\n        ]);\n\n        useCustomDevServer(bundlerOptions, app, {\n          path: \"/manifest.webmanifest\",\n          response: async (_, response) => {\n            response.setHeader(\"Content-Type\", \"application/manifest+json\");\n\n            return JSON.stringify(await manifest);\n          },\n          errMsg: \"Unexpected manifest generate error\",\n        });\n      },\n\n      onGenerated: async (app): Promise<void> => {\n        await generateManifest(app, manifest);\n        await generateServiceWorker(app, options);\n      },\n\n      clientConfigFile: (app) => prepareConfigFile(app, options),\n    };\n  };\n"],"names":["pwaLocales","__dirname","getDirname","CLIENT_FOLDER","ensureEndingSlash","path","PLUGIN_NAME","logger","Logger","deprecatedLogger","options","deprecatedOption","newOption","msg","scope","colors","keys","temp","key","index","convertOptions","getManifest","app","_a","_b","_c","dir","siteData","base","userManifestPath","userManifestJSONPath","optionManifest","userManifest","fs","getRootLang","generateManifest","manifest","manifestPath","imageFilter","outDir","maxSize","manifestEntries","warnings","imageExtensions","entry","ext","endsWith","stats","generateServiceWorker","dest","swDest","destDir","globPatterns","generateSW","count","size","warning","appendBaseHelper","link","isAbsoluteUrl","appendBaseToManifest","icon","shortcut","screenshot","appendBase","injectLinksToHead","head","metaKeys","linkKeys","item","fallBackIcon","setLink","rel","href","more","setMeta","name","content","icons","isPlainObject","prepareConfigFile","configImport","rootComponents","pwaPlugin","legacy","checkVersion","shouldPrefetch","useSassPalettePlugin","getLocales","bundlerOptions","addViteOptimizeDepsExclude","useCustomDevServer","_","response"],"mappings":"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"}