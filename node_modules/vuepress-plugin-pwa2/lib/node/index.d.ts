import { RequiredLocaleConfig } from 'vuepress-shared';
import { LocaleConfig, PluginFunction } from '@vuepress/core';
import { GenerateSWOptions } from 'workbox-build';

interface PWALocaleData {
    /**
     * Install button text
     *
     * 安装按钮文字
     */
    install: string;
    /**
     * iOS install hint text
     *
     * iOS 安装文字
     */
    iOSInstall: string;
    /**
     * Cancel button text
     *
     * 取消按钮文字
     */
    cancel: string;
    /**
     * Close button text
     *
     * 关闭按钮文字
     */
    close: string;
    /**
     * Previous image text
     *
     * 上一张图片文字
     */
    prevImage: string;
    /**
     * Next image text
     *
     * 下一张图片文字
     */
    nextImage: string;
    /**
     * Install explain text
     *
     * 安装解释
     */
    explain: string;
    /**
     * Description label text
     *
     * 描述标签文字
     */
    desc: string;
    /**
     * Feature label text
     *
     * 特性标签文字
     */
    feature: string;
    /**
     * Update hint text
     *
     * 提示有更新文字
     */
    hint: string;
    /**
     * Update available text
     *
     * 更新可用文字
     */
    update: string;
}
type PWALocaleConfig = RequiredLocaleConfig<PWALocaleData>;

/**
 * @see https://www.w3.org/TR/mediaqueries-5/#display-mode
 */
type DisplayMode = "fullscreen" | "standalone" | "minimal-ui" | "browser";
/**
 * @see https://github.com/w3c/manifest/wiki/Categories
 */
type ManifestCategory = "books" | "business" | "education" | "entertainment" | "finance" | "fitness" | "food" | "games" | "government" | "health" | "kids" | "lifestyle" | "magazines" | "medical" | "music" | "navigation" | "news" | "personalization" | "photo" | "politics" | "productivity" | "security" | "shopping" | "social" | "sports" | "travel" | "utilities" | "weather";
/**
 * @see https://www.w3.org/TR/screen-orientation/#dom-orientationlocktype
 */
type OrientationLockType = "any" | "natural" | "landscape" | "portrait" | "portrait-primary" | "portrait-secondary" | "landscape-primary" | "landscape-secondary";
/**
 * @see https://www.w3.org/TR/appmanifest/#manifest-image-resources
 */
interface ManifestImageResource {
    src: string;
    sizes: string;
    type?: string;
}
interface ManifestIcon extends ManifestImageResource {
    purpose?: "any" | "maskable" | "monochrome";
}
/**
 * @see https://www.w3.org/TR/appmanifest/#external-application-resource
 */
interface ManifestExternalApplicationResource {
    /**
     * @see https://github.com/w3c/manifest/wiki/Platforms
     */
    platform: "chrome_web_store" | "play" | "chromeos_play" | "itunes" | "webapp" | "windows" | "f-droid" | "amazon";
    url: string;
    id?: string;
    min_version?: string;
    fingerprints?: {
        type: string;
        value: string;
    }[];
}
/**
 * @see https://www.w3.org/TR/appmanifest/#shortcut-items
 */
interface ManifestShortCutItem {
    name: string;
    url: string;
    short_name?: string;
    description?: string;
    icons?: ManifestIcon[];
}
/**
 * @see https://www.w3.org/TR/appmanifest/
 */
interface ManifestOption extends Record<string, unknown> {
    /**
     * @see https://www.w3.org/TR/appmanifest/#name-member
     *
     * The name of the web application as it is usually displayed to the user
     */
    name?: string;
    /**
     * @see https://www.w3.org/TR/appmanifest/#short_name-member
     *
     * A short version of the name of the web application
     */
    short_name?: string;
    /**
     * @see https://www.w3.org/TR/appmanifest/#dfn-background_color
     *
     * The expected background color of the web application
     */
    background_color?: string;
    /**
     * @see https://www.w3.org/TR/appmanifest/#dir-member
     *
     * The base direction for the localizable members of the manifest.
     */
    dir?: "ltr" | "rtl" | "auto";
    /**
     * @see https://www.w3.org/TR/appmanifest/#lang-member
     *
     * specifies the primary language for the values of the manifest's localizable members
     */
    lang?: string;
    /**
     * @see https://www.w3.org/TR/appmanifest/#dfn-display
     *
     * The developer's preferred display mode for the web application
     */
    display?: DisplayMode;
    icons?: ManifestIcon[];
    /**
     * @see https://www.w3.org/TR/appmanifest/#orientation-member
     *
     * Serves as the default screen orientation for all top-level browsing contexts of the web application
     */
    orientation?: OrientationLockType;
    /**
     * @see https://www.w3.org/TR/appmanifest/#scope-member
     *
     * The navigation scope of this web application's application context.
     */
    scope?: string;
    /**
     * @see https://www.w3.org/TR/appmanifest/#start_url-member
     *
     * Start URL
     */
    start_url?: string;
    /**
     * @see https://www.w3.org/TR/appmanifest/#id-member
     *
     * Identity for the application
     */
    id?: string;
    /**
     * @see https://www.w3.org/TR/appmanifest/#theme_color-member
     *
     * Default theme color for an application context
     */
    theme_color?: string;
    shortcuts?: ManifestShortCutItem[];
    prefer_related_applications?: boolean;
    related_applications?: ManifestExternalApplicationResource[];
    description?: string;
    categories?: ManifestCategory[];
    screenshots?: ManifestImageResource[];
    iarc_rating_id?: string;
    features?: string[];
}

/** Multi language config for pwa popup */
declare const pwaLocales: PWALocaleConfig;

interface ApplePWAOptions {
    /**
     * Path of icon used on apple devices
     *
     * Recommend 152×152 size
     *
     * 苹果上使用的图标路径
     *
     * 推荐 152×152 大小
     */
    icon?: string;
    /**
     * Color of status bar
     *
     * 状态栏的颜色
     *
     * @default "black"
     */
    statusBarColor?: "black" | "white";
    /**
     * Safari mask icon
     *
     * Safari 图标
     */
    maskIcon?: string;
}
interface MicrosoftPWAOptions {
    /**
     * Microsoft tile image
     *
     * 144×144 transparent recommended
     *
     * 微软磁贴图片
     *
     * 推荐 144×144，透明
     */
    image?: string;
    /**
     * tile color
     *
     * 磁贴颜色
     */
    color?: string;
}
/** PWA 配置 */
interface PWAOptions {
    /**
     * Service Worker file path
     *
     * Service Worker 文件路径
     *
     * @default "service-worker.js"
     */
    swPath?: string;
    /**
     * manifest file Config
     *
     * manifest 文件设置
     */
    manifest?: ManifestOption;
    /**
     * Path of favicon
     *
     * favicon 地址
     */
    favicon?: string;
    /**
     * Theme Color
     *
     * 主题色
     *
     * @default "#46bd87"
     */
    themeColor?: string;
    /**
     * Max size which allows to cache, with KB unit
     *
     * 允许缓存的最大大小，单位 KB
     *
     * @default 2048
     */
    maxSize?: number;
    /**
     * Whether cache html files besides home page and 404
     *
     * 是否缓存除主页与 404 之外的 HTML
     *
     * @default false
     */
    cacheHTML?: boolean;
    /**
     * Whether cache pictures
     *
     * 是否缓存站点图片
     *
     * @default false
     */
    cachePic?: boolean;
    /**
     * Max size which allows to cache, with KB unit
     *
     * 图片允许缓存的最大大小，单位 KB
     *
     * @default 1024
     */
    maxPicSize?: number;
    /**
     * settings for apple
     *
     * 苹果设置
     */
    apple?: ApplePWAOptions | false;
    /**
     * Settings for Microsoft
     *
     * 微软设置
     */
    msTile?: MicrosoftPWAOptions | false;
    /**
     * Update logic
     *
     * - `"disabled"`: Do nothing even when new service worker is available. After new service work succeeds installing and starts waiting, it will control page and provide new content in next visit.
     * - `"available"`: Only display update popup when the new service worker is available
     * - `"hint"`: Display a hint to let user choose to refresh immediately. This is helpful when you want users to see new docs immediately.
     * - `"force"`: unregister current service worker immediately then refresh to get new content. **This may affect visiting experiences**！
     *
     * 更新逻辑
     *
     * - `"disabled"`: 即使有新的 service worker 也不做任何事情，新的 service work 开始等待后，会在用户下次访问时接管页面，让用户获得新内容。
     * - `"available"`: 仅当新的 service worker 可用时才显示更新弹出窗口
     * - `"hint"`: 显示更新内容可用提示，并允许用户立即刷新。当新的 SW 成功注册后，将转为更新内容就绪弹窗。当你希望用户立即查看新文档时，这很有帮助。
     * - `"force"`: 立即注销当前 Service Worker 然后刷新以获取新内容。**这可能会影响访问体验**!
     *
     * @default "available"
     */
    update?: "available" | "hint" | "force" | "disable";
    /**
     * A custom component to replace the default hint popup component.
     *
     * 用于替换默认提示弹出组件的自定义组件。
     *
     * @default "SWHintPopup"
     */
    hintComponent?: string;
    /**
     * A custom component to replace the default update popup component.
     *
     * 用于替换默认更新弹出组件的自定义组件。
     *
     * @default "SWUpdatePopup"
     */
    updateComponent?: string;
    /**
     * workbox-build’s [generateSW config](https://developers.google.com/web/tools/workbox/modules/workbox-build#full_generatesw_config)
     *
     */
    generateSWConfig?: Partial<GenerateSWOptions>;
    /**
     * Locales config
     *
     * 国际化配置
     */
    locales?: LocaleConfig<PWALocaleData>;
    /**
     * Whether append base to all absolute links
     *
     * 是否为所有绝对链接添加 base
     *
     * @default false
     */
    appendBase?: boolean;
}

declare const pwaPlugin: (options?: PWAOptions, legacy?: boolean) => PluginFunction;

export { DisplayMode, ManifestCategory, ManifestExternalApplicationResource, ManifestIcon, ManifestImageResource, ManifestOption, ManifestShortCutItem, OrientationLockType, PWALocaleConfig, PWALocaleData, PWAOptions, pwaLocales, pwaPlugin };
