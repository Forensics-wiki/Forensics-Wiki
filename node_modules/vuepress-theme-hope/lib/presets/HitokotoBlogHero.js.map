{"version":3,"file":"HitokotoBlogHero.js","sourceRoot":"","sources":["../../src/presets/HitokotoBlogHero.ts"],"names":[],"mappings":"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","sourcesContent":["import type { PropType, VNode } from \"vue\";\nimport {\n  defineComponent,\n  h,\n  nextTick,\n  onMounted,\n  onUnmounted,\n  ref,\n  watch,\n} from \"vue\";\n\nimport DropTransition from \"@theme-hope/components/transitions/DropTransition\";\n\nimport \"./hitokoto-blog-hero.scss\";\n\ninterface HitokotoResult {\n  id: string;\n  hitokoto: string;\n  type: \"a\" | \"b\" | \"c\" | \"d\" | \"e\" | \"f\" | \"g\" | \"h\" | \"i\" | \"j\" | \"k\" | \"l\";\n  from: string;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  front_who: string;\n  creator: string;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  creator_uid: string;\n  reviewer: string;\n  uid: string;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  commit_from: string;\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n  created_at: string;\n  length: string;\n}\n\nexport default defineComponent({\n  name: \"HitokotoBlogHero\",\n\n  props: {\n    /** Hero text */\n    text: {\n      type: String,\n      required: true,\n    },\n\n    /** Hero image */\n    image: { type: String, default: null },\n\n    /** Hero image dark */\n    imageDark: { type: String, default: null },\n\n    /** Hero image alt */\n    alt: { type: String, required: true },\n\n    /** Hero image style */\n    heroStyle: {\n      type: [String, Object] as PropType<string | Record<string, string>>,\n      default: null,\n    },\n  },\n\n  setup(props) {\n    const text = ref(\"\");\n    const display = ref(\"\");\n    const author = ref(\"\");\n    let isMounted = false;\n\n    const getHitokoto = (): Promise<void> =>\n      fetch(\"https://v1.hitokoto.cn\")\n        .then((res) => <Promise<HitokotoResult>>res.json())\n        .then(({ from, hitokoto }) => {\n          text.value = hitokoto;\n          author.value = from;\n        });\n\n    onMounted(() => {\n      isMounted = true;\n\n      watch(text, () => {\n        display.value = \"\";\n        let index = 0;\n\n        const renderNextWord = (): Promise<void> => {\n          display.value += text.value[index];\n          index++;\n\n          return nextTick().then(() => {\n            if (index < text.value.length)\n              setTimeout(() => {\n                void renderNextWord();\n              }, 150);\n            else if (isMounted)\n              setTimeout(() => {\n                void getHitokoto();\n              }, 3000);\n          });\n        };\n\n        void renderNextWord();\n      });\n\n      void getHitokoto();\n    });\n\n    onUnmounted(() => {\n      isMounted = false;\n    });\n\n    return (): VNode[] => [\n      h(DropTransition, { appear: true, type: \"group\", delay: 0.04 }, () => [\n        props.image\n          ? h(\"img\", {\n              key: \"light\",\n              class: [\"vp-blog-hero-image\", { light: props.imageDark }],\n              style: props.heroStyle,\n              src: props.image,\n              alt: props.alt,\n            })\n          : null,\n        props.imageDark\n          ? h(\"img\", {\n              key: \"dark\",\n              class: \"vp-blog-hero-image dark\",\n              style: props.heroStyle,\n              src: props.imageDark,\n              alt: props.alt,\n            })\n          : null,\n      ]),\n      h(DropTransition, { appear: true, delay: 0.08 }, () =>\n        props.text\n          ? h(\"h1\", { class: \"vp-blog-hero-title\" }, props.text)\n          : null,\n      ),\n      h(\"div\", { class: \"hitokoto\" }, [\n        h(\"p\", { class: \"hitokoto-text\" }, h(\"span\", display.value)),\n        h(\n          \"p\",\n          {\n            class: \"hitokoto-author\",\n            style: { opacity: display.value.length > 4 ? 1 : 0 },\n          },\n          `——「${author.value}」`,\n        ),\n      ]),\n    ];\n  },\n});\n"]}