{"version":3,"file":"config.js","sourceRoot":"","sources":["../../../src/node/prepare/config.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,iBAAiB,EAAE,MAAM,kBAAkB,CAAC;AACrD,OAAO,EAAE,UAAU,EAAE,IAAI,EAAE,MAAM,iBAAiB,CAAC;AAMnD,MAAM,SAAS,GAAG,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;AAC9C,MAAM,aAAa,GAAG,iBAAiB,CACrC,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,cAAc,CAAC,CACxC,CAAC;AAEF,MAAM,CAAC,MAAM,iBAAiB,GAAG,CAC/B,GAAQ,EACR,OAAgC,EAChC,EAAE,UAAU,EAAE,aAAa,EAAe,EACzB,EAAE;IACnB,IAAI,YAAY,GAAG,EAAE,CAAC;IACtB,IAAI,OAAO,GAAG,EAAE,CAAC;IACjB,IAAI,KAAK,GAAG,EAAE,CAAC;IACf,IAAI,MAAM,GAAG,EAAE,CAAC;IAEhB,IAAI,UAAU,EAAE;QACd,YAAY,IAAI;;;;;UAKV,aAAa;CACtB,CAAC;QAEE,OAAO,IAAI;;;;CAId,CAAC;QAEE,KAAK,IAAI;;CAEZ,CAAC;KACC;IAED,IAAI,aAAa,EAAE;QACjB,YAAY,IAAI;;;CAGnB,CAAC;QACE,OAAO,IAAI;;;CAGd,CAAC;KACC;IAED,IAAI,OAAO,CAAC,SAAS,IAAI,OAAO,CAAC,SAAS,CAAC,YAAY,EAAE;QACvD,YAAY,IAAI,sBAAsB,aAAa,sBAAsB,CAAC;QAC1E,MAAM,IAAI,UAAU,CAAC;KACtB;IAED,IAAI,OAAO,CAAC,IAAI,EAAE;QAChB,YAAY,IAAI,qBAAqB,aAAa,kCAAkC,CAAC;QACrF,MAAM,IAAI,SAAS,CAAC;KACrB;IAED,OAAO,GAAG,CAAC,SAAS,CAClB,sBAAsB,EACtB;;;;;;;sBAOkB,aAAa;wBACX,aAAa;;;;;;UAM3B,aAAa;;EAErB,YAAY;;;;;;;;;;;;;;;;;;;;;;EAsBZ,OAAO;SACN,KAAK,CAAC,IAAI,CAAC;SACX,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,OAAO,IAAI,EAAE,CAAC;SAC5B,IAAI,CAAC,IAAI,CAAC;;;;;EAKX,KAAK;SACJ,KAAK,CAAC,IAAI,CAAC;SACX,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,OAAO,IAAI,EAAE,CAAC;SAC5B,IAAI,CAAC,IAAI,CAAC;;;;;EAKX,MAAM;SACL,KAAK,CAAC,IAAI,CAAC;SACX,GAAG,CAAC,CAAC,IAAI,EAAE,EAAE,CAAC,OAAO,IAAI,EAAE,CAAC;SAC5B,IAAI,CAAC,IAAI,CAAC;;IAET,CACD,CAAC;AACJ,CAAC,CAAC","sourcesContent":["import { ensureEndingSlash } from \"@vuepress/shared\";\nimport { getDirname, path } from \"@vuepress/utils\";\n\nimport type { App } from \"@vuepress/core\";\nimport type { ThemeStatus } from \"../status.js\";\nimport type { HopeThemePluginsOptions } from \"../../shared/index.js\";\n\nconst __dirname = getDirname(import.meta.url);\nconst CLIENT_FOLDER = ensureEndingSlash(\n  path.resolve(__dirname, \"../../client\")\n);\n\nexport const prepareConfigFile = (\n  app: App,\n  plugins: HopeThemePluginsOptions,\n  { enableBlog, enableEncrypt }: ThemeStatus\n): Promise<string> => {\n  let configImport = \"\";\n  let enhance = \"\";\n  let setup = \"\";\n  let layout = \"\";\n\n  if (enableBlog) {\n    configImport += `\\\nimport BloggerInfo from \"@theme-hope/modules/blog/components/BloggerInfo.js\";\nimport BlogHome from \"@theme-hope/modules/blog/components/BlogHome.js\";\nimport BlogPage from \"@theme-hope/modules/blog/components/BlogPage.js\";\nimport { setupBlog } from \"@theme-hope/modules/blog/composables/index.js\";\nimport \"${CLIENT_FOLDER}modules/blog/styles/layout.scss\";\n`;\n\n    enhance += `\\\napp.component(\"BloggerInfo\", BloggerInfo);\napp.component(\"BlogHome\", BlogHome);\napp.component(\"BlogPage\", BlogPage);\n`;\n\n    setup += `\\\nsetupBlog();\n`;\n  }\n\n  if (enableEncrypt) {\n    configImport += `\\\nimport GlobalEncrypt from \"@theme-hope/modules/encrypt/components/GlobalEncrypt.js\";\nimport LocalEncrypt from \"@theme-hope/modules/encrypt/components/LocalEncrypt.js\";\n`;\n    enhance += `\\\napp.component(\"GlobalEncrypt\", GlobalEncrypt);\napp.component(\"LocalEncrypt\", LocalEncrypt);\n`;\n  }\n\n  if (plugins.mdEnhance && plugins.mdEnhance.presentation) {\n    configImport += `import Slide from \"${CLIENT_FOLDER}layouts/Slide.js\";\\n`;\n    layout += \"Slide,\\n\";\n  }\n\n  if (plugins.blog) {\n    configImport += `import Blog from \"${CLIENT_FOLDER}modules/blog/layouts/Blog.js\";\\n`;\n    layout += \"Blog,\\n\";\n  }\n\n  return app.writeTemp(\n    `theme-hope/config.js`,\n    `import { defineClientConfig } from \"@vuepress/client\";\n\nimport CommonWrapper from \"@theme-hope/components/CommonWrapper.js\";\nimport HomePage from \"@theme-hope/components/HomePage.js\";\nimport NormalPage from \"@theme-hope/components/NormalPage.js\";\nimport Navbar from \"@theme-hope/modules/navbar/components/Navbar.js\";\nimport Sidebar from \"@theme-hope/modules/sidebar/components/Sidebar.js\";\nimport Layout from \"${CLIENT_FOLDER}layouts/Layout.js\";\nimport NotFound from \"${CLIENT_FOLDER}layouts/NotFound.js\";\n\nimport { useScrollPromise } from \"@theme-hope/composables/index.js\";\nimport { injectDarkMode, setupDarkMode } from \"@theme-hope/modules/outlook/composables/index.js\";\nimport { setupSidebarItems } from \"@theme-hope/modules/sidebar/composables/index.js\";\n\nimport \"${CLIENT_FOLDER}styles/index.scss\";\n\n${configImport}\n\nexport default defineClientConfig({\n  enhance: ({ app, router }) => {\n    const { scrollBehavior } = router.options;\n\n    router.options.scrollBehavior = async (...args) => {\n      await useScrollPromise().wait();\n\n      return scrollBehavior(...args);\n    };\n\n    // inject global properties\n    injectDarkMode(app);\n\n    // register to inject styles\n    app.component(\"CommonWrapper\", CommonWrapper);\n    app.component(\"HomePage\", HomePage);\n    app.component(\"NormalPage\", NormalPage);\n    app.component(\"Navbar\", Navbar);\n    app.component(\"Sidebar\", Sidebar);\n\n${enhance\n  .split(\"\\n\")\n  .map((item) => `    ${item}`)\n  .join(\"\\n\")}\n  },\n  setup: () => {\n    setupDarkMode();\n    setupSidebarItems();\n${setup\n  .split(\"\\n\")\n  .map((item) => `    ${item}`)\n  .join(\"\\n\")}\n  },\n  layouts: {\n    Layout,\n    NotFound,\n${layout\n  .split(\"\\n\")\n  .map((item) => `    ${item}`)\n  .join(\"\\n\")}\n  }\n});`\n  );\n};\n"]}