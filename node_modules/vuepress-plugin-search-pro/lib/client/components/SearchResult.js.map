{"version":3,"file":"SearchResult.js","sources":["../../../src/client/composables/queryHistory.ts","../../../src/client/composables/resultHistory.ts","../../../src/client/composables/search.ts","../../../src/client/components/SearchResult.ts"],"sourcesContent":["import { useLocalStorage } from \"@vueuse/core\";\nimport type { Ref } from \"vue\";\n\nimport { searchProOptions } from \"../define.js\";\n\nconst SEARCH_PRO_HISTORY_QUERY_STORAGE = \"SEARCH_PRO_QUERY_HISTORY\";\n\nexport interface SearchQueryHistory {\n  enabled: boolean;\n  queryHistory: Ref<string[]>;\n  addQueryHistory: (item: string) => void;\n  removeQueryHistory: (index: number) => void;\n}\n\nconst searchProQueryStorage = useLocalStorage<string[]>(\n  SEARCH_PRO_HISTORY_QUERY_STORAGE,\n  [],\n);\n\nexport const useSearchQueryHistory = (): SearchQueryHistory => {\n  const { queryHistoryCount } = searchProOptions;\n  const enabled = queryHistoryCount > 0;\n\n  const addQueryHistory = (item: string): void => {\n    if (enabled)\n      if (searchProQueryStorage.value.length < queryHistoryCount)\n        searchProQueryStorage.value = Array.from(\n          new Set([item, ...searchProQueryStorage.value]),\n        );\n      else\n        searchProQueryStorage.value = Array.from(\n          new Set([\n            item,\n            ...searchProQueryStorage.value.slice(0, queryHistoryCount - 1),\n          ]),\n        );\n  };\n\n  const removeQueryHistory = (index: number): void => {\n    searchProQueryStorage.value = [\n      ...searchProQueryStorage.value.slice(0, index),\n      ...searchProQueryStorage.value.slice(index + 1),\n    ];\n  };\n\n  return {\n    enabled,\n    queryHistory: searchProQueryStorage,\n    addQueryHistory,\n    removeQueryHistory,\n  };\n};\n","import { useLocalStorage } from \"@vueuse/core\";\nimport type { Ref } from \"vue\";\nimport { useRouter } from \"vue-router\";\n\nimport { searchProOptions } from \"../define.js\";\nimport type { MatchedItem, Word } from \"../typings/index.js\";\n\nconst SEARCH_PRO_HISTORY_RESULT_STORAGE = \"SEARCH_PRO_RESULT_HISTORY\";\n\nexport interface SearchResult {\n  header?: string;\n  link: string;\n  display: Word[][];\n}\n\nexport interface SearchResultHistory {\n  enabled: boolean;\n  resultHistory: Ref<SearchResult[]>;\n  addResultHistory: (item: MatchedItem) => void;\n  removeResultHistory: (index: number) => void;\n}\n\nconst { resultHistoryCount } = searchProOptions;\n\nconst searchProResultStorage = useLocalStorage<SearchResult[]>(\n  SEARCH_PRO_HISTORY_RESULT_STORAGE,\n  [],\n);\n\nexport const useSearchResultHistory = (): SearchResultHistory => {\n  const router = useRouter();\n\n  const enabled = resultHistoryCount > 0;\n\n  const getRealPath = (item: MatchedItem): string =>\n    router.resolve({\n      name: item.key,\n      ...(\"anchor\" in item ? { hash: `#${item.anchor}` } : {}),\n    }).fullPath;\n\n  const addResultHistory = (item: MatchedItem): void => {\n    if (enabled) {\n      const result: SearchResult = {\n        link: getRealPath(item),\n        display: item.display,\n      };\n\n      if (\"header\" in item) result.header = item.header;\n      if (searchProResultStorage.value.length < resultHistoryCount)\n        searchProResultStorage.value = [\n          result,\n          ...searchProResultStorage.value,\n        ];\n      else\n        searchProResultStorage.value = [\n          result,\n          ...searchProResultStorage.value.slice(0, resultHistoryCount - 1),\n        ];\n    }\n  };\n\n  const removeResultHistory = (index: number): void => {\n    searchProResultStorage.value = [\n      ...searchProResultStorage.value.slice(0, index),\n      ...searchProResultStorage.value.slice(index + 1),\n    ];\n  };\n\n  return {\n    enabled,\n    resultHistory: searchProResultStorage,\n    addResultHistory,\n    removeResultHistory,\n  };\n};\n","import { useRouteLocale } from \"@vuepress/client\";\nimport { useDebounceFn } from \"@vueuse/core\";\nimport type { Ref } from \"vue\";\nimport { onMounted, onUnmounted, ref, shallowRef, watch } from \"vue\";\n\nimport { searchProOptions } from \"../define.js\";\nimport { useSearchOptions } from \"../helpers/index.js\";\nimport type { SearchResult } from \"../typings/index.js\";\nimport { createSearchWorker } from \"../utils/index.js\";\n\nexport interface SearchRef {\n  searching: Ref<boolean>;\n  results: Ref<SearchResult[]>;\n}\n\nexport const useSearchResult = (query: Ref<string>): SearchRef => {\n  const searchOptions = useSearchOptions();\n  const routeLocale = useRouteLocale();\n  const { search, terminate } = createSearchWorker();\n\n  const searching = ref(false);\n  const results = shallowRef<SearchResult[]>([]);\n\n  onMounted(() => {\n    const endSearch = (): void => {\n      results.value = [];\n      searching.value = false;\n    };\n\n    const performSearch = useDebounceFn((queryString: string): void => {\n      searching.value = true;\n\n      if (queryString)\n        void search({\n          type: \"search\",\n          query: queryString,\n          locale: routeLocale.value,\n          options: searchOptions,\n        })\n          .then((searchResults) => {\n            results.value = searchResults;\n            searching.value = false;\n          })\n          .catch((err) => {\n            console.error(err);\n            endSearch();\n          });\n      else endSearch();\n    }, searchProOptions.searchDelay);\n\n    watch([query, routeLocale], () => performSearch(query.value), {\n      immediate: true,\n    });\n\n    onUnmounted(() => {\n      terminate();\n    });\n  });\n\n  return {\n    searching,\n    results,\n  };\n};\n","import { useRouteLocale } from \"@vuepress/client\";\nimport { isPlainObject, isString } from \"@vuepress/shared\";\nimport { useEventListener } from \"@vueuse/core\";\nimport type { VNode } from \"vue\";\nimport { computed, defineComponent, h, ref, toRef, watch } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport { VPLink, useLocaleConfig } from \"vuepress-shared/client\";\n\nimport { SearchLoading } from \"./SearchLoading.js\";\nimport { HeadingIcon, HeartIcon, HistoryIcon, TitleIcon } from \"./icons.js\";\nimport {\n  useSearchQueryHistory,\n  useSearchResult,\n  useSearchResultHistory,\n} from \"../composables/index.js\";\nimport {\n  searchProClientCustomFiledConfig,\n  searchProLocales,\n} from \"../define.js\";\nimport type { MatchedItem, Word } from \"../typings/index.js\";\nimport { CLOSE_ICON } from \"../utils/index.js\";\n\nimport \"../styles/search-result.scss\";\n\nexport default defineComponent({\n  name: \"SearchResult\",\n\n  props: {\n    /**\n     * Query string\n     *\n     * 查询字符串\n     */\n    query: {\n      type: String,\n      required: true,\n    },\n\n    /**\n     * Whether is focusing\n     *\n     * 是否被聚焦\n     */\n    isFocusing: Boolean,\n  },\n\n  emits: [\"close\", \"updateQuery\"],\n\n  setup(props, { emit }) {\n    const router = useRouter();\n    const routeLocale = useRouteLocale();\n    const locale = useLocaleConfig(searchProLocales);\n    const {\n      enabled: enableQueryHistory,\n      addQueryHistory,\n      queryHistory,\n      removeQueryHistory,\n    } = useSearchQueryHistory();\n    const {\n      enabled: enableResultHistory,\n      resultHistory,\n      addResultHistory,\n      removeResultHistory,\n    } = useSearchResultHistory();\n    const enableHistory = enableQueryHistory || enableResultHistory;\n\n    const query = toRef(props, \"query\");\n    const { results, searching } = useSearchResult(query);\n\n    const activatedHistoryStatus = ref({ isQuery: true, index: 0 });\n    const activatedResultIndex = ref(0);\n    const activatedResultContentIndex = ref(0);\n\n    const hasHistory = computed(\n      () =>\n        enableHistory &&\n        (queryHistory.value.length > 0 || resultHistory.value.length > 0),\n    );\n    const hasResults = computed(() => results.value.length > 0);\n    const activatedResult = computed(\n      () => results.value[activatedResultIndex.value] || null,\n    );\n\n    const getRealPath = (item: MatchedItem): string =>\n      router.resolve({\n        name: item.key,\n        ...(\"anchor\" in item ? { hash: `#${item.anchor}` } : {}),\n      }).fullPath;\n\n    const activePreviousHistory = (): void => {\n      const { isQuery, index } = activatedHistoryStatus.value;\n\n      if (index === 0)\n        activatedHistoryStatus.value = {\n          isQuery: !isQuery,\n          index: isQuery\n            ? resultHistory.value.length - 1\n            : queryHistory.value.length - 1,\n        };\n      else\n        activatedHistoryStatus.value = {\n          isQuery,\n          index: index - 1,\n        };\n    };\n\n    const activeNextHistory = (): void => {\n      const { isQuery, index } = activatedHistoryStatus.value;\n\n      if (\n        index ===\n        (isQuery\n          ? queryHistory.value.length - 1\n          : resultHistory.value.length - 1)\n      )\n        activatedHistoryStatus.value = {\n          isQuery: !isQuery,\n          index: 0,\n        };\n      else\n        activatedHistoryStatus.value = {\n          isQuery,\n          index: index + 1,\n        };\n    };\n\n    const activePreviousResult = (): void => {\n      activatedResultIndex.value =\n        activatedResultIndex.value > 0\n          ? activatedResultIndex.value - 1\n          : results.value.length - 1;\n      activatedResultContentIndex.value =\n        activatedResult.value.contents.length - 1;\n    };\n\n    const activeNextResult = (): void => {\n      activatedResultIndex.value =\n        activatedResultIndex.value < results.value.length - 1\n          ? activatedResultIndex.value + 1\n          : 0;\n      activatedResultContentIndex.value = 0;\n    };\n\n    const activeNextResultContent = (): void => {\n      if (\n        activatedResultContentIndex.value <\n        activatedResult.value.contents.length - 1\n      )\n        activatedResultContentIndex.value =\n          activatedResultContentIndex.value + 1;\n      else activeNextResult();\n    };\n\n    const activePreviousResultContent = (): void => {\n      if (activatedResultContentIndex.value > 0)\n        activatedResultContentIndex.value =\n          activatedResultContentIndex.value - 1;\n      else activePreviousResult();\n    };\n\n    const getVNodes = (display: Word[]): (VNode | string)[] =>\n      display.map((word) => (isString(word) ? word : h(word[0], word[1])));\n\n    const getDisplay = (matchedItem: MatchedItem): (VNode | string)[] => {\n      if (matchedItem.type === \"customField\") {\n        const formatterConfig =\n          searchProClientCustomFiledConfig[matchedItem.index] || \"$content\";\n\n        const [prefix, suffix = \"\"] = isPlainObject(formatterConfig)\n          ? formatterConfig[routeLocale.value].split(\"$content\")\n          : formatterConfig.split(\"$content\");\n\n        return matchedItem.display.map((display) =>\n          h(\"div\", getVNodes([prefix, ...display, suffix])),\n        );\n      }\n\n      return matchedItem.display.map((display) => h(\"div\", getVNodes(display)));\n    };\n\n    const resetSearchResult = (): void => {\n      activatedResultIndex.value = 0;\n      activatedResultContentIndex.value = 0;\n      emit(\"updateQuery\", \"\");\n      emit(\"close\");\n    };\n\n    useEventListener(\"keydown\", (event: KeyboardEvent) => {\n      if (!props.isFocusing) return;\n\n      if (hasResults.value) {\n        if (event.key === \"ArrowUp\") {\n          activePreviousResultContent();\n        } else if (event.key === \"ArrowDown\") {\n          activeNextResultContent();\n        } else if (event.key === \"Enter\") {\n          const item =\n            activatedResult.value.contents[activatedResultContentIndex.value];\n\n          const path = getRealPath(item);\n\n          addQueryHistory(props.query);\n          addResultHistory(item);\n          void router.push(path);\n          resetSearchResult();\n        }\n      } else if (enableResultHistory) {\n        if (event.key === \"ArrowUp\") {\n          activePreviousHistory();\n        } else if (event.key === \"ArrowDown\") {\n          activeNextHistory();\n        } else if (event.key === \"Enter\") {\n          const { index } = activatedHistoryStatus.value;\n\n          if (activatedHistoryStatus.value.isQuery) {\n            emit(\"updateQuery\", queryHistory.value[index]);\n            event.preventDefault();\n          } else {\n            void router.push(resultHistory.value[index].link);\n            resetSearchResult();\n          }\n        }\n      }\n    });\n\n    watch(\n      [activatedResultIndex, activatedResultContentIndex],\n      () => {\n        document\n          .querySelector(\n            \".search-pro-result-list-item.active .search-pro-result-item.active\",\n          )\n          ?.scrollIntoView(false);\n      },\n      { flush: \"post\" },\n    );\n\n    return (): VNode =>\n      h(\n        \"div\",\n        {\n          class: [\n            \"search-pro-result-wrapper\",\n            { empty: query.value ? !hasResults.value : !hasHistory.value },\n          ],\n          id: \"search-pro-results\",\n        },\n        query.value === \"\"\n          ? enableHistory\n            ? hasHistory.value\n              ? [\n                  enableQueryHistory\n                    ? h(\n                        \"ul\",\n                        { class: \"search-pro-result-list\" },\n                        h(\"li\", { class: \"search-pro-result-list-item\" }, [\n                          h(\n                            \"div\",\n                            { class: \"search-pro-result-title\" },\n                            locale.value.history,\n                          ),\n                          queryHistory.value.map((item, historyIndex) =>\n                            h(\n                              \"div\",\n                              {\n                                class: [\n                                  \"search-pro-result-item\",\n                                  {\n                                    active:\n                                      activatedHistoryStatus.value.isQuery &&\n                                      activatedHistoryStatus.value.index ===\n                                        historyIndex,\n                                  },\n                                ],\n                                onClick: () => {\n                                  emit(\"updateQuery\", item);\n                                },\n                              },\n                              [\n                                h(HistoryIcon, {\n                                  class: \"search-pro-result-type\",\n                                }),\n                                h(\n                                  \"div\",\n                                  { class: \"search-pro-result-content\" },\n                                  item,\n                                ),\n                                h(\"button\", {\n                                  class: \"search-pro-remove-icon\",\n                                  innerHTML: CLOSE_ICON,\n                                  onClick: (event: Event) => {\n                                    event.preventDefault();\n                                    event.stopPropagation();\n                                    removeQueryHistory(historyIndex);\n                                  },\n                                }),\n                              ],\n                            ),\n                          ),\n                        ]),\n                      )\n                    : null,\n                  enableResultHistory\n                    ? h(\n                        \"ul\",\n                        { class: \"search-pro-result-list\" },\n                        h(\"li\", { class: \"search-pro-result-list-item\" }, [\n                          h(\n                            \"div\",\n                            { class: \"search-pro-result-title\" },\n                            locale.value.history,\n                          ),\n\n                          resultHistory.value.map((item, historyIndex) =>\n                            h(\n                              VPLink,\n                              {\n                                to: item.link,\n                                class: [\n                                  \"search-pro-result-item\",\n                                  {\n                                    active:\n                                      !activatedHistoryStatus.value.isQuery &&\n                                      activatedHistoryStatus.value.index ===\n                                        historyIndex,\n                                  },\n                                ],\n                                onClick: () => {\n                                  resetSearchResult();\n                                },\n                              },\n                              () => [\n                                h(HistoryIcon, {\n                                  class: \"search-pro-result-type\",\n                                }),\n                                h(\n                                  \"div\",\n                                  { class: \"search-pro-result-content\" },\n                                  [\n                                    item.header\n                                      ? h(\n                                          \"div\",\n                                          { class: \"content-header\" },\n                                          item.header,\n                                        )\n                                      : null,\n                                    h(\n                                      \"div\",\n                                      item.display\n                                        .map((display) => getVNodes(display))\n                                        .flat(),\n                                    ),\n                                  ],\n                                ),\n                                h(\"button\", {\n                                  class: \"search-pro-remove-icon\",\n                                  innerHTML: CLOSE_ICON,\n                                  onClick: (event: Event) => {\n                                    event.preventDefault();\n                                    event.stopPropagation();\n                                    removeResultHistory(historyIndex);\n                                  },\n                                }),\n                              ],\n                            ),\n                          ),\n                        ]),\n                      )\n                    : null,\n                ]\n              : locale.value.emptyHistory\n            : locale.value.emptyResult\n          : searching.value\n          ? h(SearchLoading, { hint: locale.value.searching })\n          : hasResults.value\n          ? h(\n              \"ul\",\n              { class: \"search-pro-result-list\" },\n              results.value.map(({ title, contents }, index) => {\n                const isCurrentResultActive =\n                  activatedResultIndex.value === index;\n\n                return h(\n                  \"li\",\n                  {\n                    class: [\n                      \"search-pro-result-list-item\",\n                      { active: isCurrentResultActive },\n                    ],\n                  },\n                  [\n                    h(\n                      \"div\",\n                      { class: \"search-pro-result-title\" },\n                      title || locale.value.defaultTitle,\n                    ),\n                    contents.map((item, contentIndex) => {\n                      const isCurrentContentActive =\n                        isCurrentResultActive &&\n                        activatedResultContentIndex.value === contentIndex;\n\n                      return h(\n                        VPLink,\n                        {\n                          to: getRealPath(item),\n                          class: [\n                            \"search-pro-result-item\",\n                            {\n                              active: isCurrentContentActive,\n                              \"aria-selected\": isCurrentContentActive,\n                            },\n                          ],\n                          onClick: () => {\n                            addQueryHistory(props.query);\n                            addResultHistory(item);\n                            resetSearchResult();\n                          },\n                        },\n                        () => [\n                          item.type === \"text\"\n                            ? null\n                            : h(\n                                item.type === \"title\"\n                                  ? TitleIcon\n                                  : item.type === \"heading\"\n                                  ? HeadingIcon\n                                  : HeartIcon,\n                                { class: \"search-pro-result-type\" },\n                              ),\n                          h(\"div\", { class: \"search-pro-result-content\" }, [\n                            item.type === \"text\" && item.header\n                              ? h(\n                                  \"div\",\n                                  { class: \"content-header\" },\n                                  item.header,\n                                )\n                              : null,\n                            h(\"div\", getDisplay(item)),\n                          ]),\n                        ],\n                      );\n                    }),\n                  ],\n                );\n              }),\n            )\n          : locale.value.emptyResult,\n      );\n  },\n});\n"],"names":["SEARCH_PRO_HISTORY_QUERY_STORAGE","searchProQueryStorage","useLocalStorage","useSearchQueryHistory","queryHistoryCount","searchProOptions","enabled","item","index","SEARCH_PRO_HISTORY_RESULT_STORAGE","resultHistoryCount","searchProResultStorage","useSearchResultHistory","router","useRouter","getRealPath","result","useSearchResult","query","searchOptions","useSearchOptions","routeLocale","useRouteLocale","search","terminate","createSearchWorker","searching","ref","results","shallowRef","onMounted","endSearch","performSearch","useDebounceFn","queryString","searchResults","err","watch","onUnmounted","defineComponent","props","emit","locale","useLocaleConfig","searchProLocales","enableQueryHistory","addQueryHistory","queryHistory","removeQueryHistory","enableResultHistory","resultHistory","addResultHistory","removeResultHistory","enableHistory","toRef","activatedHistoryStatus","activatedResultIndex","activatedResultContentIndex","hasHistory","computed","hasResults","activatedResult","activePreviousHistory","isQuery","activeNextHistory","activePreviousResult","activeNextResult","activeNextResultContent","activePreviousResultContent","getVNodes","display","word","isString","h","getDisplay","matchedItem","formatterConfig","searchProClientCustomFiledConfig","prefix","suffix","isPlainObject","resetSearchResult","useEventListener","event","path","_a","historyIndex","HistoryIcon","CLOSE_ICON","VPLink","SearchLoading","title","contents","isCurrentResultActive","contentIndex","isCurrentContentActive","TitleIcon","HeadingIcon","HeartIcon"],"mappings":"2oBAKA,MAAMA,GAAmC,2BASnCC,EAAwBC,EAC5BF,GACA,CACF,CAAA,EAEaG,GAAwB,IAA0B,CAC7D,KAAM,CAAE,kBAAAC,CAAkB,EAAIC,EACxBC,EAAUF,EAAoB,EAwBpC,MAAO,CACL,QAAAE,EACA,aAAcL,EACd,gBAzBuBM,GAAuB,CAC1CD,IACEL,EAAsB,MAAM,OAASG,EACvCH,EAAsB,MAAQ,MAAM,KAClC,IAAI,IAAI,CAACM,EAAM,GAAGN,EAAsB,KAAK,CAAC,CAChD,EAEAA,EAAsB,MAAQ,MAAM,KAClC,IAAI,IAAI,CACNM,EACA,GAAGN,EAAsB,MAAM,MAAM,EAAGG,EAAoB,CAAC,CAC/D,CAAC,CACH,EACN,EAaE,mBAX0BI,GAAwB,CAClDP,EAAsB,MAAQ,CAC5B,GAAGA,EAAsB,MAAM,MAAM,EAAGO,CAAK,EAC7C,GAAGP,EAAsB,MAAM,MAAMO,EAAQ,CAAC,CAChD,CACF,CAOA,CACF,EC5CMC,GAAoC,4BAepC,CAAE,mBAAAC,CAAmB,EAAIL,EAEzBM,EAAyBT,EAC7BO,GACA,CACF,CAAA,EAEaG,GAAyB,IAA2B,CAC/D,MAAMC,EAASC,IAETR,EAAUI,EAAqB,EAE/BK,EAAeR,GACnBM,EAAO,QAAQ,CACb,KAAMN,EAAK,IACX,GAAI,WAAYA,EAAO,CAAE,KAAM,IAAIA,EAAK,MAAM,EAAG,EAAI,CACvD,CAAA,CAAC,EAAE,SA8BL,MAAO,CACL,QAAAD,EACA,cAAeK,EACf,iBA/BwBJ,GAA4B,CACpD,GAAID,EAAS,CACX,MAAMU,EAAuB,CAC3B,KAAMD,EAAYR,CAAI,EACtB,QAASA,EAAK,OAChB,EAEI,WAAYA,IAAMS,EAAO,OAAST,EAAK,QACvCI,EAAuB,MAAM,OAASD,EACxCC,EAAuB,MAAQ,CAC7BK,EACA,GAAGL,EAAuB,KAC5B,EAEAA,EAAuB,MAAQ,CAC7BK,EACA,GAAGL,EAAuB,MAAM,MAAM,EAAGD,EAAqB,CAAC,CACjE,CACJ,CACF,EAaE,oBAX2BF,GAAwB,CACnDG,EAAuB,MAAQ,CAC7B,GAAGA,EAAuB,MAAM,MAAM,EAAGH,CAAK,EAC9C,GAAGG,EAAuB,MAAM,MAAMH,EAAQ,CAAC,CACjD,CACF,CAOA,CACF,EC3DaS,GAAmBC,GAAkC,CAChE,MAAMC,EAAgBC,GAAiB,EACjCC,EAAcC,EACd,EAAA,CAAE,OAAAC,EAAQ,UAAAC,CAAU,EAAIC,GAExBC,EAAAA,EAAYC,EAAI,EAAK,EACrBC,EAAUC,GAA2B,EAAE,EAE7C,OAAAC,GAAU,IAAM,CACd,MAAMC,EAAY,IAAY,CAC5BH,EAAQ,MAAQ,CAAC,EACjBF,EAAU,MAAQ,EACpB,EAEMM,EAAgBC,GAAeC,GAA8B,CACjER,EAAU,MAAQ,GAEdQ,EACGX,EAAO,CACV,KAAM,SACN,MAAOW,EACP,OAAQb,EAAY,MACpB,QAASF,CACX,CAAC,EACE,KAAMgB,GAAkB,CACvBP,EAAQ,MAAQO,EAChBT,EAAU,MAAQ,EACpB,CAAC,EACA,MAAOU,GAAQ,CACd,QAAQ,MAAMA,CAAG,EACjBL,EAAAA,CACF,CAAC,EACAA,EAAU,CACjB,EAAG1B,EAAiB,WAAW,EAE/BgC,EAAM,CAACnB,EAAOG,CAAW,EAAG,IAAMW,EAAcd,EAAM,KAAK,EAAG,CAC5D,UAAW,EACb,CAAC,EAEDoB,GAAY,IAAM,CAChBd,EACF,CAAA,CAAC,CACH,CAAC,EAEM,CACL,UAAAE,EACA,QAAAE,CACF,CACF,ECvCA,IAAeW,GAAAA,GAAgB,CAC7B,KAAM,eAEN,MAAO,CAML,MAAO,CACL,KAAM,OACN,SAAU,EACZ,EAOA,WAAY,OACd,EAEA,MAAO,CAAC,QAAS,aAAa,EAE9B,MAAMC,EAAO,CAAE,KAAAC,CAAK,EAAG,CACrB,MAAM5B,EAASC,EAAAA,EACTO,EAAcC,EAAe,EAC7BoB,EAASC,GAAgBC,EAAgB,EACzC,CACJ,QAASC,EACT,gBAAAC,EACA,aAAAC,EACA,mBAAAC,CACF,EAAI7C,GAAsB,EACpB,CACJ,QAAS8C,EACT,cAAAC,EACA,iBAAAC,EACA,oBAAAC,CACF,EAAIxC,GAAAA,EACEyC,EAAgBR,GAAsBI,EAEtC/B,EAAQoC,GAAMd,EAAO,OAAO,EAC5B,CAAE,QAAAZ,EAAS,UAAAF,CAAU,EAAIT,GAAgBC,CAAK,EAE9CqC,EAAyB5B,EAAI,CAAE,QAAS,GAAM,MAAO,CAAE,CAAC,EACxD6B,EAAuB7B,EAAI,CAAC,EAC5B8B,EAA8B9B,EAAI,CAAC,EAEnC+B,EAAaC,EACjB,IACEN,IACCN,EAAa,MAAM,OAAS,GAAKG,EAAc,MAAM,OAAS,EACnE,EACMU,EAAaD,EAAS,IAAM/B,EAAQ,MAAM,OAAS,CAAC,EACpDiC,EAAkBF,EACtB,IAAM/B,EAAQ,MAAM4B,EAAqB,KAAK,GAAK,IACrD,EAEMzC,EAAeR,GACnBM,EAAO,QAAQ,CACb,KAAMN,EAAK,IACX,GAAI,WAAYA,EAAO,CAAE,KAAM,IAAIA,EAAK,MAAM,EAAG,EAAI,CAAA,CACvD,CAAC,EAAE,SAECuD,EAAwB,IAAY,CACxC,KAAM,CAAE,QAAAC,EAAS,MAAAvD,CAAM,EAAI+C,EAAuB,MAE9C/C,IAAU,EACZ+C,EAAuB,MAAQ,CAC7B,QAAS,CAACQ,EACV,MAAOA,EACHb,EAAc,MAAM,OAAS,EAC7BH,EAAa,MAAM,OAAS,CAClC,EAEAQ,EAAuB,MAAQ,CAC7B,QAAAQ,EACA,MAAOvD,EAAQ,CACjB,CACJ,EAEMwD,EAAoB,IAAY,CACpC,KAAM,CAAE,QAAAD,EAAS,MAAAvD,CAAM,EAAI+C,EAAuB,MAGhD/C,KACCuD,EACGhB,EAAa,MAAM,OAAS,EAC5BG,EAAc,MAAM,OAAS,GAEjCK,EAAuB,MAAQ,CAC7B,QAAS,CAACQ,EACV,MAAO,CACT,EAEAR,EAAuB,MAAQ,CAC7B,QAAAQ,EACA,MAAOvD,EAAQ,CACjB,CACJ,EAEMyD,EAAuB,IAAY,CACvCT,EAAqB,MACnBA,EAAqB,MAAQ,EACzBA,EAAqB,MAAQ,EAC7B5B,EAAQ,MAAM,OAAS,EAC7B6B,EAA4B,MAC1BI,EAAgB,MAAM,SAAS,OAAS,CAC5C,EAEMK,EAAmB,IAAY,CACnCV,EAAqB,MACnBA,EAAqB,MAAQ5B,EAAQ,MAAM,OAAS,EAChD4B,EAAqB,MAAQ,EAC7B,EACNC,EAA4B,MAAQ,CACtC,EAEMU,EAA0B,IAAY,CAExCV,EAA4B,MAC5BI,EAAgB,MAAM,SAAS,OAAS,EAExCJ,EAA4B,MAC1BA,EAA4B,MAAQ,EACnCS,EAAiB,CACxB,EAEME,EAA8B,IAAY,CAC1CX,EAA4B,MAAQ,EACtCA,EAA4B,MAC1BA,EAA4B,MAAQ,EACnCQ,EACP,CAAA,EAEMI,EAAaC,GACjBA,EAAQ,IAAKC,GAAUC,GAASD,CAAI,EAAIA,EAAOE,EAAEF,EAAK,CAAC,EAAGA,EAAK,CAAC,CAAC,CAAE,EAE/DG,EAAcC,GAAiD,CACnE,GAAIA,EAAY,OAAS,cAAe,CACtC,MAAMC,EACJC,GAAiCF,EAAY,KAAK,GAAK,WAEnD,CAACG,EAAQC,EAAS,EAAE,EAAIC,GAAcJ,CAAe,EACvDA,EAAgBvD,EAAY,KAAK,EAAE,MAAM,UAAU,EACnDuD,EAAgB,MAAM,UAAU,EAEpC,OAAOD,EAAY,QAAQ,IAAKL,GAC9BG,EAAE,MAAOJ,EAAU,CAACS,EAAQ,GAAGR,EAASS,CAAM,CAAC,CAAC,CAClD,CACF,CAEA,OAAOJ,EAAY,QAAQ,IAAKL,GAAYG,EAAE,MAAOJ,EAAUC,CAAO,CAAC,CAAC,CAC1E,EAEMW,EAAoB,IAAY,CACpCzB,EAAqB,MAAQ,EAC7BC,EAA4B,MAAQ,EACpChB,EAAK,cAAe,EAAE,EACtBA,EAAK,OAAO,CACd,EAEA,OAAAyC,GAAiB,UAAYC,GAAyB,CACpD,GAAK3C,EAAM,YAEX,GAAIoB,EAAW,OACb,GAAIuB,EAAM,MAAQ,UAChBf,EACSe,UAAAA,EAAM,MAAQ,YACvBhB,EAAwB,UACfgB,EAAM,MAAQ,QAAS,CAChC,MAAM5E,EACJsD,EAAgB,MAAM,SAASJ,EAA4B,KAAK,EAE5D2B,EAAOrE,EAAYR,CAAI,EAE7BuC,EAAgBN,EAAM,KAAK,EAC3BW,EAAiB5C,CAAI,EAChBM,EAAO,KAAKuE,CAAI,EACrBH,EAAkB,CACpB,UACShC,GACT,GAAIkC,EAAM,MAAQ,UAChBrB,EAAsB,UACbqB,EAAM,MAAQ,YACvBnB,YACSmB,EAAM,MAAQ,QAAS,CAChC,KAAM,CAAE,MAAA3E,CAAM,EAAI+C,EAAuB,MAErCA,EAAuB,MAAM,SAC/Bd,EAAK,cAAeM,EAAa,MAAMvC,CAAK,CAAC,EAC7C2E,EAAM,eAAA,IAEDtE,EAAO,KAAKqC,EAAc,MAAM1C,CAAK,EAAE,IAAI,EAChDyE,IAEJ,GAEJ,CAAC,EAED5C,EACE,CAACmB,EAAsBC,CAA2B,EAClD,IAAM,CAnOZ,IAAA4B,GAoOQA,EAAA,SACG,cACC,oEACF,IAHF,MAAAA,EAII,eAAe,EACrB,CAAA,EACA,CAAE,MAAO,MAAO,CAClB,EAEO,IACLZ,EACE,MACA,CACE,MAAO,CACL,4BACA,CAAE,MAAOvD,EAAM,MAAQ,CAAC0C,EAAW,MAAQ,CAACF,EAAW,KAAM,CAC/D,EACA,GAAI,oBACN,EACAxC,EAAM,QAAU,GACZmC,EACEK,EAAW,MACT,CACEb,EACI4B,EACE,KACA,CAAE,MAAO,wBAAyB,EAClCA,EAAE,KAAM,CAAE,MAAO,6BAA8B,EAAG,CAChDA,EACE,MACA,CAAE,MAAO,yBAA0B,EACnC/B,EAAO,MAAM,OACf,EACAK,EAAa,MAAM,IAAI,CAACxC,EAAM+E,IAC5Bb,EACE,MACA,CACE,MAAO,CACL,yBACA,CACE,OACElB,EAAuB,MAAM,SAC7BA,EAAuB,MAAM,QAC3B+B,CACN,CACF,EACA,QAAS,IAAM,CACb7C,EAAK,cAAelC,CAAI,CAC1B,CACF,EACA,CACEkE,EAAEc,EAAa,CACb,MAAO,wBACT,CAAC,EACDd,EACE,MACA,CAAE,MAAO,2BAA4B,EACrClE,CACF,EACAkE,EAAE,SAAU,CACV,MAAO,yBACP,UAAWe,EACX,QAAUL,GAAiB,CACzBA,EAAM,eACNA,EAAAA,EAAM,gBAAgB,EACtBnC,EAAmBsC,CAAY,CACjC,CACF,CAAC,CACH,CACF,CACF,CACF,CAAC,CACH,EACA,KACJrC,EACIwB,EACE,KACA,CAAE,MAAO,wBAAyB,EAClCA,EAAE,KAAM,CAAE,MAAO,6BAA8B,EAAG,CAChDA,EACE,MACA,CAAE,MAAO,yBAA0B,EACnC/B,EAAO,MAAM,OACf,EAEAQ,EAAc,MAAM,IAAI,CAAC3C,EAAM+E,IAC7Bb,EACEgB,EACA,CACE,GAAIlF,EAAK,KACT,MAAO,CACL,yBACA,CACE,OACE,CAACgD,EAAuB,MAAM,SAC9BA,EAAuB,MAAM,QAC3B+B,CACN,CACF,EACA,QAAS,IAAM,CACbL,GACF,CACF,EACA,IAAM,CACJR,EAAEc,EAAa,CACb,MAAO,wBACT,CAAC,EACDd,EACE,MACA,CAAE,MAAO,2BAA4B,EACrC,CACElE,EAAK,OACDkE,EACE,MACA,CAAE,MAAO,gBAAiB,EAC1BlE,EAAK,MACP,EACA,KACJkE,EACE,MACAlE,EAAK,QACF,IAAK+D,GAAYD,EAAUC,CAAO,CAAC,EACnC,KAAA,CACL,CACF,CACF,EACAG,EAAE,SAAU,CACV,MAAO,yBACP,UAAWe,EACX,QAAUL,GAAiB,CACzBA,EAAM,eAAe,EACrBA,EAAM,kBACN/B,EAAoBkC,CAAY,CAClC,CACF,CAAC,CACH,CACF,CACF,CACF,CAAC,CACH,EACA,IACN,EACA5C,EAAO,MAAM,aACfA,EAAO,MAAM,YACfhB,EAAU,MACV+C,EAAEiB,GAAe,CAAE,KAAMhD,EAAO,MAAM,SAAU,CAAC,EACjDkB,EAAW,MACXa,EACE,KACA,CAAE,MAAO,wBAAyB,EAClC7C,EAAQ,MAAM,IAAI,CAAC,CAAE,MAAA+D,EAAO,SAAAC,CAAS,EAAGpF,IAAU,CAChD,MAAMqF,EACJrC,EAAqB,QAAUhD,EAEjC,OAAOiE,EACL,KACA,CACE,MAAO,CACL,8BACA,CAAE,OAAQoB,CAAsB,CAClC,CACF,EACA,CACEpB,EACE,MACA,CAAE,MAAO,yBAA0B,EACnCkB,GAASjD,EAAO,MAAM,YACxB,EACAkD,EAAS,IAAI,CAACrF,EAAMuF,IAAiB,CACnC,MAAMC,EACJF,GACApC,EAA4B,QAAUqC,EAExC,OAAOrB,EACLgB,EACA,CACE,GAAI1E,EAAYR,CAAI,EACpB,MAAO,CACL,yBACA,CACE,OAAQwF,EACR,gBAAiBA,CACnB,CACF,EACA,QAAS,IAAM,CACbjD,EAAgBN,EAAM,KAAK,EAC3BW,EAAiB5C,CAAI,EACrB0E,GACF,CACF,EACA,IAAM,CACJ1E,EAAK,OAAS,OACV,KACAkE,EACElE,EAAK,OAAS,QACVyF,GACAzF,EAAK,OAAS,UACd0F,GACAC,GACJ,CAAE,MAAO,wBAAyB,CACpC,EACJzB,EAAE,MAAO,CAAE,MAAO,2BAA4B,EAAG,CAC/ClE,EAAK,OAAS,QAAUA,EAAK,OACzBkE,EACE,MACA,CAAE,MAAO,gBAAiB,EAC1BlE,EAAK,MACP,EACA,KACJkE,EAAE,MAAOC,EAAWnE,CAAI,CAAC,CAC3B,CAAC,CACH,CACF,CACF,CAAC,CACH,CACF,CACF,CAAC,CACH,EACAmC,EAAO,MAAM,WACnB,CACJ,CACF,CAAC"}