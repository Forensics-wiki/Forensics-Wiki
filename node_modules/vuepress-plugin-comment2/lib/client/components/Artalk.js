import{usePageData as f,useSiteData as k}from"@vuepress/client";import{defineComponent as v,ref as w,shallowRef as y,onMounted as g,watch as d,h as o,nextTick as h}from"vue";import{isString as D,LoadingIcon as M}from"vuepress-shared/client";import"artalk/dist/Artalk.css";import"../styles/artalk.scss";import{u as A}from"../index-6705f8c9.js";var B=v({name:"Artalk",props:{identifier:{type:String,required:!0},darkmode:Boolean},setup:a=>{const t=A(),i=f(),s=k(),l=w(!1),n=y();let e=null;const u=D(t.server),m=async()=>{const[{default:r}]=await Promise.all([import("artalk/dist/Artalk.es.js"),new Promise(c=>{setTimeout(()=>{c()},t.delay||800)})]),p=r;l.value=!0,await h();try{e=new p({useBackendConf:!1,site:s.value.title,pageTitle:i.value.title,...t,el:n.value,pageKey:a.identifier,darkMode:a.darkmode}),t.useBackendConf&&e.on("conf-loaded",()=>{e.setDarkMode(a.darkmode)})}catch{}};return g(()=>{d(()=>i.value.path,async()=>{try{e==null||e.destroy()}catch{}await m()},{immediate:!0}),d(()=>a.darkmode,r=>{e==null||e.setDarkMode(r)})}),()=>u?o("div",{class:"artalk-wrapper"},[l.value?null:o(M),o("div",{ref:n})]):null}});export{B as default};
//# sourceMappingURL=Artalk.js.map
